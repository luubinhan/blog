<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Làm quen với kiến trúc Serverless - VuiLapTrinh.com</title><meta name="gridsome:hash" content="be9cd8cba7af086bce31a0a023c14cacaa870421"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.21"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="A simple, hackable &amp; minimalistic starter for Gridsome that uses Markdown for content."><meta data-vue-tag="ssr" name="desc" content="Mình không phải chuyên gia trong lĩnh vực này, nghiên cứu để biết thêm, thấy cũng hay, chia sẽ cho mọi người cùng đọc"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.9ab035e6.css" as="style"><link rel="preload" href="/assets/js/app.44ac298f.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.905a5c02.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.1906fe28.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.83bbacb6.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.615124f8.js"><link rel="stylesheet" href="/assets/css/0.styles.9ab035e6.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <script>
      // Add dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
      (function() {
        window.__onThemeChange = function() {};
        function setTheme(newTheme) {
          window.__theme = newTheme;
          preferredTheme = newTheme;
          document.body.setAttribute('data-theme', newTheme);
          window.__onThemeChange(newTheme);
        }

        var preferredTheme;
        try {
          preferredTheme = localStorage.getItem('theme');
        } catch (err) { }

        window.__setPreferredTheme = function(newTheme) {
          setTheme(newTheme);
          try {
            localStorage.setItem('theme', newTheme);
          } catch (err) {}
        }

        var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
        darkQuery.addListener(function(e) {
          window.__setPreferredTheme(e.matches ? 'dark' : 'light')
        });

        setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
      })();
    </script>

    <div id="app" data-server-rendered="true"><header class="header"><div class="header__left"><a href="/" class="logo active"><span class="logo__text">
    ← VuiLapTrinh.com
  </span></a></div><div class="header__right"><button role="button" aria-label="Toggle dark/light" class="toggle-theme"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button></div></header><main class="main"><div class="post-title"><h1 class="post-title__text">Làm quen với kiến trúc Serverless</h1><div class="post-meta">
   Posted 2019-08-30.
   <strong>7 min read.</strong></div></div><div class="post content-box"><div class="post__header"><!----></div><div class="post__content"><!-- TOC -->
<ul>
<li><a href="#serverless-l%c3%a0-g%c3%ac">Serverless là gì</a></li>
<li><a href="#function-as-a-service">Function as a Service</a></li>
<li><a href="#case-study">Case Study</a></li>
</ul>
<!-- /TOC -->
<p>Mười mấy năm về trước, ngày còn đang học đại học, mỗi lần đến ngày đăng ký môn học là mình được nghe điệp khúc hát mãi "server quá tải, số lượng sinh viên tranh nhau vào các lớp có nhiều gái xinh quá đông, quá nguy hiểm, mấy em vui lòng canh 12 giờ đêm, khi ko còn ai lên đăng ký môn học, chúng tôi mới đáp ứng kịp"</p>
<p>Ngày đó Server của trường nằm ở Nguyễn Văn Tráng, phòng server nhỏ như hang thỏ, mà chỉ xài đúng mấy ngày đầu học kỳ, nên thầy trưởng khoa ko thể nào xin ngân sách được để mà nâng cấp 10 mấy con server cho các em sinh viên xài thỏa thích.</p>
<p>Bài toán Server đó giờ được giải quyết ra sao? <strong>Serverless</strong></p>
<p>Trước tiên cần khẳng định <strong>Serverless</strong> không phải là bạn không cần server. Một shop <em>thú nuôi</em> đơn giản, vài ngàn người mua hoa một tháng, làm bằng wordpress bạn sẽ không thấy được lợi ích từ việc sử dụng kiến trúc mới này, không những vậy còn là việc ném một cục tiền cho mấy thằng bán dịch vụ như Amazon</p>
<p>Trang bán thú nuôi, kiến trúc cũ sẽ là thế này</p>
<p><img src="https://martinfowler.com/articles/serverless/ps.svg" alt="kiến trúc cũ sẽ là thế này"></p>
<p>Tất cả những logic sẽ nằm ở <strong>ứng dụng phía server</strong>: từ authentication, page navigation, searching, transaction (code backend đó)</p>
<p>Yêu cầu cần có ngân sách, kế hoạch cụ thể, lắp đặt các hệ thống máy chủ, tìm một chỗ để máy, đảm bảo luôn có điện, luôn mát lạnh, đi dây, chọn nhà cung cấp mạng không bị cá mập cắn…</p>
<p>Nói chung bạn tự làm mọi thứ, hoặc bỏ tiền ra thuê một thằng làm mọi thứ, mà nó còn hay đòi hỏi thêm thắt này kia nọ, vô cùng tốn thời gian, nhân lực, tiền bạc, cơ sở hạ tầng.</p>
<p><em>Infrastructure as a service - IaaS</em>, các dịch vụ cho <em>thuê mặt bằng</em> ra đời. Đáp ứng nhu cầu tiết kiệm chi phí ở thời điểm đầu, nhưng vẫn có thể <em>bành trướng</em> khi cần.</p>
<p>Bạn hình dung nó như việc mở một quán ăn, phải tìm mặt bằng, tìm người giữ xe, chỗ để xe cho khách, thu hút khách vào ăn, thanh toán, sửa chữa điện, nước… Những thằng <strong>IaaS</strong> là các trung tâm thương mại, nó lo hết mọi thứ khác, bạn chỉ việc bỏ tiền ra và thuê lại mặt bằng và kinh doanh.</p>
<h2 id="serverless-là-gì"><a href="#serverless-l%C3%A0-g%C3%AC" aria-hidden="true"><span class="icon icon-link"></span></a>Serverless là gì</h2>
<p>Nó như một khái niệm kinh tế học, không có một cách định nghĩa chính xác Serverless là gì! Có thể hiểu theo 2 cách sau</p>
<p>Serverless được dùng để ám chỉ những ứng dụng sử dụng phần lớn (hoặc toàn bộ) dịch vụ "nhà hàng xóm" (third-party), được host trên cloud, cho các vấn đề ở phía server là logic và state (ví dụ trạng thái đăng nhập, một dạng của dịch vụ chăm sóc khách hàng thân thiết). Những ứng dụng <strong>để sử dụng</strong> (không phải những trang profile công ty, show hiệu ứng bay lượn portfolio, ví dụ như Facebook, ứng dụng đăng ký môn học, hoặc ứng dụng điện thoại bị chửi bới quá trời FaceApp, tức là mô hình này không chỉ áp dụng riêng cho web). Những dịch vụ thường được outsource cho nhà hàng xóm là gì: database có <a href="https://parseplatform.org/" target="_blank" rel="nofollow noopener noreferrer">Parse</a>, <a href="https://firebase.google.com/" target="_blank" rel="nofollow noopener noreferrer">Firebase</a>, authentication có <a href="https://auth0.com/" target="_blank" rel="nofollow noopener noreferrer">Auth0</a>, AWS Cognito. Mấy nhà này nằm trong khu "Backend as a Service" - <strong>BaaS</strong>, khi gắn vào <em>hậu tố</em> as a Service bạn có thể biết là nó nằm ở nhà hàng xóm.</p>
<p>Serverless cũng có nghĩa là ứng dụng đó logic server vẫn có, developer vẫn phải viết logic này, tuy nhiên, không giống kiến trúc truyền thống, nó chạy theo cơ chế "tiền trao-cháo múc" (event-trigger), không quan tâm anh bạn có ở chung nhà mình không (stateless compute container). Khái niệm này được <a href="https://twitter.com/marak" target="_blank" rel="nofollow noopener noreferrer">@marak trên Twitter</a> gọi là <strong>Function as a Service</strong> - <strong>FaaS</strong>, bạn có nhu cầu cắt tóc, gội đầu, uống cafe, đánh giày thì bạn ra <em>tiệm</em> hết, không dùng đồ <em>nhà</em> có sẵn nữa. Hiện tại, <a href="https://aws.amazon.com/lambda/" target="_blank" rel="nofollow noopener noreferrer">AWS Lambda</a> là một trong những platform nổi tiếng nhất khi nói đến FaaS</p>
<p>Giờ nói tới FaaS, nó đang là trend, nó thay đổi cách chúng ta trước đây vẫn nghĩ về kiến trúc dưới server.</p>
<p>Tất cả những ông lớn đều có các sản phẩm BaaS và FaaS, <a href="https://aws.amazon.com/serverless/" target="_blank" rel="nofollow noopener noreferrer">Amazon Serverless</a>, <a href="https://firebase.google.com/docs/functions/" target="_blank" rel="nofollow noopener noreferrer">Google Cloud Functions for Firebase.</a></p>
<p><img src="https://hackernoon.com/hn-images/1*t4O4UXpdG68MQboNKC6bBw.jpeg" alt="Tất cả những ông lớn đều có các sản phẩm BaaS và FaaS"></p>
<p>Một kiến trúc Serverless nó như thế này</p>
<p><img src="https://martinfowler.com/articles/serverless/sps.svg" alt="Một kiến trúc Serverless"></p>
<ol>
<li>Phần authen trước đây được gửi <em>nhà hàng xóm</em> làm (cơ quan nhà nước chuyên cung cấp CMND)</li>
<li>Dữ liệu được đưa một về nhà kho quản lý, kiểu như Tiki bây giờ quá mệt quản lý kho hàng, các cửa hàng nhỏ lẻ tự quản lý kho, Tiki bán được thì chạy tới kho của bên thứ 3 lấy.</li>
<li>Với 2 thay đổi ở trên, điều này có nghĩa là một vài logic đã được nằm ở phía client, thí dụ, user session, bạn sẽ thấy rõ nhất ở các Single Page App chúng ta build, phần logic giao diện cho user đã và chưa đăng nhập nằm ở client - <em>nhà user</em>, những route nào user có thể vào nằm ở code client</li>
<li>Một vài hiển thị, ràng buộc tất nhiên vẫn được server nắm. Thí dụ "search". Chúng ta có thêm một <em>nhà</em> gọi là "API Gateway", dịch vụ giao nhận, tất cả các yêu cầu từ client đưa về đây, các anh em HTTP sẽ đi lấy dữ liệu từ kho về cho chúng ta.</li>
<li>Với tính năng đặt hàng, nó do một <em>nhà** khác cung cấp. Những logic khác nhau, được tách và deploy thành những </em>cục* khác nhau như vậy cách tiếp cận của FaaS cũng là cách tiếp cận rất phổ biến trong "Microservices"</li>
</ol>
<p>Nó sẽ có những lợi ích i chang như Microservices, tất nhiên là có trả giá, có nhiều thứ để kiểm soát và theo dõi hơn, vấn đề bảo mật cũng không phải đơn giản như xưa, nằm ở nhiều nơi quá mà, bài toán đi đi lại tránh kẹt xe giữa các hệ thống khác nhau, biết đâu đi lạc vào chổ nào đó mất CMND luôn !!</p>
<h2 id="function-as-a-service"><a href="#function-as-a-service" aria-hidden="true"><span class="icon icon-link"></span></a>Function as a Service</h2>
<p>Nãy giờ nói FaaS nhiều quá rồi, giờ "đào sâu" nghiên cứu nó chút. Trích dẫn từ trang <a href="https://aws.amazon.com/lambda/" target="_blank" rel="nofollow noopener noreferrer">Amazon Lambda</a></p>
<blockquote>
<p>AWS Lambda lets you run code without provisioning or managing servers. (1) ... With Lambda, you can run code for virtually any type of application or backend service (2) - all with zero administration. Just upload your code and Lambda takes care of everything required to run (3) and scale (4) your code with high availability. You can set up your code to automatically trigger from other AWS services (5) or call it directly from any web or mobile app (6).</p>
</blockquote>
<p>Diễn giải đoạn dài ngoằn kia</p>
<p>(1) FaaS là chạy backend code mà không cần quan tâm việc quản lý và bảo trì hệ thống server.</p>
<p>(2) FaaS không yêu cầu một framework hay thư viện cụ thể nào. Các <strong>function</strong> trên Lambda có thể được viết bằng Javascript, Python, Go, Java, Clojure, Scala, .NET.</p>
<p>(3) Deploy sẽ rất khác với hệ thống truyền thống. Tới *nhà** của FaaS chúng ta đưa đoạn code cho chủ nhà, còn lại chủ nhà làm gì thì làm.</p>
<p>(4) Scale sẽ tự động được chủ nhà làm. Nếu hệ thống cần đáp ứng 1000 request đồng thời, chủ nhà sẽ lo, bạn chỉ cần bơm tiền. Quan trọng nhất, bên cung cấp dịch vụ sẽ quản lý hết toàn bộ resource, xin giấy phép, nói chung là toàn bộ - bạn không cần làm gì với cluster, VM cả.</p>
<p>(5) Cung cấp cơ chế trigger ứng với các event bạn muốn.</p>
<p>(6) Mấy bên cung cấp dịch vụ, cho phép các function này trigger theo những sự kiện HTTP request, như ví dụ là search, và purchase, hoặc gọi trực tiếp lên các API được cung cấp bởi bên cung cấp</p>
<h2 id="case-study"><a href="#case-study" aria-hidden="true"><span class="icon icon-link"></span></a>Case Study</h2>
<p><a href="http://www.vogue.it/en/photovogue" target="_blank" rel="nofollow noopener noreferrer">PhotoVogue</a> trang Vogue của Ý, chạy từ năm 2011, sau một năm chạy, photographer bu vô như kiến, server ở nhà riêng quá tải không chịu nổi.</p>
<p>Giám đốc kỹ thuật quyết định chuyển đổi toàn bộ hệ thống server ở <em>nhà riêng</em> sang AWS trong 3 tháng.</p>
<p>Chạy theo trend này, còn có những cái tên rất phổ biến là Uber, Pokemon Go, Airbnb, Clash of Clans và rất nhiều ứng dụng khác khi số lượng user và real-time data lớn</p>
<p>Những vấn đề mà team PhotoVogue đã gặp</p>
<ul>
<li>Có hơn 130,000 photographer trên khắp thế giới sử dụng hệ thống để đưa ảnh lên, ước tính có khoảng 400,000 ảnh, với dung lượng tối đa mỗi hình là 50MB (bọn này chơi sang nhỉ)</li>
<li>Số lượng truy cập ngày càng tăng</li>
<li>Trải nghiệm sử dụng của user không tốt, thao tác xử lý quá chậm, up ảnh quá rùa</li>
</ul>
<p>Với AWS, nó đã giải quyết các vấn đề sau cho PhotoVogue</p>
<ul>
<li>Khả năng scale, dễ maintenance, quản lý chi phí rõ ràng</li>
<li>Lưu trữ hình trên Amazon S3</li>
<li>Khi up lên Amazon S3, bật trigger sử dụng AWS Lambda function, convert các file này qua gif, jpeg, png, tiff</li>
<li>Amazon API Gateway được sử dụng để làm tầng caching của REST API, Amazon CloudFront cho CDN</li>
</ul>
<p><img src="https://www.simform.com/wp-content/uploads/2017/12/serverless-graph.png" alt="Kiến trúc Serverless"></p>
<p>Còn vấn đề nào nữa không, mình hy vọng bạn nào chuyên gia vào chỉ giáo</p>
<p>Tài liệu tham khảo</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://hackernoon.com/what-is-serverless-architecture-what-are-its-pros-and-cons-cc4b804022e9">📜 What is Serverless Architecture? What are its Pros and Cons?</a></p>
<p><a target="_blank" rel="noopener noreferrer" href="https://martinfowler.com/articles/serverless.html">📜 Serverless Architectures</a></p>
<p><a target="_blank" rel="noopener noreferrer" href="https://www.simform.com/serverless-architecture-guide/">📜 Serverless Architecture: A Comprehensive Guide</a></p>
</div><div class="post__footer"><div class="post-tags"><a href="/tag/javascript/" class="post-tags__link"><span>#</span> javascript
		</a><a href="/tag/hoc-thuat/" class="post-tags__link"><span>#</span> hoc-thuat
		</a></div></div></div><div class="post-comments"></div><div class="author post-author"><img alt="Author image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 180 180' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-52311ff214b737f722259e901102d6b3'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='5'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-52311ff214b737f722259e901102d6b3)' width='180' height='180' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCABAAEADASIAAhEBAxEB/8QAHAAAAQUBAQEAAAAAAAAAAAAABwEDBAUGCAAC/8QAMxAAAQMCAwcBBgYDAAAAAAAAAQIDEQAEBRIhBhMxQVFhcQciIzJCgbEIFDORodEWgsH/xAAZAQEBAQEBAQAAAAAAAAAAAAAEAwUGAAH/xAAhEQABBAMAAgMBAAAAAAAAAAABAAIDEQQSISJBBRNRMf/aAAwDAQACEQMRAD8A6Pr1fOalmvLyUAk6AnxS5VROUx4oR%2bvmPXNjZYbhti48DcKUt9LRIJAHsgkaxMmO1ByzxnG8PeQ/a3d5bOIIUVJdUOHMifvWjB8c6aMP2q0CfPbC/TW119SVz9YetmOMLYRfWWH3TaSA4pKVNrWOuhgH6UYtkNrsK2stFvYU65nbjesOpyrbnhPIjuKhPhSwDZw4qw5kU5ph6r%2blpCYFNOLKflV5o1JSXMkDlS5xy1qtDo4mfrWe2/xhWEbJ3t400%2b6oZWyGpkBRiTGoSNJj/tVbEXEN/VMyAC1iPUTaS2xjG3bO3IS3ay2HNJc1lR6xPDx3oa4g0RvVlQcSfhFRLrEF3V0LpSAh10layOMzw7eKl3jqLhxsxLaRw4610MUYiAa1ZMxMosrPugpJJ0nlwiiJ%2bH69eZ28NulfuX7R0LTOhygKB8yKxWLaWoC0BJKpgfL2rdfh8sV3G1F9iBTLNnalGbkFuEADzAVVMpwOO6/xCx4izJaAuiSsT8UV8KKyBznmKih1J714OqIiCa5jVdJsqk4ggL9oRPSqDbty4/w/GnLVzKPyypBkaEif4p5N2RwA/anlPtvsrafAW0tJStChKVA8QR0p4ZqQQil1ilz5Y5nGloXKkcNev908G8iUoSCUiiHtVhFhhdou6wu2O6JyuNg/pzwUCdY5a8JrAXtwErWi3RmIEZwZE9utaccm/QEVzKVZjVrltN4JyJMqFdGemuz7OzmyFjbBGS5eQLm6PMuLAMf6iE/SgBavuMPNOON75wKC0tr4GDPtdqO%2bxm0i8ew0O3O7RfJnett6J4mCnXhH81DNDzGK/i%2b4/wBbZSb7S1xQ2IIVBHWvb2BAIioBcVxMCml3KgYFZQZadtSzAK460hCpkk%2bBTzahmmnXnRA0APmadsj0ol1uE2T6r5SEWgbO9K%2bARGs0H7stto3luczSyS3mEKUJIBI66VrvUnGWlJZwlKsuaHnjmgafCk/f9qwD6y%2b2pbjhKU%2bylWaJ8dabjxmtne0HInolrVcYThj18w5clKzl1KOZ/sVLRtJ%2bQbQ7akpum/01oEA9c3bvULB8WtGbRYuW1vvBOVtTivm48eVUt9Z3dwpKlIbaZIhJQZEdJq7fJxDxxHcdWgxnvtFbZz1ItsQCWMWyWb8hJcn3ZV3Pyz14eK2e9WpUBJoGYHhVpmCQyCtTZBMaHz1oq7DYxvmBh11IeZT7pR%2bZA5eR9vFCyoGs8owm4sz38kK//9k=' /%3e%3c/svg%3e" width="180" data-src="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg" data-srcset="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg 180w" data-sizes="(max-width: 180px) 100vw, 180px" class="author__image g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg" class="author__image g-image g-image--loaded" width="180" alt="Author image"></noscript><!----><p class="author__intro">Hiện tại site đang nâng cấp, các bạn xài tạm</p></div></main><footer class="footer"><span class="footer__copyright">Copyright © 2020. </span><span class="footer__links">Powered by <a href="//gridsome.org"> Gridsome </a></span></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Làm quen với kiến trúc Serverless","path":"\u002Flam-quen-voi-kien-truc-serverless\u002F","date":"2019-08-30","timeToRead":7,"tags":[{"id":"javascript","title":"javascript","path":"\u002Ftag\u002Fjavascript\u002F"},{"id":"hoc-thuat","title":"hoc-thuat","path":"\u002Ftag\u002Fhoc-thuat\u002F"}],"desc":"Mình không phải chuyên gia trong lĩnh vực này, nghiên cứu để biết thêm, thấy cũng hay, chia sẽ cho mọi người cùng đọc","content":"\u003C!-- TOC --\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"#serverless-l%c3%a0-g%c3%ac\"\u003EServerless là gì\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#function-as-a-service\"\u003EFunction as a Service\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#case-study\"\u003ECase Study\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C!-- \u002FTOC --\u003E\n\u003Cp\u003EMười mấy năm về trước, ngày còn đang học đại học, mỗi lần đến ngày đăng ký môn học là mình được nghe điệp khúc hát mãi \"server quá tải, số lượng sinh viên tranh nhau vào các lớp có nhiều gái xinh quá đông, quá nguy hiểm, mấy em vui lòng canh 12 giờ đêm, khi ko còn ai lên đăng ký môn học, chúng tôi mới đáp ứng kịp\"\u003C\u002Fp\u003E\n\u003Cp\u003ENgày đó Server của trường nằm ở Nguyễn Văn Tráng, phòng server nhỏ như hang thỏ, mà chỉ xài đúng mấy ngày đầu học kỳ, nên thầy trưởng khoa ko thể nào xin ngân sách được để mà nâng cấp 10 mấy con server cho các em sinh viên xài thỏa thích.\u003C\u002Fp\u003E\n\u003Cp\u003EBài toán Server đó giờ được giải quyết ra sao? \u003Cstrong\u003EServerless\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ETrước tiên cần khẳng định \u003Cstrong\u003EServerless\u003C\u002Fstrong\u003E không phải là bạn không cần server. Một shop \u003Cem\u003Ethú nuôi\u003C\u002Fem\u003E đơn giản, vài ngàn người mua hoa một tháng, làm bằng wordpress bạn sẽ không thấy được lợi ích từ việc sử dụng kiến trúc mới này, không những vậy còn là việc ném một cục tiền cho mấy thằng bán dịch vụ như Amazon\u003C\u002Fp\u003E\n\u003Cp\u003ETrang bán thú nuôi, kiến trúc cũ sẽ là thế này\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmartinfowler.com\u002Farticles\u002Fserverless\u002Fps.svg\" alt=\"kiến trúc cũ sẽ là thế này\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ETất cả những logic sẽ nằm ở \u003Cstrong\u003Eứng dụng phía server\u003C\u002Fstrong\u003E: từ authentication, page navigation, searching, transaction (code backend đó)\u003C\u002Fp\u003E\n\u003Cp\u003EYêu cầu cần có ngân sách, kế hoạch cụ thể, lắp đặt các hệ thống máy chủ, tìm một chỗ để máy, đảm bảo luôn có điện, luôn mát lạnh, đi dây, chọn nhà cung cấp mạng không bị cá mập cắn…\u003C\u002Fp\u003E\n\u003Cp\u003ENói chung bạn tự làm mọi thứ, hoặc bỏ tiền ra thuê một thằng làm mọi thứ, mà nó còn hay đòi hỏi thêm thắt này kia nọ, vô cùng tốn thời gian, nhân lực, tiền bạc, cơ sở hạ tầng.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cem\u003EInfrastructure as a service - IaaS\u003C\u002Fem\u003E, các dịch vụ cho \u003Cem\u003Ethuê mặt bằng\u003C\u002Fem\u003E ra đời. Đáp ứng nhu cầu tiết kiệm chi phí ở thời điểm đầu, nhưng vẫn có thể \u003Cem\u003Ebành trướng\u003C\u002Fem\u003E khi cần.\u003C\u002Fp\u003E\n\u003Cp\u003EBạn hình dung nó như việc mở một quán ăn, phải tìm mặt bằng, tìm người giữ xe, chỗ để xe cho khách, thu hút khách vào ăn, thanh toán, sửa chữa điện, nước… Những thằng \u003Cstrong\u003EIaaS\u003C\u002Fstrong\u003E là các trung tâm thương mại, nó lo hết mọi thứ khác, bạn chỉ việc bỏ tiền ra và thuê lại mặt bằng và kinh doanh.\u003C\u002Fp\u003E\n\u003Ch2 id=\"serverless-là-gì\"\u003E\u003Ca href=\"#serverless-l%C3%A0-g%C3%AC\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EServerless là gì\u003C\u002Fh2\u003E\n\u003Cp\u003ENó như một khái niệm kinh tế học, không có một cách định nghĩa chính xác Serverless là gì! Có thể hiểu theo 2 cách sau\u003C\u002Fp\u003E\n\u003Cp\u003EServerless được dùng để ám chỉ những ứng dụng sử dụng phần lớn (hoặc toàn bộ) dịch vụ \"nhà hàng xóm\" (third-party), được host trên cloud, cho các vấn đề ở phía server là logic và state (ví dụ trạng thái đăng nhập, một dạng của dịch vụ chăm sóc khách hàng thân thiết). Những ứng dụng \u003Cstrong\u003Eđể sử dụng\u003C\u002Fstrong\u003E (không phải những trang profile công ty, show hiệu ứng bay lượn portfolio, ví dụ như Facebook, ứng dụng đăng ký môn học, hoặc ứng dụng điện thoại bị chửi bới quá trời FaceApp, tức là mô hình này không chỉ áp dụng riêng cho web). Những dịch vụ thường được outsource cho nhà hàng xóm là gì: database có \u003Ca href=\"https:\u002F\u002Fparseplatform.org\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EParse\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Ffirebase.google.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EFirebase\u003C\u002Fa\u003E, authentication có \u003Ca href=\"https:\u002F\u002Fauth0.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EAuth0\u003C\u002Fa\u003E, AWS Cognito. Mấy nhà này nằm trong khu \"Backend as a Service\" - \u003Cstrong\u003EBaaS\u003C\u002Fstrong\u003E, khi gắn vào \u003Cem\u003Ehậu tố\u003C\u002Fem\u003E as a Service bạn có thể biết là nó nằm ở nhà hàng xóm.\u003C\u002Fp\u003E\n\u003Cp\u003EServerless cũng có nghĩa là ứng dụng đó logic server vẫn có, developer vẫn phải viết logic này, tuy nhiên, không giống kiến trúc truyền thống, nó chạy theo cơ chế \"tiền trao-cháo múc\" (event-trigger), không quan tâm anh bạn có ở chung nhà mình không (stateless compute container). Khái niệm này được \u003Ca href=\"https:\u002F\u002Ftwitter.com\u002Fmarak\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003E@marak trên Twitter\u003C\u002Fa\u003E gọi là \u003Cstrong\u003EFunction as a Service\u003C\u002Fstrong\u003E - \u003Cstrong\u003EFaaS\u003C\u002Fstrong\u003E, bạn có nhu cầu cắt tóc, gội đầu, uống cafe, đánh giày thì bạn ra \u003Cem\u003Etiệm\u003C\u002Fem\u003E hết, không dùng đồ \u003Cem\u003Enhà\u003C\u002Fem\u003E có sẵn nữa. Hiện tại, \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Flambda\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EAWS Lambda\u003C\u002Fa\u003E là một trong những platform nổi tiếng nhất khi nói đến FaaS\u003C\u002Fp\u003E\n\u003Cp\u003EGiờ nói tới FaaS, nó đang là trend, nó thay đổi cách chúng ta trước đây vẫn nghĩ về kiến trúc dưới server.\u003C\u002Fp\u003E\n\u003Cp\u003ETất cả những ông lớn đều có các sản phẩm BaaS và FaaS, \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Fserverless\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EAmazon Serverless\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Ffirebase.google.com\u002Fdocs\u002Ffunctions\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EGoogle Cloud Functions for Firebase.\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fhackernoon.com\u002Fhn-images\u002F1*t4O4UXpdG68MQboNKC6bBw.jpeg\" alt=\"Tất cả những ông lớn đều có các sản phẩm BaaS và FaaS\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EMột kiến trúc Serverless nó như thế này\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fmartinfowler.com\u002Farticles\u002Fserverless\u002Fsps.svg\" alt=\"Một kiến trúc Serverless\"\u003E\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003EPhần authen trước đây được gửi \u003Cem\u003Enhà hàng xóm\u003C\u002Fem\u003E làm (cơ quan nhà nước chuyên cung cấp CMND)\u003C\u002Fli\u003E\n\u003Cli\u003EDữ liệu được đưa một về nhà kho quản lý, kiểu như Tiki bây giờ quá mệt quản lý kho hàng, các cửa hàng nhỏ lẻ tự quản lý kho, Tiki bán được thì chạy tới kho của bên thứ 3 lấy.\u003C\u002Fli\u003E\n\u003Cli\u003EVới 2 thay đổi ở trên, điều này có nghĩa là một vài logic đã được nằm ở phía client, thí dụ, user session, bạn sẽ thấy rõ nhất ở các Single Page App chúng ta build, phần logic giao diện cho user đã và chưa đăng nhập nằm ở client - \u003Cem\u003Enhà user\u003C\u002Fem\u003E, những route nào user có thể vào nằm ở code client\u003C\u002Fli\u003E\n\u003Cli\u003EMột vài hiển thị, ràng buộc tất nhiên vẫn được server nắm. Thí dụ \"search\". Chúng ta có thêm một \u003Cem\u003Enhà\u003C\u002Fem\u003E gọi là \"API Gateway\", dịch vụ giao nhận, tất cả các yêu cầu từ client đưa về đây, các anh em HTTP sẽ đi lấy dữ liệu từ kho về cho chúng ta.\u003C\u002Fli\u003E\n\u003Cli\u003EVới tính năng đặt hàng, nó do một \u003Cem\u003Enhà** khác cung cấp. Những logic khác nhau, được tách và deploy thành những \u003C\u002Fem\u003Ecục* khác nhau như vậy cách tiếp cận của FaaS cũng là cách tiếp cận rất phổ biến trong \"Microservices\"\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003ENó sẽ có những lợi ích i chang như Microservices, tất nhiên là có trả giá, có nhiều thứ để kiểm soát và theo dõi hơn, vấn đề bảo mật cũng không phải đơn giản như xưa, nằm ở nhiều nơi quá mà, bài toán đi đi lại tránh kẹt xe giữa các hệ thống khác nhau, biết đâu đi lạc vào chổ nào đó mất CMND luôn !!\u003C\u002Fp\u003E\n\u003Ch2 id=\"function-as-a-service\"\u003E\u003Ca href=\"#function-as-a-service\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EFunction as a Service\u003C\u002Fh2\u003E\n\u003Cp\u003ENãy giờ nói FaaS nhiều quá rồi, giờ \"đào sâu\" nghiên cứu nó chút. Trích dẫn từ trang \u003Ca href=\"https:\u002F\u002Faws.amazon.com\u002Flambda\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EAmazon Lambda\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EAWS Lambda lets you run code without provisioning or managing servers. (1) ... With Lambda, you can run code for virtually any type of application or backend service (2) - all with zero administration. Just upload your code and Lambda takes care of everything required to run (3) and scale (4) your code with high availability. You can set up your code to automatically trigger from other AWS services (5) or call it directly from any web or mobile app (6).\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003EDiễn giải đoạn dài ngoằn kia\u003C\u002Fp\u003E\n\u003Cp\u003E(1) FaaS là chạy backend code mà không cần quan tâm việc quản lý và bảo trì hệ thống server.\u003C\u002Fp\u003E\n\u003Cp\u003E(2) FaaS không yêu cầu một framework hay thư viện cụ thể nào. Các \u003Cstrong\u003Efunction\u003C\u002Fstrong\u003E trên Lambda có thể được viết bằng Javascript, Python, Go, Java, Clojure, Scala, .NET.\u003C\u002Fp\u003E\n\u003Cp\u003E(3) Deploy sẽ rất khác với hệ thống truyền thống. Tới *nhà** của FaaS chúng ta đưa đoạn code cho chủ nhà, còn lại chủ nhà làm gì thì làm.\u003C\u002Fp\u003E\n\u003Cp\u003E(4) Scale sẽ tự động được chủ nhà làm. Nếu hệ thống cần đáp ứng 1000 request đồng thời, chủ nhà sẽ lo, bạn chỉ cần bơm tiền. Quan trọng nhất, bên cung cấp dịch vụ sẽ quản lý hết toàn bộ resource, xin giấy phép, nói chung là toàn bộ - bạn không cần làm gì với cluster, VM cả.\u003C\u002Fp\u003E\n\u003Cp\u003E(5) Cung cấp cơ chế trigger ứng với các event bạn muốn.\u003C\u002Fp\u003E\n\u003Cp\u003E(6) Mấy bên cung cấp dịch vụ, cho phép các function này trigger theo những sự kiện HTTP request, như ví dụ là search, và purchase, hoặc gọi trực tiếp lên các API được cung cấp bởi bên cung cấp\u003C\u002Fp\u003E\n\u003Ch2 id=\"case-study\"\u003E\u003Ca href=\"#case-study\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECase Study\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"http:\u002F\u002Fwww.vogue.it\u002Fen\u002Fphotovogue\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EPhotoVogue\u003C\u002Fa\u003E trang Vogue của Ý, chạy từ năm 2011, sau một năm chạy, photographer bu vô như kiến, server ở nhà riêng quá tải không chịu nổi.\u003C\u002Fp\u003E\n\u003Cp\u003EGiám đốc kỹ thuật quyết định chuyển đổi toàn bộ hệ thống server ở \u003Cem\u003Enhà riêng\u003C\u002Fem\u003E sang AWS trong 3 tháng.\u003C\u002Fp\u003E\n\u003Cp\u003EChạy theo trend này, còn có những cái tên rất phổ biến là Uber, Pokemon Go, Airbnb, Clash of Clans và rất nhiều ứng dụng khác khi số lượng user và real-time data lớn\u003C\u002Fp\u003E\n\u003Cp\u003ENhững vấn đề mà team PhotoVogue đã gặp\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ECó hơn 130,000 photographer trên khắp thế giới sử dụng hệ thống để đưa ảnh lên, ước tính có khoảng 400,000 ảnh, với dung lượng tối đa mỗi hình là 50MB (bọn này chơi sang nhỉ)\u003C\u002Fli\u003E\n\u003Cli\u003ESố lượng truy cập ngày càng tăng\u003C\u002Fli\u003E\n\u003Cli\u003ETrải nghiệm sử dụng của user không tốt, thao tác xử lý quá chậm, up ảnh quá rùa\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EVới AWS, nó đã giải quyết các vấn đề sau cho PhotoVogue\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EKhả năng scale, dễ maintenance, quản lý chi phí rõ ràng\u003C\u002Fli\u003E\n\u003Cli\u003ELưu trữ hình trên Amazon S3\u003C\u002Fli\u003E\n\u003Cli\u003EKhi up lên Amazon S3, bật trigger sử dụng AWS Lambda function, convert các file này qua gif, jpeg, png, tiff\u003C\u002Fli\u003E\n\u003Cli\u003EAmazon API Gateway được sử dụng để làm tầng caching của REST API, Amazon CloudFront cho CDN\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fwww.simform.com\u002Fwp-content\u002Fuploads\u002F2017\u002F12\u002Fserverless-graph.png\" alt=\"Kiến trúc Serverless\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ECòn vấn đề nào nữa không, mình hy vọng bạn nào chuyên gia vào chỉ giáo\u003C\u002Fp\u003E\n\u003Cp\u003ETài liệu tham khảo\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"https:\u002F\u002Fhackernoon.com\u002Fwhat-is-serverless-architecture-what-are-its-pros-and-cons-cc4b804022e9\"\u003E📜 What is Serverless Architecture? What are its Pros and Cons?\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"https:\u002F\u002Fmartinfowler.com\u002Farticles\u002Fserverless.html\"\u003E📜 Serverless Architectures\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"https:\u002F\u002Fwww.simform.com\u002Fserverless-architecture-guide\u002F\"\u003E📜 Serverless Architecture: A Comprehensive Guide\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n","cover_image":""}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.44ac298f.js" defer></script><script src="/assets/js/page--src-templates-post-vue.905a5c02.js" defer></script>
  </body>
</html>