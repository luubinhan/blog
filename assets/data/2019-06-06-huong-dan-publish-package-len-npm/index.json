{"hash":"bc20ea4b90b896b46bf3850cadfd5be1029329f0","data":{"post":{"title":"Hướng dẫn tạo một package, publish nó lên npm","path":"/2019-06-06-huong-dan-publish-package-len-npm/","slug":"/2019-06-06-huong-dan-publish-package-len-npm","date":"2019-06-06","timeToRead":3,"tags":[{"id":"javascript","title":"javascript","path":"/tag/javascript/"},{"id":"step-by-step","title":"step-by-step","path":"/tag/step-by-step/"}],"desc":"Nếu bạn có một package nào đó muốn chia sẽ cùng mọi người trên npm, thì đây là cách bạn publish package make-by-me như vậy lên npm","content":"<!-- TOC -->\n<ul>\n<li><a href=\"#Package-l%C3%A0-g%C3%AC-v%C3%A0-module-l%C3%A0-g%C3%AC\">Package là gì, và module là gì</a></li>\n<li><a href=\"#C%C3%A0i-%C4%91%E1%BA%B7t\">Cài đặt</a></li>\n<li><a href=\"#Ki%E1%BB%83m-tra\">Kiểm tra</a></li>\n<li><a href=\"#Publish\">Publish</a></li>\n</ul>\n<!-- /TOC -->\n<h2 id=\"package-là-gì-và-module-là-gì\"><a href=\"#package-l%C3%A0-g%C3%AC-v%C3%A0-module-l%C3%A0-g%C3%AC\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Package là gì, và module là gì</h2>\n<p>Npm sẽ phân biệt 2 khái niệm <strong>package</strong> và <strong>module</strong> </p>\n<p><strong>Package</strong> là một thư mục chứa một gói phần mềm được mô tả bởi file package.json</p>\n<p><strong>Module</strong> là một thư mục chứa file package.json, chứa một <code class=\"language-inline-text\">default export</code>, cho phép loading module này bằng <code class=\"language-inline-text\">require()</code> trong Node</p>\n<p>Thư mục <strong>node_modules</strong> là nơi mà thằng Node.js sẽ tìm các module cần thiết</p>\n<p>Một cách tóm tắt, hầu hết các npm package chúng ta cài là module, tuy nhiên hông nhất thiết npm package là module</p>\n<p>Những package CLI chỉ chứa các đoạn command-line, chúng ta ko thể load được bằng require, kiểu package như vậy không thể xem là module</p>\n<p>Module là được load từ 1 file như thế này mới xem là module</p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> acronym <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'acronym'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"cài-đặt\"><a href=\"#c%C3%A0i-%C4%91%E1%BA%B7t\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Cài đặt</h2>\n<p>Tạo một thư mục trống, init package npm mới bằng <code class=\"language-inline-text\">npm init</code> hoặc <code class=\"language-inline-text\">npm init --yes</code> nếu muốn trả lời yes cho tất cả các câu hỏi.</p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">mkdir acronym <span class=\"token operator\">&amp;&amp;</span> cd acronym\nnpm init <span class=\"token operator\">--</span>yes</code></pre></div>\n<p>Trỏ vào thư mục này, chúng ta sẽ có file <code class=\"language-inline-text\">package.json</code> như sau</p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"acronym\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token string\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"license\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"ISC\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Theo mặc định, một sẽ có 1 file <code class=\"language-inline-text\">index.js</code>, với <code class=\"language-inline-text\">default export</code></p>\n<p>Sửa file <strong>package.json</strong>, để bổ sung thông tin tác giả, chúng ta đi theo nguyên tắc là <code class=\"language-inline-text\">Your Name &lt;email@example.com></code></p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"acronym\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1.0.0\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Transform sentences to acronyms.\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"main\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"index.js\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"author\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"luubinhan &lt;luubinhan@gmail.me>\"</span> <span class=\"token comment\">// không bắt buộc</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>File <code class=\"language-inline-text\">index.js</code> nội dung đại loại sẽ như thế này</p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">acronym</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sentence<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"kiểm-tra\"><a href=\"#ki%E1%BB%83m-tra\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Kiểm tra</h2>\n<p>Trước khi publish nó lên npm, trong ta có thể dùng <code class=\"language-inline-text\">npm link</code> để kiểm tra dưới local trước. Đại khái <code class=\"language-inline-text\">npm link</code> sẽ cho phép chúng ta trỏ thư mục package vào thư mục <code class=\"language-inline-text\">node_modules</code> global. Chúng ta cần thực hiện 2 bước</p>\n<div class=\"gridsome-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">cd ~<span class=\"token operator\">/</span>duong<span class=\"token operator\">-</span>dan<span class=\"token operator\">-</span>toi<span class=\"token operator\">-</span>thu<span class=\"token operator\">-</span>muc<span class=\"token operator\">/</span>acronym\nnpm link</code></pre></div>\n<p>Sau đó, trong thư mục sử dụng package</p>\n<div class=\"gridsome-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">cd ~<span class=\"token operator\">/</span>duong<span class=\"token operator\">-</span>dan<span class=\"token operator\">-</span>toi<span class=\"token operator\">-</span>thu<span class=\"token operator\">-</span>muc<span class=\"token operator\">/</span>project<span class=\"token operator\">-</span>nao<span class=\"token operator\">-</span><span class=\"token keyword\">do</span>\nnpm link acronym</code></pre></div>\n<p>Bên trong thư mục <strong>node_modules</strong> bây giờ sẽ như thế này</p>\n<p><img src=\"https://scotch-res.cloudinary.com/image/upload/dpr_1,w_900,q_auto:good,f_auto/media/16958/DAUsrFheT8GoWDgais3E_Screen%20Shot%202017-06-26%20at%205.59.29%20PM.png\"></p>\n<h2 id=\"publish\"><a href=\"#publish\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Publish</h2>\n<p>Nếu package chúng ta bị trùng tên trên npm, sẽ nhận thông báo khi publish</p>\n<p><img src=\"https://scotch-res.cloudinary.com/image/upload/dpr_1,w_900,q_auto:good,f_auto/media/16958/Ib1IU5lWQfSrmfi23EOU_Screen%20Shot%202017-06-09%20at%2012.35.50%20PM%20(2).png\"></p>\n<p>Tất nhiên trước khi có quyền publish lên npm chúng ta phải tạo một user trên npm, bằng lệnh <code class=\"language-inline-text\">npm adduser</code> hoặc lên site nó đăng ký. Sau đó login bằng <code class=\"language-inline-text\">npm login</code> để nó nhớ chúng ta.</p>\n<p>Có thể kiểm tra npm có nhớ chúng ta chưa bằng <code class=\"language-inline-text\">npm whoami</code> (tui là ai)</p>\n<p>Mọi thứ đã hoàn tất, <code class=\"language-inline-text\">npm publish</code> để trình làng một module cho thiên hạ</p>\n<div class=\"gridsome-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">npm publish</code></pre></div>\n<p>Package sau khi publish sẽ nằm ở đây <code class=\"language-inline-text\">https://npmjs.com/package/&lt;package></code></p>\n<p>Ngày nó đó ko muốn cho thiên hạ xài nữa</p>\n<div class=\"gridsome-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">npm unpublish</code></pre></div>\n<p>Khi cần update lên version mới</p>\n<div class=\"gridsome-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">npm version &lt;update_type></code></pre></div>\n<p>Đọc thêm <a href=\"https://npmjs.com/package/%3Cpackage%3E\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">cách đặt tên version ở đây</a></p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://scotch.io/bar-talk/how-to-build-and-publish-a-npm-package\">How to Build and Publish an npm Package</a></p>\n","cover_image":"","related":[{"id":"03393afe0d7b5976e9c258595df81919","path":"/2018-07-20-huong-dan-tao-animation-cho-component-voi-react/","title":"Tạo một animation cho component trong React","desc":"Sử dụng React, styled-components, react-flip-toolkit để tạo animation giống như mên trên trang chủ của Stripe"},{"id":"495d1b2403bab34818b94aa36a7ac08d","path":"/2018-11-01-gioi-thieu-npm-link/","title":"Hướng dẫn dùng npm link","desc":"Cách dùng npm link để trỏ dependency đến thư mục local"},{"id":"c9b33110e10e3beff32157783f0b7e74","path":"/2019-07-26-nguyen-ly-chung-cua-lap-trinh-huong-function/","title":"Nguyên lý nền tảng của lập trình function","desc":"Khái niệm ngàn người biết, bạn cũng phải biết"},{"id":"b20b73ac80de85bd787312886b67ab61","path":"/2018-08-05-huong-dan-lam-viec-voi-javascript-regular-expressions/","title":"Hướng dẫn cơ bản để làm việc với Javascript regular expression","desc":"Những khái niệm quan trọng nhất kèm ví dụ dễ hiểu nhất để bạn không còn sợ mỗi khi đụng vô regular expression"}]}},"context":{}}