{"hash":"abad1accdeff08a5b295c1ca2179f7b6ebc52b82","data":{"post":{"title":"BÃ n luáº­n vá» setTimeout vÃ  setInterval trong javascript","path":"/ban-luan-ve-set-timeout-va-set-interval-trong-javascript/","slug":"/2019-11-16-ban-luan-settimout-va-setinterval-trong-javascript","date":"2019-11-16","timeToRead":3,"tags":[{"id":"hoc-thuat","title":"hoc-thuat","path":"/tag/hoc-thuat/"},{"id":"javascript","title":"javascript","path":"/tag/javascript/"}],"desc":"Má»™t sá»‘ váº¥n Ä‘á» vá» setTimeout Ä‘Ã¡ng Ä‘á»ƒ báº¡n cÃ¢n nháº¯c trÆ°á»›c khi sá»­ dá»¥ng","content":"<!-- TOC -->\n<ul>\n<li><a href=\"#setinterval\">setInterval</a></li>\n<li><a href=\"#settimeout\">setTimeout</a></li>\n</ul>\n<!-- /TOC -->\n<p>Náº¿u báº¡n cáº§n gá»i má»™t hÃ m <strong>láº·p láº¡i</strong> theo má»™t khoáº£n thá»i gian nháº¥t Ä‘á»‹nh trong javascript báº¡n sáº½ dÃ¹ng gÃ¬? Má»™t lÃ  dÃ¹ng <code class=\"language-text\">setInterval</code>  hay lÃ  Ä‘á»‡ quy <code class=\"language-text\">setTimeout</code></p>\n<p>VÃ¬ sao báº¡n nÃªn cÃ¢n nháº¯c trÆ°á»›c khi sá»­ dá»¥ng <code class=\"language-text\">setInterval</code>, nÃ³ Ä‘Ã£ gÃ¢y ra tá»™i tÃ¬nh gÃ¬? VÃ¬ sao sáº½ tá»‘t hÆ¡n náº¿u chÃºng ta láº¯ng nghe vÃ  Ä‘á»£i má»™t <em>tÃ­n hiá»‡u</em> nÃ o Ä‘Ã³ rá»“i cháº¡y</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token dom variable\">window</span><span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">onload</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Ä‘á»£i tÃ­nh hiá»‡u nÃ o Ä‘Ã³ rá»“i thá»±c thi má»™t sá»‘ viá»‡c</span>\n  <span class=\"token comment\">// sáº½ luÃ´n lÃ  lá»±a chá»n tá»‘t nháº¥t</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Náº¿u Ã´ng bÃ  cÃ³ dáº¡y <em>Ä‘á»£i mua bÃ² má»›i Ä‘i lÃ m chuá»“ng thÃ¬ Ä‘Ã£ muá»™n</em> khÃ´ng Ä‘Ãºng trong trÆ°á»ng há»£p nÃ y. <strong>CÃ“</strong> trÆ°á»›c háº³n lÃ m gÃ¬ thÃ¬ lÃ m.</p>\n<h3 id=\"setinterval\"><a href=\"#setinterval\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>setInterval</h3>\n<p>Vá»›i <code class=\"language-text\">setInterval</code> nÃ³ sáº½ tiáº¿p tá»¥c cháº¡y cho tá»›i khi chÃºng ta ra lá»‡nh xÃ³a nÃ³ hoáº·c Ä‘Ã³ng luÃ´n trÃ¬nh duyá»‡t.</p>\n<p><code class=\"language-text\">setInterval</code> cam káº¿t Ä‘oáº¡n code cá»§a chÃºng ta nÃ³ sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o <strong>STACK</strong> theo Ä‘Ãºng má»™t chu ká»³ thá»i gian. <em>Tuy nhiÃªn</em>, Ä‘oáº¡n code nÃ y cá»§a báº¡n <strong>khÃ´ng Ä‘Æ°á»£c cam káº¿t</strong> sáº½ cháº¡y theo Ä‘Ãºng chu ká»³ thá»i gian, phá»¥ thuá»™c vÃ o cÃ¡c yáº¿u tá»‘ khÃ¡c ná»¯a, vÃ  Ä‘Ã£ pháº§n lÃ  cÃ³ Ä‘á»™ trá»…, theo má»™t cÃ¡ch dÃ¢n gian ta gá»i nÃ³ lÃ  <strong>HÃŠN XUI</strong></p>\n<p><img src=\"https://miro.medium.com/max/1837/1*A138JkWveIfKajztvhu60g.png\" alt=\"BÃ n luáº­n vá» setTimeout vÃ  setInterval trong javascript\"></p>\n<p>Thá»i gian cháº¡y cá»§a hÃ m <code class=\"language-text\">dummyMethod1</code> tá»‘n nhiá»u thá»i gian hÆ¡n dá»± tÃ­nh, <em>lÃ½ do thÃ¬ khÃ´ng rÃµ</em>.</p>\n<blockquote>\n<p>Javascript Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ cháº¡y single thread, nÃ³ <strong>khÃ´ng</strong> thá»±c hiá»‡n hai cÃ´ng viá»‡c cÃ¹ng má»™t lÃºc.</p>\n</blockquote>\n<p>Äiá»u Ä‘Ã³ cÃ³ nghÄ©a, cÃ¡c phÆ°Æ¡ng thá»©c khÃ¡c phÃ­a trÃªn stack pháº£i <strong>Ä‘á»£i</strong> cho Ä‘áº¿n khi <code class=\"language-text\">dummyMethod1</code> lÃ m xong cÃ´ng chuyá»‡n cá»§a nÃ³.</p>\n<p>ThÃªm má»™t vÃ­ dá»¥ khÃ¡c, náº¿u hÃ m khai bÃ¡o bÃªn trong <code class=\"language-text\">setInterval</code> cÃ³ thá»i gian cháº¡y lá»›n hÆ¡n giÃ¡ trá»‹ delay cá»§a <code class=\"language-text\">setInterval</code> (vÃ­ dá»¥ nhÆ° hÃ m gá»i ajax), chÃºng ta sáº½ cÃ³ váº¥n Ä‘á» nhÆ° tháº¿ nÃ y</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> <span class=\"token function-variable function\">fakeCallToServer</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'returning from server'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n <span class=\"token keyword\">let</span> insideSetInterval <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'insideSetInterval'</span><span class=\"token punctuation\">,</span> insideSetInterval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n <span class=\"token function\">fakeCallToServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">//insideSetInterval 14:13:47</span>\n<span class=\"token comment\">//insideSetInterval 14:13:49</span>\n<span class=\"token comment\">//insideSetInterval 14:13:51</span>\n<span class=\"token comment\">//returning from server 14:13:51</span>\n<span class=\"token comment\">//insideSetInterval 14:13:53</span>\n<span class=\"token comment\">//returning from server 14:13:53</span>\n<span class=\"token comment\">//insideSetInterval 14:13:55</span>\n<span class=\"token comment\">//returning from server 14:13:55</span></code></pre>\n<p>NhÆ° káº¿t quáº£ á»Ÿ trÃªn cho tháº¥y, cÃ¢u <code class=\"language-text\">console.log(&quot;insideSetInterval&quot;)</code> sáº½ liÃªn tá»¥c gá»i ajax báº¥t ká»ƒ trÆ°á»›c Ä‘Ã³ Ä‘Ã£ gá»i thÃ nh cÃ´ng chÆ°a. ÄÃ¡ng láº½ chÃºng ta pháº£i káº¿t thÃºc viá»‡c gá»i liÃªn tá»¥c nÃ y, Ä‘a pháº§n chÃºng ta quÃªn <code class=\"language-text\">clearInterval</code>. NÃ³ sáº½ táº¡o ra má»™t hÃ ng Ä‘á»£i <em>dÃ i ngoáº±n</em> trong stack.</p>\n<p>Giá» thá»­ má»™t xá»­ lÃ½ tuáº§n tá»± trong <code class=\"language-text\">setInterval</code></p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> counter <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">fakeTimeIntensiveOperation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">var</span> i <span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">&lt;</span> <span class=\"token number\">50000000</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'random'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">let</span> insideTimeTakingFunction  <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'insideTimeTakingFunction'</span><span class=\"token punctuation\">,</span> insideTimeTakingFunction<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> timer <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> insideSetInterval <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">toLocaleTimeString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'insideSetInterval'</span><span class=\"token punctuation\">,</span> insideSetInterval<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    counter<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword control-flow\">if</span><span class=\"token punctuation\">(</span>counter <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n        <span class=\"token function\">fakeTimeIntensiveOperation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>counter <span class=\"token operator\">>=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>timer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">//insideSetInterval 13:50:53</span>\n<span class=\"token comment\">//insideTimeTakingFunction 13:50:55</span>\n<span class=\"token comment\">//insideSetInterval 13:50:55 &lt;---- máº¥t tiÃªu cÃ¢u gá»i lÃºc 54 giÃ¢y</span>\n<span class=\"token comment\">//insideSetInterval 13:50:56</span>\n<span class=\"token comment\">//insideSetInterval 13:50:57</span>\n<span class=\"token comment\">//insideSetInterval 13:50:58</span></code></pre>\n<p>Nhá»¯ng gÃ¬ Ä‘ang diá»…n ra á»Ÿ trÃªn, vá»›i má»™t thao tÃ¡c tá»‘n <em>kha khÃ¡</em> thá»i gian xá»­ lÃ½, nÃ³ máº¥t háº³n Ä‘oáº¡n code <code class=\"language-text\">console.log(&quot;insideSetInterval&quot;)</code>, nÃ´m na lÃ  nÃ³ bá»‹ <em>Ä‘á»©t má»™t nhá»‹p</em>, tÃ¬nh huá»‘ng nÃ y xáº£y ra vá»›i Chrome, nÃ³ táº¡o ra má»™t <em>nhá»‹p</em> má»›i.</p>\n<p>Thay vÃ¬ dÃ¹ng <code class=\"language-text\">setInterval</code>, chÃºng ta cÃ³ thá»ƒ dÃ¹ng Ä‘á»‡ quy <code class=\"language-text\">setTimeout</code></p>\n<h3 id=\"settimeout\"><a href=\"#settimeout\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>setTimeout</h3>\n<p>Máº·c dÃ¹ cÅ©ng chÆ°a háº³n cam káº¿t 100% Ä‘oáº¡n code cá»§a chÃºng cháº¡y Ä‘Ãºng theo má»™t chu ká»³ Ä‘Ã£ Ä‘á»‹nh vá»›i Ä‘á»‡ quy <code class=\"language-text\">setTimeout</code>. ChÃ­ Ã­t nÃ³ cÅ©ng khÃ´ng gÃ¢y ra chuyá»‡n Ä‘Æ°a hÃ ng Ä‘á»‘ng lá»‡nh chá» cháº¡y vÃ o trong stack</p>\n<p><img src=\"https://miro.medium.com/max/1920/1*A9gNYo3pOtnzuXi30NHjfA.png\" alt=\"BÃ n luáº­n vá» setTimeout vÃ  setInterval trong javascript\"></p>\n<p>Khi thá»±c hiá»‡n báº±ng <code class=\"language-text\">setTimeout</code>, bÃªn trong vÃ²ng Ä‘á»‡ quy chÃºng ta Ä‘Ã£ cÃ³ bÆ°á»›c kiá»ƒm tra <strong>cÃ³ nÃªn</strong> gá»i thÃªm láº§n ná»¯a khÃ´ng.</p>\n<p>LÆ°u Ã½ khi báº¡n dÃ¹ng setTimeout, chá»› cÃ³ <strong>thá»±c thi</strong> hÃ m Ä‘Ã³ luÃ´n (kÃ¨m dáº¥u <code class=\"language-text\">()</code>), chÃºng ta chá»‰ truyá»n hÃ m Ä‘Ã³ thÃ´i</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">sayHi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// â˜  Lá»—i</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token function\">sayHi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// ğŸ‘ OK</span>\n<span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>sayHi<span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span></code></pre>\n<p><strong>Nguá»“n tham kháº£o</strong></p>\n<p><a href=\"https://dev.to/akanksha_9560/why-not-to-use-setinterval--2na9\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Why not to use setInterval</a></p>\n<p><a href=\"https://develoger.com/settimeout-vs-setinterval-cff85142555b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">setTimeout VS setInterval</a></p>\n<p><a href=\"https://javascript.info/settimeout-setinterval\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Scheduling: setTimeout and setInterval</a></p>\n","cover_image":"","related":[{"id":"5e248b4a520eaec55f161a88ec17d512","path":"/6-vi-du-de-ban-yeu-luon-observable/","title":"6 vÃ­ dá»¥ Ä‘á»ƒ báº¡n yÃªu luÃ´n observable","desc":"ThÃªm nhá»¯ng lÃ½ do Ä‘á»ƒ dá»¥ dá»— báº¡n xÃ i Observable"},{"id":"0a408624be828657679088cbca8986c7","path":"/tiep-tuc-luan-ban-ve-cach-to-chuc-thu-muc-dat-ten-component-trong-react/","title":"Tiáº¿p tá»¥c luáº­n bÃ n vá» cÃ¡ch tá»• chá»©c thÆ° má»¥c, Ä‘áº·t tÃªn component trong React","desc":"Há»•m Ä‘Ã£ viáº¿t vá» váº¥n Ä‘á» nÃ y rá»“i, giá» láº¡i viáº¿t tiáº¿p, vÃ¬ báº£n thÃ¢n React cÅ©ng khÃ´ng ra báº¥t cá»© rule nÃ o vá» viá»‡c nÃ y, báº¡n tá»± do tá»• chá»©c sao mÃ  mÃ¬nh tháº¥y há»£p lÃ½, bÃ i trÆ°á»›c lÃ  cá»§a tÃ¡c giáº£ Ä‘Ã³ tháº¥y váº­y lÃ  hay, bÃ i nÃ y thÃ¬ tÃ¡c giáº£ thÃ­ch tá»• chá»©c tháº¿ nÃ y"},{"id":"a511f45934f382e37f45b49f489d08df","path":"/sort-trong-javascript/","title":"Sort trong javascript","desc":"Náº¿u nghÄ© Ä‘Ã£ hiá»ƒu rÃµ hÃ m Array.sort() trong javascript, hÃ£y nghÄ© láº¡i!"}]}},"context":{}}