{"hash":"ca8a3844c93056872b1afa01b60fd6e6ab747ca0","data":{"post":{"title":"AWS SCP là gì","path":"/2022-09-06-aws-scp-permission-boundary-iam/","slug":"2022-09-06-aws-scp-permission-boundary-iam","date":"2022-09-06","timeToRead":2,"tags":[{"id":"aws","title":"aws","path":"/tag/aws/"},{"id":"beginner","title":"beginner","path":"/tag/beginner/"}],"desc":"Series một số kiến thức cần có để lấy chứng chỉ AWS","content":"<h2 id=\"aws-scp-là-gì\"><a href=\"#aws-scp-l%C3%A0-g%C3%AC\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>AWS SCP là gì</h2>\n<p>SCP là một tập hợp các rule <strong>cấp quyền</strong> sử dụng resource AWS trên tất cả account trong một AWS Organization</p>\n<h2 id=\"tại-sao-sử-dụng-scp\"><a href=\"#t%E1%BA%A1i-sao-s%E1%BB%AD-d%E1%BB%A5ng-scp\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Tại sao sử dụng SCP</h2>\n<p>Khi một tổ chức có nhiều account cần quản lý, việc quản lý sẽ khó khăn nếu chỉ sử dụng IAM</p>\n<p>IAM cho phép chúng ta kiểm soát quyền hạn trên từng user và role của một account, nhưng nếu chúng ta cần quản lý quyền hạn trên nhiều role/nhiều account cùng lúc sẽ cần đến một công cụ bao quát hơn</p>\n<blockquote>\n<blockquote>\n<p>OU (Organizational Unit) = tổ hợp các account được quản lý, SCP sẽ áp các rule trên từng OU</p>\n</blockquote>\n</blockquote>\n<p><img src=\"https://towardsthecloud.com/wp-content/uploads/aws-org-scp-diagram-1024x928.webp\"></p>\n<p>Như hình trên OU sẽ thường được định danh như các đơn vị <em>ban ngành</em> trong một tổ chức, chúng ta có <em>đội</em> nằm trong <code class=\"language-inline-text\">Core</code>, đội làm <code class=\"language-inline-text\">Application</code>, đội <code class=\"language-inline-text\">Development</code></p>\n<blockquote>\n<p>Lưu ý chỉ có thể áp tối đa <strong>5</strong> SCP trên một root/OU/account</p>\n</blockquote>\n<p>Ví dụ khai báo một policy <em>deny</em> việc sử dụng AWS Shield service</p>\n<div class=\"gridsome-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"Version\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2012-10-17\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token property\">\"Statement\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n\t\t<span class=\"token punctuation\">{</span>\n\t\t\t<span class=\"token property\">\"Sid\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Statement1\"</span><span class=\"token punctuation\">,</span>\n\t\t\t<span class=\"token property\">\"Effect\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Deny\"</span><span class=\"token punctuation\">,</span>\n\t\t\t<span class=\"token property\">\"Action\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"shield:*\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\t\t\t<span class=\"token property\">\"Resource\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"*\"</span><span class=\"token punctuation\">]</span>\n\t\t<span class=\"token punctuation\">}</span>\n\t<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Vì SCP cũng có thể áp dụng trên root account, nên hãy rất cẩn thận và test kỹ trước khi áp dụng policy nào đó trên root account, tránh trường hợp mất các quyền quan trọng</p>\n<h2 id=\"scp-vs-permission-boundary-vs-iam-userrole-permission\"><a href=\"#scp-vs-permission-boundary-vs-iam-userrole-permission\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>SCP vs Permission Boundary vs IAM User/Role Permission</h2>\n<p>SCP không phải chỉ để cấp quyền, nó còn có thể <em>deny</em>, có thể hình dung nó như một danh sách có thể làm gì và không được làm gì (<strong>Deny/Allow action</strong>) trên một nhóm đối tượng trong <strong>Organization</strong></p>\n<p><img src=\"https://cloudacademy.com/wp-content/uploads/2021/03/Screenshot-2021-03-05-at-16.55.23.png\"></p>\n<table>\n<thead>\n<tr>\n<th>SCP</th>\n<th>IAM Policies</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Dùng với OU</td>\n<td>Dùng với Principal (Ai)</td>\n</tr>\n<tr>\n<td>Không thay thế IAM Policy</td>\n<td>identity-base -> dùng với user, group, role. resource-base -> dùng với AWS resource như S3</td>\n</tr>\n<tr>\n<td>Dùng được với Root account</td>\n<td>Không dùng được với Root account</td>\n</tr>\n<tr>\n<td>Một account con chỉ có số quyền như account cha hoặc ít hơn</td>\n<td>Chỉ 1 trong 2: allow hoặc deny, nếu allow thì ngầm hiểu phần còn lại deny, nếu deny ngầm hiều phần còn lại allow</td>\n</tr>\n</tbody>\n</table>\n<p>Còn về Permission Boundaries nó được sử dụng cho user/role (một IAM entity), nó cấp <strong>maximum permission mà identity-base có thể cấp cho một IAM entity</strong>, nó không dùng được với <strong>resource-base</strong>, trong khi đó SCP có thể áp dụng trên cả identity-base và resource-base</p>\n<h2 id=\"tóm-tắt-thuật-ngữ\"><a href=\"#t%C3%B3m-t%E1%BA%AFt-thu%E1%BA%ADt-ng%E1%BB%AF\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Tóm tắt thuật ngữ</h2>\n<table>\n<thead>\n<tr>\n<th>Thuật ngữ</th>\n<th>Giải thích</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>resource-base policy</td>\n<td>policy dùng với user, group, role</td>\n</tr>\n<tr>\n<td>identity-base policy</td>\n<td>policy dùng với các service của AWS</td>\n</tr>\n<tr>\n<td>Organization</td>\n<td>Đơn vị chúng ta khai bảo để tiện quản lý</td>\n</tr>\n</tbody>\n</table>\n","cover_image":"","related":[{"id":"dec66a9345d632cbe065f67437fb0729","path":"/2018-02-14-huong-dan-redux-la-gi-tai-sao-phai-dung/","title":"Redux là gì và tại sao phải dùng?","desc":"Nếu đã đụng tới React thì sớm muộn gì bạn cũng sẽ nghe đến Redux"},{"id":"9f5f4f8c111294ac9f85e2f30e060a75","path":"/2018-05-25-huong-dan-viet-code-javascript-tot-hon-voi-webpack/","title":"Webpack là gì và tại sao ta phải xài nó","desc":"Bài này sẽ nói rõ tại sao Webpack là sự lựa chọn sáng suốt cho bundle javascript"},{"id":"e7c293f2b5f883e552990038574c3c90","path":"/2020-08-14-mixins/","title":"Mixin của JS","desc":""}]}},"context":{}}