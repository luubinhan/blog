{"hash":"6000b69201124b9452c41d38889aba5b11cf5e89","data":{"post":{"title":"Làm layout masonry bằng flexbox","path":"/2019-05-15-huong-dan-layout-masonry-bang-flexbox/","date":"2019-05-15","timeToRead":3,"tags":[{"id":"css","title":"css","path":"/tag/css/"}],"desc":"Những ngày làm masonry layout với các thư viện jquery đã ko còn nữa","content":"<p>Một trong những cách đơn giản nhất để tạo masonry layout là dùng flexbox, tất cả những gì cần làm là set <code class=\"language-text\">flex-flow: column wrap</code> và <code class=\"language-text\">height: giá-trị-độ-cao-nào-đó</code>, là bạn có kiểu layout nổi tiếng của pinterest.</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* hiển thị theo dạng column, rớt dòng khi cần thiết */</span>\n<span class=\"token selector\"><span class=\"token class\">.container</span></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">flex-flow</span><span class=\"token punctuation\">:</span> column wrap<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">align-content</span><span class=\"token punctuation\">:</span> space-between<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/* fixed height, cao hơn độ cao của item cao nhất */</span>\n    <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">960</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Cách này bị một vấn đề, thứ tự các item chúng ta sẽ là như thế này\n<img src=\"https://i.imgur.com/Xiyr8Gj.jpg\" alt=\"Làm layout masonry bằng flexbox\"></p>\n<p>Đây không phải là kết quả chúng ta mong muốn, nó phải xếp các item từ trái qua phải mới hợp gu</p>\n<p>Nếu chuyển giá trị <code class=\"language-text\">flex-direction: row</code>, thứ tự sẽ đúng như mong muốn, tuy nhiên nó lại bị khoảng trống khi các item có độ cao không đồng nhất, như thế này </p>\n<p><img src=\"https://i.imgur.com/iC5BJRw.jpg\" alt=\"Làm layout masonry bằng flexbox\"></p>\n<p>Sử dụng kết hợp với 2 thuộc tính <code class=\"language-text\">:nth-child()</code> và <code class=\"language-text\">order</code> để giải quyết vấn đề này</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>Column 1</th>\n<th>Column 2</th>\n<th>Column 3</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Row 1</td>\n<td>1</td>\n<td>2</td>\n<td>3</td>\n</tr>\n<tr>\n<td>Row 2</td>\n<td>4</td>\n<td>5</td>\n<td>6</td>\n</tr>\n<tr>\n<td>Row 3</td>\n<td>7</td>\n<td>8</td>\n<td>9</td>\n</tr>\n<tr>\n<td>Row 4</td>\n<td>10</td>\n<td>11</td>\n<td>12</td>\n</tr>\n</tbody>\n</table>\n<p>Chúng ta có 3 cột, chúng ta sẽ xếp các item theo từng cột, nhưng order nó theo hàng</p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* sắp xếp lại theo từng dòng */</span>\n<span class=\"token selector\"><span class=\"token class\">.item</span><span class=\"token pseudo-class\">:nth-child</span><span class=\"token punctuation\">(</span><span class=\"token n-th\"><span class=\"token number\">3n</span><span class=\"token operator\">+</span><span class=\"token number\">1</span></span><span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span> <span class=\"token property\">order</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token selector\">// set order = 1 cho các item 1<span class=\"token punctuation\">,</span> 4<span class=\"token punctuation\">,</span> 7<span class=\"token punctuation\">,</span> 10<span class=\"token punctuation\">,</span>...\n<span class=\"token class\">.item</span><span class=\"token pseudo-class\">:nth-child</span><span class=\"token punctuation\">(</span><span class=\"token n-th\"><span class=\"token number\">3n</span><span class=\"token operator\">+</span><span class=\"token number\">2</span></span><span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span> <span class=\"token property\">order</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token selector\">// set order = 1 cho các item 2<span class=\"token punctuation\">,</span> 5<span class=\"token punctuation\">,</span> 8<span class=\"token punctuation\">,</span> 11<span class=\"token punctuation\">,</span>...\n<span class=\"token class\">.item</span><span class=\"token pseudo-class\">:nth-child</span><span class=\"token punctuation\">(</span><span class=\"token n-th\"><span class=\"token number\">3n</span></span><span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span> <span class=\"token property\">order</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n// set order = <span class=\"token number\">1</span> cho các item <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span>...</code></pre>\n<p>Với các item có cùng giá trị order như <code class=\"language-text\">1, 4, 7, 10</code> trình duyệt sẽ render theo thứ tự xuất hiện của html, một cách ngắn gọn với đoạn css trên chúng ta đã xếp các item lại theo thứ tự là <code class=\"language-text\">1,4,7,10,2,5,8,11,3,6,9,12</code></p>\n<p>Còn một trường hợp có thể xảy ra là item có độ cao ko <code class=\"language-text\">fill</code> hết chỗ trống trong cột, khi ấy nó sẽ dồn item đó về cột phía trước</p>\n<p><img src=\"https://i.imgur.com/4oBdLOd.png\" alt=\"Làm layout masonry bằng flexbox\"></p>\n<p>Để xử trí vụ này, đây là một cái trick khá vi diệu, chúng ta sẽ chèn 2 element <code class=\"language-text\">before</code> và <code class=\"language-text\">after</code> có giá trị  <code class=\"language-text\">order: 2</code> để các item sẽ theo thứ tự <code class=\"language-text\">1, 4, 7, 10, &lt;break&gt;, 2, 5, 8, 11, &lt;break&gt;, 3, 6, 9, 12</code></p>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* bắt buộc chèn vào cột mới */</span>\n<span class=\"token selector\"><span class=\"token class\">.container</span><span class=\"token pseudo-element\">::before</span><span class=\"token punctuation\">,</span>\n<span class=\"token class\">.container</span><span class=\"token pseudo-element\">::after</span></span> <span class=\"token punctuation\">{</span>\n<span class=\"token property\">content</span><span class=\"token punctuation\">:</span> “”<span class=\"token punctuation\">;</span>\n<span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span>\n<span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token property\">order</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Đường màu xám là 2 element <code class=\"language-text\">before</code> và <code class=\"language-text\">after</code></p>\n<p><img src=\"https://i.imgur.com/yTnodUu.jpg\" alt=\"Làm layout masonry bằng flexbox\"></p>\n<p>Toàn bộ source</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>item<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  ...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre>\n<pre class=\"language-css\"><code class=\"language-css\"><span class=\"token comment\">/* hiển thị theo dạng column, rớt dòng khi cần thiết */</span>\n<span class=\"token selector\"><span class=\"token class\">.container</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">flex-flow</span><span class=\"token punctuation\">:</span> column wrap<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">align-content</span><span class=\"token punctuation\">:</span> space-between<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">/* fixed height, cao hơn độ cao của item cao nhất */</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> <span class=\"token number\">600</span><span class=\"token unit\">px</span><span class=\"token punctuation\">;</span> \n<span class=\"token punctuation\">}</span>\n\n<span class=\"token selector\"><span class=\"token class\">.item</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">32</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/* sắp xếp lại theo từng dòng */</span>\n<span class=\"token selector\"><span class=\"token class\">.item</span><span class=\"token pseudo-class\">:nth-child</span><span class=\"token punctuation\">(</span><span class=\"token n-th\"><span class=\"token number\">3n</span><span class=\"token operator\">+</span><span class=\"token number\">1</span></span><span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span> <span class=\"token property\">order</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token selector\">// set order = 1 cho các item 1<span class=\"token punctuation\">,</span> 4<span class=\"token punctuation\">,</span> 7<span class=\"token punctuation\">,</span> 10<span class=\"token punctuation\">,</span>...\n<span class=\"token class\">.item</span><span class=\"token pseudo-class\">:nth-child</span><span class=\"token punctuation\">(</span><span class=\"token n-th\"><span class=\"token number\">3n</span><span class=\"token operator\">+</span><span class=\"token number\">2</span></span><span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span> <span class=\"token property\">order</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token selector\">// set order = 1 cho các item 2<span class=\"token punctuation\">,</span> 5<span class=\"token punctuation\">,</span> 8<span class=\"token punctuation\">,</span> 11<span class=\"token punctuation\">,</span>...\n<span class=\"token class\">.item</span><span class=\"token pseudo-class\">:nth-child</span><span class=\"token punctuation\">(</span><span class=\"token n-th\"><span class=\"token number\">3n</span></span><span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span> <span class=\"token property\">order</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n// set order = <span class=\"token number\">1</span> cho các item <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span>...\n\n<span class=\"token comment\">/* bắt buộc chèn vào cột mới */</span>\n<span class=\"token selector\"><span class=\"token class\">.container</span><span class=\"token pseudo-element\">::before</span><span class=\"token punctuation\">,</span>\n<span class=\"token class\">.container</span><span class=\"token pseudo-element\">::after</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">content</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">flex-basis</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token unit\">%</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">width</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">order</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p><a href=\"https://codepen.io/collection/XPjvPP/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Toàn bộ source trên codepen</a></p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://tobiasahlin.com/blog/masonry-with-css/\">CSS masonry with flexbox, :nth-child(), and order</a></p>\n","cover_image":"","related":[{"id":"4a83ae2c626a625e60998ef95d851361","path":"/2018-05-28-huong-dan-webpack-4-cho-nguoi-moi-bat-dau-phan-3/","title":"Hướng dẫn webpack 4 cho người mới bắt đầu - Phần 3","desc":"Bài này sẽ nói Plugins, Development, HotModuleReplacement trong Webpack"},{"id":"f9b9d628fc5725a639e6c8edff449057","path":"/2018-10-01-huong-dan-gioi-thieu-fetch-javascript/","title":"Giới thiệu fetch() của javascript","desc":"Tạm biệt XMLHttpRequest và cách viết dài dòng, giờ đây ta đã có fetch API"},{"id":"602ee60e13b24674edaaff08323382ff","path":"/2017-10-12-javascript-promise/","title":"Nắm vững Promise trong javascript","desc":"Cùng tìm hiểu Promise của javascript, tự tạo một Promise"}]}},"context":{}}