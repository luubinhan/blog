{"hash":"ca8a3844c93056872b1afa01b60fd6e6ab747ca0","data":{"post":{"title":"Dựng component layout với Vue","path":"/2018-11-21-huong-dan-lam-layout-voi-vue-md/","slug":"/2018-11-21-huong-dan-lam-layout-voi-vue.md","date":"2018-11-21","timeToRead":6,"tags":[{"id":"vuejs","title":"vuejs","path":"/tag/vuejs/"}],"desc":"Khi mình nói đến layout, là ám chỉ đến những phần giống nhau trên trang, như cái sườn chính của website là header, footer sẽ giống nhau trên tất cả trang, chỉ phần bên trong là khác nhau.","content":"<!-- TOC -->\n<ul>\n<li><a href=\"#render-theo-%C4%91i%E1%BB%81u-ki%E1%BB%87n\">Render theo điều kiện</a></li>\n<li><a href=\"#d%C3%B9ng-m%E1%BB%99t-wrapper-component\">Dùng một wrapper component</a></li>\n<li><a href=\"#ch%E1%BB%A7-%C4%91%E1%BB%99ng-thay-%C4%91%E1%BB%95i-component-layout\">Chủ động thay đổi component layout</a></li>\n<li><a href=\"#ch%E1%BB%A7-%C4%91%E1%BB%99ng-thay-%C4%91%E1%BB%95i-component-layout-v%E1%BB%9Bi-renderless-component\">Chủ động thay đổi component layout với renderless component</a></li>\n<li><a href=\"#ch%E1%BB%A7-%C4%91%E1%BB%99ng-import-khi-c%E1%BA%A7n-thi%E1%BA%BFt\">Chủ động import khi cần thiết</a></li>\n<li><a href=\"#t%E1%BB%95ng-k%E1%BA%BFt\">Tổng kết</a></li>\n</ul>\n<!-- /TOC -->\n<p>Nếu dùng Vue CLI để khởi tạo, bạn sẽ có sẵn layout như thế này</p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>App<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>nav</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>App__nav<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>router-link</span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Home</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>router-link</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> |\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>router-link</span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/about<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">About</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>router-link</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>nav</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>router-view</span><span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>footer</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      &amp;copy; Awesome Company\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>footer</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Nếu chúng ta không cần các dạng layout khác nhau, chỉ một kiểu layout duy nhất thì có thể dùng cách này là đủ.</p>\n<p>Ví dụ như bạn đang cần một cái sidebar mà nó sẽ có vài dạng khác nhau cho từng loại trang, bạn cần tìm hiểu thêm một số cách làm layout của Vue</p>\n<h2 id=\"render-theo-điều-kiện\"><a href=\"#render-theo-%C4%91i%E1%BB%81u-ki%E1%BB%87n\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Render theo điều kiện</h2>\n<p>Cách tiếp cận ai cũng nghĩ đến đầu tiên sẽ là dùng <code class=\"language-inline-text\">v-if</code> để render một vài phần khác nhau theo điều kiện cụ thể.</p>\n<div class=\"gridsome-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted-arrow deleted\"><span class=\"token prefix deleted\">&lt;</span><span class=\"token line\">template>\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">  &lt;div class=\"App\">\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">    &lt;nav class=\"App__nav\">\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;nav v-if=\"showNav\" class=\"App__nav\">\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">      &lt;router-link to=\"/\">Home&lt;/router-link> |\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">      &lt;router-link to=\"/about\">About&lt;/router-link>\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">    &lt;/nav>\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">    &lt;router-view/>\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">    &lt;footer>\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;footer v-if=\"showFooter\">\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">      &amp;copy; Awesome Company\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">    &lt;/footer>\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">  &lt;/div>\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">&lt;/template></span></span></code></pre></div>\n<p>Với cách này chúng ta phải dùng thêm khá nhiều biến để kiểm soát được việc khi nào thì hiển thị và ẩn một element.</p>\n<p>Tuy nhiên, nếu ứng dụng lớn, bạn không nên dùng cách này vì nó sẽ nhanh chóng trở thành mớ code hầm bà lằng</p>\n<h2 id=\"dùng-một-wrapper-component\"><a href=\"#d%C3%B9ng-m%E1%BB%99t-wrapper-component\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Dùng một wrapper component</h2>\n<p>Chúng ta sẽ dựng một component làm layout, chừa một vài vị trí trong component để chèn các element khác vào đó, trong React gọi là <code class=\"language-inline-text\">children</code>, trong Vue thì nó mạnh hơn, vì nó cho bạn đặt nhiều vị trí khác nhau bằng <code class=\"language-inline-text\">slot</code>.</p>\n<p>Rất nhiều người thích xài cách này, và mình cũng thuộc nhóm đó.</p>\n<p>Bên trong <code class=\"language-inline-text\">src/App.vue</code> chúng ta chỉ cần render <code class=\"language-inline-text\">&lt;router-view/></code></p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>App<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>router-view</span><span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>File <code class=\"language-inline-text\">src/layouts/LayoutDefault.vue</code> sẽ chứa các component dùng chung, <code class=\"language-inline-text\">&lt;slot/></code> là nơi sẽ render component con.</p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>LayoutDefault<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>nav</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>LayoutDefault__nav<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>router-link</span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Home</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>router-link</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> |\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>router-link</span> <span class=\"token attr-name\">to</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/about<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">About</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>router-link</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>nav</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>main</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>LayoutDefault__main<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>slot</span><span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>main</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>footer</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>LayoutDefault__footer<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      &amp;copy; Awesome Company\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>footer</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Giờ nếu trang Home dùng layout này</p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n\t</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>layout-default</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n\t\t… Nội dung trang Home ….\n\t</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>layout-default</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\nimport LayoutDefault from ‘../layouts/LayoutDefault.vue’\nexport default {\n\tcomponents: {\n\t\tLayoutDefault,\n\t}\n}\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Để đặt nhiều slot hơn, bạn đọc thêm <a href=\"https://vuejs.org/v2/guide/components-slots.html#Named-Slots\"> ở trang chủ</a></p>\n<p>Tuy nhiên, vấn đề của cách làm này là khi component Home được update, nó cũng phải render lại <code class=\"language-inline-text\">&lt;LayoutDefault/></code>, vì nó nằm cùng file mà</p>\n<h2 id=\"chủ-động-thay-đổi-component-layout\"><a href=\"#ch%E1%BB%A7-%C4%91%E1%BB%99ng-thay-%C4%91%E1%BB%95i-component-layout\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Chủ động thay đổi component layout</h2>\n<p>Nghe đồn component của Vue mạnh dữ lắm, nó có một component tên là <code class=\"language-inline-text\">&lt;component /></code> !</p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component</span> <span class=\"token attr-name\">:is</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>SomeComponent<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>Trong đó biến <code class=\"language-inline-text\">SomeComponent</code> có thể được gán cho bất kỳ component nào, nó sẽ thay cái SomeComponent được gán lúc đó như là <code class=\"language-inline-text\">&lt;component/></code></p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component</span> <span class=\"token attr-name\">:is</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>bien-so<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">A</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>component</span><span class=\"token punctuation\">></span></span>\n<span class=\"token comment\">// rồi đâu đó bạn gán lại cái bien-so thành &lt;LayoutComponent /></span>\n<span class=\"token comment\">// Nó sẽ render thành</span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">LayoutComponent</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">A</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">LayoutComponent</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Bên trong <code class=\"language-inline-text\">App.vue</code> chúng ta sửa lại để trên <code class=\"language-inline-text\">&lt;router-view/></code> có thể tự thay đổi giá trị của <code class=\"language-inline-text\">layout</code>, chúng ta dùng thêm <code class=\"language-inline-text\">:layout.sync</code>, trên component con chúng ta chỉ cần emit <code class=\"language-inline-text\">update:layout</code> để cập nhập lại giá trị layout</p>\n<p><strong>Nhớ return data cho layout là <code class=\"language-inline-text\">div</code> để nếu không có gán giá trị nào thì nó sẽ lấy default là <code class=\"language-inline-text\">div</code></strong></p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>component</span> <span class=\"token attr-name\">:is</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>layout<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>router-view</span> <span class=\"token attr-name\">:layout.sync</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>layout<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>component</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\nexport default {\n  name: 'App',\n  data() {\n    return {\n      layout: 'div',\n    };\n  },\n};\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Trên Home chúng ta emit sự kiện để thay giá trị layout khi component <code class=\"language-inline-text\">created()</code></p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Home<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Home</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    ...\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\nimport LayoutDefault from '../layouts/LayoutDefault.vue';\n\nexport default {\n  name: 'Home',\n  created() {\n    this.$emit('update:layout', LayoutDefault);\n  },\n};\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Mình đồng ý là mới nhìn nó sẽ hơi phức tạp và kỳ cục hơn cách wrap component cha con bình thường.</p>\n<blockquote>\n<p>Khác nhau chính là ở chỗ component layout không nằm trong component router view.</p>\n</blockquote>\n<p>Nó giúp cho việc thay đổi qua trang khác nếu vẫn cùng 1 layout được emit, nó không update lại <code class=\"language-inline-text\">LayoutDefault</code>, chỉ update phần router view</p>\n<iframe src=\"https://codesandbox.io/embed/184177316l\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<h2 id=\"chủ-động-thay-đổi-component-layout-với-renderless-component\"><a href=\"#ch%E1%BB%A7-%C4%91%E1%BB%99ng-thay-%C4%91%E1%BB%95i-component-layout-v%E1%BB%9Bi-renderless-component\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Chủ động thay đổi component layout với renderless component</h2>\n<p>Trong Vue nó còn có cái gọi là Renderless Component, chúng ta sẽ sử dụng nó để việc chủ động chọn layout dễ dàng hơn ở trên</p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>layout-default-dynamic</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Home<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Home</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      &lt;!-- ... -->\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>layout-default-dynamic</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\nimport LayoutDefaultDynamic from '../layouts/LayoutDefaultDynamic';\n\nexport default {\n  name: 'Home',\n  components: {\n    LayoutDefaultDynamic,\n  },\n};\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Giống như cách <a href=\"#d%C3%B9ng-m%E1%BB%99t-wrapper-component\">Dùng một wrapper component</a>, nhưng chúng sẽ build <code class=\"language-inline-text\">&lt;layout-default-dynamic/></code> theo kiểu renderless, nó không chứa html markup</p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// src/layouts/LayoutDefaultDynamic.js</span>\n<span class=\"token keyword\">import</span> LayoutDefault <span class=\"token keyword\">from</span> <span class=\"token string\">'./LayoutDefault.vue'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'LayoutDefaultDynamic'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">created</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$parent<span class=\"token punctuation\">.</span><span class=\"token function\">$emit</span><span class=\"token punctuation\">(</span><span class=\"token string\">'update:layout'</span><span class=\"token punctuation\">,</span> LayoutDefault<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$slots<span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Chúng ta đã bỏ hết phần template đi, thay vào đó dùng hàm <code class=\"language-inline-text\">render</code> để return slot, gọi <code class=\"language-inline-text\">$parent.$emit</code></p>\n<h2 id=\"chủ-động-import-khi-cần-thiết\"><a href=\"#ch%E1%BB%A7-%C4%91%E1%BB%99ng-import-khi-c%E1%BA%A7n-thi%E1%BA%BFt\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Chủ động import khi cần thiết</h2>\n<p>Vẫn là lazy load component với webpack để tiết kiệm file bundle, tuy đơn giản nhưng hiệu quả vô cùng để cải thiện performance</p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> Vue <span class=\"token keyword\">from</span> <span class=\"token string\">'vue'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'Layout'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">props</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> String<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">required</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">created</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Kiểm tra xem component layout</span>\n    <span class=\"token comment\">// đã được đăng ký chưa</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>Vue<span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>components<span class=\"token punctuation\">[</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      Vue<span class=\"token punctuation\">.</span><span class=\"token function\">component</span><span class=\"token punctuation\">(</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">../layouts/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">.vue</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$parent<span class=\"token punctuation\">.</span><span class=\"token function\">$emit</span><span class=\"token punctuation\">(</span><span class=\"token string\">'update:layout'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>$slots<span class=\"token punctuation\">.</span>default<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gridsome-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted-arrow deleted\"><span class=\"token prefix deleted\">&lt;</span><span class=\"token line\">template>\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">  &lt;layout-default-dynamic>\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">  &lt;layout name=\"LayoutDefault\">\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">    &lt;div class=\"Home\">\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">      &lt;h1>Home&lt;/h1>\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">      &lt;!-- ... -->\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">    &lt;/div>\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">  &lt;/layout-default-dynamic>\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">  &lt;/layout>\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">&lt;/template>\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">&lt;script>\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">import LayoutDefaultDynamic from '../layouts/LayoutDefaultDynamic';\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">import Layout from '../layouts/Layout';\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">export default {\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">  name: 'Home',\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">  components: {\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">    LayoutDefaultDynamic,\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    Layout,\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">  },\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">};\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">&lt;/script></span></span></code></pre></div>\n<h2 id=\"tổng-kết\"><a href=\"#t%E1%BB%95ng-k%E1%BA%BFt\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Tổng kết</h2>\n<p>Nói chúng cách nào cũng sẽ tốt nhất cho từng trường hợp cụ thể nhất, không thể nói suông là cách này tốt hơn cách kia mà không test thực tế, bạn cứ thử, cứ test performance và xem nhu cầu của mình cần dùng đến cách nào, hoặc bạn thích cách nào hơn.</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/maoberlehner/dynamic-vue-layout-components\">Toàn bộ source code</a></p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://markus.oberlehner.net/blog/dynamic-vue-layout-components/\">Dynamic Vue.js Layout Components</a></p>\n","cover_image":"","related":[{"id":"ef1472ef5ffd2477f822bd69863b99e9","path":"/2019-10-20-huong-dan-ung-dung-tuyet-voi-cua-vue-renderless-component/","title":"Những ứng dụng tuyệt vời của Renderless component trong Vue","desc":"Cùng điểm qua các phương pháp để giải quyết bài toán 'DRY' trong Vue, các bạn sẽ biết thêm các kỹ thuật tương đối nâng cao để lên bật Vue lão làng."},{"id":"23cef98f247b0aa0d93755129dfad4c6","path":"/2019-07-21-function-component-trong-vue/","title":"Function Component trong Vue","desc":"Không được xuất chúng như là function component của React, nên function component trong Vue không có nhiều người để ý. Cùng tìm hiểu xem nếu muốn viết function component trong Vue thì chúng ta phải làm sao"},{"id":"6c5fec044498dd797ded807e27e60261","path":"/2022-12-16-giai-thich-dynamic-component-vue/","title":"Dynamic component trong Vue","desc":"Tìm hiểu khái niệm Dynamic component của Vue"}]}},"context":{}}