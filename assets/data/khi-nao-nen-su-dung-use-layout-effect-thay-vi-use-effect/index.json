{"hash":"b42727c700336131a477fb600bb04c628a9b0eca","data":{"post":{"title":"Khi nÃ o nÃªn sá»­ dá»¥ng useLayoutEffect thay vÃ¬ useEffect","path":"/khi-nao-nen-su-dung-use-layout-effect-thay-vi-use-effect/","date":"2020-01-02","timeToRead":2,"tags":[{"id":"thu-thuat","title":"thu-thuat","path":"/tag/thu-thuat/"},{"id":"react","title":"react","path":"/tag/react/"}],"desc":"2 React Hook lÃ m nhiá»‡m vá»¥ khÃ¡ giá»‘ng nhau lÃ  useEffect vÃ  useLayoutEffect báº¡n Ä‘Ã£ biáº¿t cÃ¡ch sá»­ dá»¥ng tháº¿ nÃ o cho Ä‘Ãºng","content":"<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// thá»±c hiá»‡n side effect</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token comment\">/* dá»n rÃ¡c */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>khai bÃ¡o cÃ¡c giÃ¡ trá»‹ mÃ  nÃ³ phá»¥ thuá»™c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">useLayoutEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// thá»±c hiá»‡n side effect</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token comment\">/* dá»n rÃ¡c */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>thá»±c hiá»‡n side effect<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Náº¿u ko cÃ³ khÃ¡c nhau thÃ¬ React team sáº½ khÃ´ng táº¡o ra 2 tháº±ng, hiá»ƒn nhiÃªn?. (Háº§u nhÆ° cÃ³ thá»ƒ dá»¥ng <code class=\"language-text\">useEffect</code> trong má»i tÃ¬nh huá»‘ng)</p>\n<p>KhÃ¡c nhau lÃ  á»Ÿ <strong>THá»œI GIAN THá»°C HIá»†N</strong></p>\n<p><code class=\"language-text\">useEffect</code> cháº¡y <strong>báº¥t tuáº§n tá»±</strong> vÃ  Ä‘á»£i <strong>sau</strong> khi viá»‡c component Ä‘Ã£ xuáº¥t hiá»‡n trÃªn mÃ n hÃ¬nh (sau khi trÃ¬nh duyá»‡t <em>paint</em>)</p>\n<p>QuÃ¡ trÃ¬nh cá»¥ tháº¿ lÃ  tháº¿ nÃ y</p>\n<ol>\n<li>Component gá»i Ä‘áº¿n <code class=\"language-text\">render</code></li>\n<li>MÃ n hÃ¬nh cáº­p nháº­p láº¡i UI má»›i</li>\n<li><strong>SAU ÄÃ“</strong> cháº¡y <code class=\"language-text\">useEffect</code></li>\n</ol>\n<p><code class=\"language-text\">useLayoutEffect</code>, ngÆ°á»£c láº¡i, cháº¡y <strong>tuáº§n tá»±</strong> sau khi render nhÆ°ng lÃ  <strong>trÆ°á»›c</strong> khi UI cáº­p nháº­p</p>\n<p>QuÃ¡ trÃ¬nh</p>\n<ol>\n<li>Component gá»i Ä‘áº¿n <code class=\"language-text\">render</code></li>\n<li><code class=\"language-text\">useLayoutEffect</code> Ä‘Æ°á»£c gá»i, Ä‘á»£i cháº¡y xong má»›i Ä‘i tiáº¿p</li>\n<li>MÃ n hÃ¬nh cáº­p nháº­p láº¡i UI má»›i</li>\n</ol>\n<p>Trong 99% cÃ¡c trÆ°á»ng há»£p, sá»­ dá»¥ng <code class=\"language-text\">useEffect</code>  sáº½ lÃ  cÃ¡ch tá»‘t nháº¥t, vÃ¬ nhá»¯ng effect cá»§a chÃºng ta sáº½ cáº§n Ä‘á»“ng bá»™ vá»›i prop, state, khÃ´ng cáº§n xáº£y ra <strong>NGAY Láº¬P Tá»¨C</strong> vÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n káº¿t quáº£ cuá»‘i cÃ¹ng cá»§a UI.</p>\n<p>VÃ­ dá»¥ nhÆ° fetch dá»¯ liá»‡u sáº½ khÃ´ng cáº§n cÃ³ káº¿t quáº£ ngay láº­p tá»©c, hay Ä‘áº·t Ä‘á»ƒ cÃ¡c event handler</p>\n<p>Náº¿u tháº¥y UI bá»‹ <code class=\"language-text\">flickering</code> (giá»‘ng nhÆ° xuáº¥t hiá»‡n sá»c sá»c trÃªn mÃ n hÃ¬nh tivi) khi cáº­p nháº­p, nguyÃªn nhÃ¢n do nÃ³ Ä‘Ã£ render khi <em>vá»«a cos</em> state, sau Ä‘Ã³ láº¡i re-render láº¡i vá»›i state nháº­n Ä‘Æ°á»£c sau cÃ¹ng. ÄÃ³ lÃ  lÃºc báº¡n dÃ¹ng <code class=\"language-text\">useLayoutEffect</code></p>\n<p>VÃ­ dá»¥ nhÃ©, báº¡n cho user click Ä‘á»ƒ thay Ä‘á»•i state <code class=\"language-text\">value</code>, nÃ³ sáº½ re-render component, sau Ä‘Ã³ effect cháº¡y, nÃ³ láº¡i set giÃ¡ trá»‹ <code class=\"language-text\">value</code> thÃ nh má»™t con sá»‘ ngáº«u nhiÃªn => láº¡i re-render component.</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">React</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  useState<span class=\"token punctuation\">,</span>\n  useLayoutEffect\n<span class=\"token punctuation\">}</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">ReactDOM</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\"><span class=\"token maybe-class-name\">BlinkyRender</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useLayoutEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token operator\">+</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'render'</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      value: </span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span> <span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token maybe-class-name\">ReactDOM</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BlinkyRender</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Vá»›i cÃ¡ch dÃ¹ng <code class=\"language-text\">useLayoutEffect</code> chÃºng ta chá»‰ cáº­p nháº­p UI Ä‘Ãºng <strong>1</strong> láº§n, trong khi component gá»i render <strong>2</strong> láº§n.</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://daveceddia.com/useeffect-vs-uselayouteffect/\">ğŸ“œ When to useLayoutEffect Instead of useEffect</a></p>\n","cover_image":"","related":[{"id":"1ba061475abb23bc0355ce6df2e57b4c","path":"/7-ly-do-ban-khong-nen-su-dung-type-script/","title":"7 lÃ½ do báº¡n khÃ´ng nÃªn sá»­ dá»¥ng TypeScript","desc":"TypeScript cÃ³ pháº£i lÃ  con Ã¡c chá»§ bÃ i, ngÃ´n ngá»¯ cá»§a tÆ°Æ¡ng lai, viáº¿t TypeScript thÃ¬ má»i thá»© sáº½ khÃ´ng thá»ƒ nÃ o cÃ²n lá»—i, nhá»¯ng lÃ½ do khiáº¿n báº¡n pháº£i suy nghÄ© láº¡i nhá»¯ng nháº­n Ä‘á»‹nh trÃªn"},{"id":"0f44ee174018384de200da37b4aac6d7","path":"/huong-dan-su-dung-cong-cu-de-check-contrast-trong-chrome/","title":"HÆ°á»›ng dáº«n sá»­ dá»¥ng cÃ´ng cá»¥ Ä‘á»ƒ check contrast trong Chrome","desc":"Tip siÃªu ngáº¯n Ä‘á»ƒ kiá»ƒm tra contrast cÃ³ há»£p nhÃ£n vá»›i Chrome khÃ´ng"},{"id":"cb3f4bb6b7e51df501700726716dff04","path":"/tai-sao-su-dung-flow-va-su-dung-flow-nhu-the-nao-trong-react/","title":"Táº¡i sao sá»­ dá»¥ng Flow, vÃ  sá»­ dá»¥ng Flow nhÆ° tháº¿ nÃ o trong React","desc":"Táº¡i sao chÃºng ta cáº§n type checking trong javascript, táº¡i sao Flow láº¡i lÃ  lá»±a chá»n cá»§a nhiá»u developer hiá»‡n nay"},{"id":"f90de95d29146b4eeebfade65137bde1","path":"/su-dung-local-storage-tren-website-nhu-the-nao/","title":"Sá»­ dá»¥ng localStorage trÃªn website nhÆ° tháº¿ nÃ o","desc":"Kiáº¿n thá»©c cÄƒn báº£n sá»­ dá»¥ng localStorage Ä‘á»ƒ lÆ°u thÃ´ng tin cáº§n thiáº¿t xuá»‘ng trÃ¬nh duyá»‡t"},{"id":"399b91323d4985064172d8d9c1bb57c4","path":"/functional-programing-nen-va-khong-nen/","title":"Functional programing nÃªn vÃ  khÃ´ng nÃªn","desc":""},{"id":"2789a28cea8d9db34303eb0ac813a357","path":"/huong-dan-su-dung-thuoc-tinh-counter-reset-va-counter-increment/","title":"HÆ°á»›ng dáº«n sá»­ dá»¥ng thuá»™c tÃ­nh counter-reset vÃ  counter-increment","desc":"Náº¿u muá»‘n Ä‘Ã¡nh sá»‘ tá»± Ä‘á»™ng trong css, ta thÆ°á»ng sá»­ dá»¥ng Ä‘áº¿n kiá»ƒu display list-style, bÃ i nÃ y giá»›i thiá»‡u má»™t thuá»™c tÃ­nh khÃ¡c Ã­t ai biáº¿t tá»›i"},{"id":"6dd172312a7c9858ab04392f1b780d3b","path":"/nen-dung-gi-thay-cho-input-number/","title":"NÃªn dÃ¹ng gÃ¬ thay cho input number","desc":"NgoÃ i input type number, cÃ²n nhá»¯ng giÃ¡ trá»‹ gÃ¬ báº¡n nÃªn cÃ¢n nháº¯c sá»­ dá»¥ng"},{"id":"f8528e820fefc73636e76fd4e555b660","path":"/su-dung-css-content-nhu-the-nao-cho-dung/","title":"Sá»­ dá»¥ng CSS content nhÆ° tháº¿ nÃ o cho Ä‘Ãºng","desc":"Thuá»™c tÃ­nh content trong CSS thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng cÃ¹ng vá»›i 2 ghost element lÃ  after vÃ  before, nhá»¯ng giÃ¡ trá»‹ nÃ o cÃ³ thá»ƒ Ä‘Æ°a vÃ o cho thuá»™c tÃ­nh content nÃ y"},{"id":"34e1a6e4e7dac657edca4c9832d737dc","path":"/su-dung-tabindex/","title":"Sá»­ dá»¥ng tabindex","desc":"Máº·c Ä‘á»‹nh thá»© tá»± tab theo vá»‹ trÃ­ cá»§a DOM ráº¥t há»¯u dá»¥ng, tuy nhiÃªn cÃ³ trÆ°á»ng há»£p chÃºng ta sáº½ muá»‘n thay Ä‘á»•i thá»© tá»± tab nÃ y. CÃ¹ng nghiÃªn cá»©u tabindex Ä‘á»ƒ set thá»© tá»± tab"},{"id":"e50caffffbea9c79e5698cd929baa00a","path":"/use-effect-tu-a-toi-z/","title":"useEffect tá»« a tá»›i z","desc":"ÄÃ¢y lÃ  má»™t bÃ i viáº¿t tÆ°Æ¡ng Ä‘á»‘i dÃ i dÃ²ng vá» useEffect, báº¡n cáº§n biáº¿t vÃ  Ä‘Ã£ Ä‘á»c qua tÃ i liá»‡u vá» useEffect trÃªn trang chÃ­nh thá»©c cá»§a React trÆ°á»›c, vÃ  náº¿u chá»‰ thá»±c sá»± cáº§n biáº¿t sá»­ dá»¥ng useEffect ra sao, báº¡n khÃ´ng cáº§n Ä‘á»c bÃ i viáº¿t phÃ¢n tÃ¡ch má»• xáº» sÃ¢u kiá»ƒu nÃ y."}]}},"context":{}}