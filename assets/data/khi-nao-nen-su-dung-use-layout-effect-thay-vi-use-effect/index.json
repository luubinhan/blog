{"hash":"de27e2fcb6fcecac29304aaf8a8d984a82eb101a","data":{"post":{"title":"Khi n√†o n√™n s·ª≠ d·ª•ng useLayoutEffect thay v√¨ useEffect","path":"/khi-nao-nen-su-dung-use-layout-effect-thay-vi-use-effect/","date":"2020-01-02","timeToRead":2,"tags":[{"id":"thu-thuat","title":"thu-thuat","path":"/tag/thu-thuat/"},{"id":"react","title":"react","path":"/tag/react/"}],"desc":"2 React Hook l√†m nhi·ªám v·ª• kh√° gi·ªëng nhau l√† useEffect v√† useLayoutEffect b·∫°n ƒë√£ bi·∫øt c√°ch s·ª≠ d·ª•ng th·∫ø n√†o cho ƒë√∫ng","content":"<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// th·ª±c hi·ªán side effect</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token comment\">/* d·ªçn r√°c */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>khai b√°o c√°c gi√° tr·ªã m√† n√≥ ph·ª• thu·ªôc<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">useLayoutEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// th·ª±c hi·ªán side effect</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token comment\">/* d·ªçn r√°c */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>th·ª±c hi·ªán side effect<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>N·∫øu ko c√≥ kh√°c nhau th√¨ React team s·∫Ω kh√¥ng t·∫°o ra 2 th·∫±ng, hi·ªÉn nhi√™n?. (H·∫ßu nh∆∞ c√≥ th·ªÉ d·ª•ng <code class=\"language-text\">useEffect</code> trong m·ªçi t√¨nh hu·ªëng)</p>\n<p>Kh√°c nhau l√† ·ªü <strong>TH·ªúI GIAN TH·ª∞C HI·ªÜN</strong></p>\n<p><code class=\"language-text\">useEffect</code> ch·∫°y <strong>b·∫•t tu·∫ßn t·ª±</strong> v√† ƒë·ª£i <strong>sau</strong> khi vi·ªác component ƒë√£ xu·∫•t hi·ªán tr√™n m√†n h√¨nh (sau khi tr√¨nh duy·ªát <em>paint</em>)</p>\n<p>Qu√° tr√¨nh c·ª• th·∫ø l√† th·∫ø n√†y</p>\n<ol>\n<li>Component g·ªçi ƒë·∫øn <code class=\"language-text\">render</code></li>\n<li>M√†n h√¨nh c·∫≠p nh·∫≠p l·∫°i UI m·ªõi</li>\n<li><strong>SAU ƒê√ì</strong> ch·∫°y <code class=\"language-text\">useEffect</code></li>\n</ol>\n<p><code class=\"language-text\">useLayoutEffect</code>, ng∆∞·ª£c l·∫°i, ch·∫°y <strong>tu·∫ßn t·ª±</strong> sau khi render nh∆∞ng l√† <strong>tr∆∞·ªõc</strong> khi UI c·∫≠p nh·∫≠p</p>\n<p>Qu√° tr√¨nh</p>\n<ol>\n<li>Component g·ªçi ƒë·∫øn <code class=\"language-text\">render</code></li>\n<li><code class=\"language-text\">useLayoutEffect</code> ƒë∆∞·ª£c g·ªçi, ƒë·ª£i ch·∫°y xong m·ªõi ƒëi ti·∫øp</li>\n<li>M√†n h√¨nh c·∫≠p nh·∫≠p l·∫°i UI m·ªõi</li>\n</ol>\n<p>Trong 99% c√°c tr∆∞·ªùng h·ª£p, s·ª≠ d·ª•ng <code class=\"language-text\">useEffect</code>  s·∫Ω l√† c√°ch t·ªët nh·∫•t, v√¨ nh·ªØng effect c·ªßa ch√∫ng ta s·∫Ω c·∫ßn ƒë·ªìng b·ªô v·ªõi prop, state, kh√¥ng c·∫ßn x·∫£y ra <strong>NGAY L·∫¨P T·ª®C</strong> v√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn k·∫øt qu·∫£ cu·ªëi c√πng c·ªßa UI.</p>\n<p>V√≠ d·ª• nh∆∞ fetch d·ªØ li·ªáu s·∫Ω kh√¥ng c·∫ßn c√≥ k·∫øt qu·∫£ ngay l·∫≠p t·ª©c, hay ƒë·∫∑t ƒë·ªÉ c√°c event handler</p>\n<p>N·∫øu th·∫•y UI b·ªã <code class=\"language-text\">flickering</code> (gi·ªëng nh∆∞ xu·∫•t hi·ªán s·ªçc s·ªçc tr√™n m√†n h√¨nh tivi) khi c·∫≠p nh·∫≠p, nguy√™n nh√¢n do n√≥ ƒë√£ render khi <em>v·ª´a cos</em> state, sau ƒë√≥ l·∫°i re-render l·∫°i v·ªõi state nh·∫≠n ƒë∆∞·ª£c sau c√πng. ƒê√≥ l√† l√∫c b·∫°n d√πng <code class=\"language-text\">useLayoutEffect</code></p>\n<p>V√≠ d·ª• nh√©, b·∫°n cho user click ƒë·ªÉ thay ƒë·ªïi state <code class=\"language-text\">value</code>, n√≥ s·∫Ω re-render component, sau ƒë√≥ effect ch·∫°y, n√≥ l·∫°i set gi√° tr·ªã <code class=\"language-text\">value</code> th√†nh m·ªôt con s·ªë ng·∫´u nhi√™n => l·∫°i re-render component.</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">React</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  useState<span class=\"token punctuation\">,</span>\n  useLayoutEffect\n<span class=\"token punctuation\">}</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">ReactDOM</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\"><span class=\"token maybe-class-name\">BlinkyRender</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useLayoutEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token operator\">+</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'render'</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      value: </span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span> <span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token maybe-class-name\">ReactDOM</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BlinkyRender</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>V·ªõi c√°ch d√πng <code class=\"language-text\">useLayoutEffect</code> ch√∫ng ta ch·ªâ c·∫≠p nh·∫≠p UI ƒë√∫ng <strong>1</strong> l·∫ßn, trong khi component g·ªçi render <strong>2</strong> l·∫ßn.</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://daveceddia.com/useeffect-vs-uselayouteffect/\">üìú When to useLayoutEffect Instead of useEffect</a></p>\n","cover_image":"","related":[{"id":"1ba061475abb23bc0355ce6df2e57b4c","path":"/7-ly-do-ban-khong-nen-su-dung-type-script/","title":"7 l√Ω do b·∫°n kh√¥ng n√™n s·ª≠ d·ª•ng TypeScript","desc":"TypeScript c√≥ ph·∫£i l√† con √°c ch·ªß b√†i, ng√¥n ng·ªØ c·ªßa t∆∞∆°ng lai, vi·∫øt TypeScript th√¨ m·ªçi th·ª© s·∫Ω kh√¥ng th·ªÉ n√†o c√≤n l·ªói, nh·ªØng l√Ω do khi·∫øn b·∫°n ph·∫£i suy nghƒ© l·∫°i nh·ªØng nh·∫≠n ƒë·ªãnh tr√™n"},{"id":"0f44ee174018384de200da37b4aac6d7","path":"/huong-dan-su-dung-cong-cu-de-check-contrast-trong-chrome/","title":"H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng c√¥ng c·ª• ƒë·ªÉ check contrast trong Chrome","desc":"Tip si√™u ng·∫Øn ƒë·ªÉ ki·ªÉm tra contrast c√≥ h·ª£p nh√£n v·ªõi Chrome kh√¥ng"},{"id":"cb3f4bb6b7e51df501700726716dff04","path":"/tai-sao-su-dung-flow-va-su-dung-flow-nhu-the-nao-trong-react/","title":"T·∫°i sao s·ª≠ d·ª•ng Flow, v√† s·ª≠ d·ª•ng Flow nh∆∞ th·∫ø n√†o trong React","desc":"T·∫°i sao ch√∫ng ta c·∫ßn type checking trong javascript, t·∫°i sao Flow l·∫°i l√† l·ª±a ch·ªçn c·ªßa nhi·ªÅu developer hi·ªán nay"},{"id":"f90de95d29146b4eeebfade65137bde1","path":"/su-dung-local-storage-tren-website-nhu-the-nao/","title":"S·ª≠ d·ª•ng localStorage tr√™n website nh∆∞ th·∫ø n√†o","desc":"Ki·∫øn th·ª©c cƒÉn b·∫£n s·ª≠ d·ª•ng localStorage ƒë·ªÉ l∆∞u th√¥ng tin c·∫ßn thi·∫øt xu·ªëng tr√¨nh duy·ªát"}]}},"context":{}}