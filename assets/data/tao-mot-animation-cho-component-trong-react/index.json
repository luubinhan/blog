{"hash":"039ed75c2c8087ca7192f8a19b292859b6e783d9","data":{"post":{"title":"Tạo một animation cho component trong React","path":"/tao-mot-animation-cho-component-trong-react/","date":"2018-07-20","timeToRead":4,"tags":[{"id":"react","title":"react","path":"/tag/react/"},{"id":"javascript","title":"javascript","path":"/tag/javascript/"},{"id":"css","title":"css","path":"/tag/css/"}],"desc":"Sử dụng React, styled-components, react-flip-toolkit để tạo animation giống như mên trên trang chủ của Stripe","content":"<!-- TOC -->\n<ul>\n<li><a href=\"#ph%C3%A2n-t%C3%ADch\">Phân tích</a></li>\n<li><a href=\"#d%E1%BB%B1ng-component-th%C3%B4-ch%C6%B0a-c%C3%B3-animate\">Dựng component thô chưa có animate</a></li>\n<li><a href=\"#animate-v%E1%BB%9Bi-flip-technique\">Animate với Flip technique</a></li>\n<li><a href=\"#ch%C4%83m-ch%C3%BAc\">Chăm chúc</a></li>\n<li><a href=\"#background-animation\">Background animation</a></li>\n</ul>\n<!-- /TOC -->\n<h1 id=\"phân-tích\"><a href=\"#ph%C3%A2n-t%C3%ADch\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Phân tích</h1>\n<p data-height=\"265\" data-theme-id=\"0\" data-slug-hash=\"PaYXEZ\" data-default-tab=\"js,result\" data-user=\"aholachek\" data-embed-version=\"2\" data-pen-title=\"React Stripe Menu\" class=\"codepen\">See the Pen <a href=\"https://codepen.io/aholachek/pen/PaYXEZ/\">React Stripe Menu</a> by Alex (<a href=\"https://codepen.io/aholachek\">@aholachek</a>) on <a href=\"https://codepen.io\">CodePen</a>.</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<p>Trước tiên phân tích cái animation này ra thành nhiều phần để dể hình dung. Có thể xem dạng slow motion trên Codepen để xem nhé.</p>\n<ul>\n<li>container dropdown màu trắng sẽ thay đổi kích thước và vị trí</li>\n<li>background màu xám ở phía dưới của dropdown transition độ cao</li>\n<li>Khi di chuyển chuột khỏi dropdown, fade out nội dung trước đó đi và chuyển vị trí nó sang element mới, sau đó đưa nội dung mới lên.</li>\n</ul>\n<p>Một vài lưu ý khi làm animation với React, cứ để browser quản lý layout. Thay vì sử dụng các dropdown khác nhau, chúng ta dùng 1 dropdown và thay đổi vị trí của nó, dùng <a href=\"https://css-tricks.com/animating-layouts-with-the-flip-technique/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Flip technique</a> để giả lập như có 3 dropdown khác nhau.</p>\n<h1 id=\"dựng-component-thô-chưa-có-animate\"><a href=\"#d%E1%BB%B1ng-component-th%C3%B4-ch%C6%B0a-c%C3%B3-animate\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Dựng component thô chưa có animate</h1>\n<p data-height=\"265\" data-theme-id=\"0\" data-slug-hash=\"OELrzN\" data-default-tab=\"js,result\" data-user=\"aholachek\" data-embed-version=\"2\" data-pen-title=\"React Stripe Menu Before Animation\" class=\"codepen\">See the Pen <a href=\"https://codepen.io/aholachek/pen/OELrzN/\">React Stripe Menu Before Animation</a> by Alex (<a href=\"https://codepen.io/aholachek\">@aholachek</a>) on <a href=\"https://codepen.io\">CodePen</a>.</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<p>Để bắt đầu ta dựng một component <code class=\"language-text\">navbar</code> sử dụng <code class=\"language-text\">styled-component</code></p>\n<p>Ở đây thì chưa thêm phần gray background ở dưới dropdown, cái này nó sẽ nằm <code class=\"language-text\">absolute</code></p>\n<h1 id=\"animate-với-flip-technique\"><a href=\"#animate-v%E1%BB%9Bi-flip-technique\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Animate với Flip technique</h1>\n<p>Chúng ta sẽ sử dụng <a href=\"https://github.com/aholachek/react-flip-toolkit\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">react-flip-toolkit</a> để thay đổi kích thước và vị trí dropdown.</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Flipper</span></span> <span class=\"token attr-name\">flipKey</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>currentIndex<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Navbar</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token punctuation\">{</span>navbar<span class=\"token punctuation\">.</span><span class=\"token property-access\"><span class=\"token maybe-class-name\">Config</span></span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// render navbar items</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Navbar</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Flipper</span></span><span class=\"token punctuation\">></span></span></code></pre>\n<p>Ở <code class=\"language-text\">DropdownContainer</code> component, đưa các element sẽ animate vào bên trong <code class=\"language-text\">Flipped</code> component, nhớ giá trị <code class=\"language-text\">flipId</code> phải khác nhau</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DropdownRoot</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Flipped</span></span> <span class=\"token attr-name\">flipId</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>dropdown-caret<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Caret</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Flipped</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Flipped</span></span> <span class=\"token attr-name\">flipId</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>dropdown<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DropdownBackground</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">DropdownBackground</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Flipped</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">DropdownRoot</span></span><span class=\"token punctuation\">></span></span></code></pre>\n<p>Làm 2 cái animate trên <code class=\"language-text\">&lt;Caret/&gt;</code> và <code class=\"language-text\">&lt;DropdownBackground/&gt;</code> riêng biệt, để thuộc tính <code class=\"language-text\">overflow: hidden</code> set trên <code class=\"language-text\">&lt;DropdownBackground /&gt;</code> không ảnh hưởng tới <code class=\"language-text\">&lt;Caret/&gt;</code></p>\n<p>Giờ có 1 vấn đề nhỏ là nội dung bên trong dropdown lúc xuất hiện bị stretch một cách kỳ cục, lý do là thuộc tính <code class=\"language-text\">transforms: scale</code> nó áp luôn trên children. Xử lý cái này bằng cách đưa nội dung này vào trong <code class=\"language-text\">&lt;Flipped/&gt;</code> kèm giá trị cho props <code class=\"language-text\">inverseFlipId</code>, lúc này children sẽ không bị effect từ thằng cha nữa, đồng thời xác định luôn là ko muốn áp thằng <code class=\"language-text\">scale</code></p>\n<p data-height=\"265\" data-theme-id=\"0\" data-slug-hash=\"MXgZxG\" data-default-tab=\"js,result\" data-user=\"aholachek\" data-embed-version=\"2\" data-pen-title=\"React Stripe Menu -- Error #1: no scale adjustment\" class=\"codepen\">See the Pen <a href=\"https://codepen.io/aholachek/pen/MXgZxG/\">React Stripe Menu -- Error #1: no scale adjustment</a> by Alex (<a href=\"https://codepen.io/aholachek\">@aholachek</a>) on <a href=\"https://codepen.io\">CodePen</a>.</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DropdownRoot</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Flipped</span></span> <span class=\"token attr-name\">flipId</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dropdown-caret<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Caret</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Flipped</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Flipped</span></span> <span class=\"token attr-name\">flipId</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dropdown<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">DropdownBackground</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Flipped</span></span> <span class=\"token attr-name\">inverseFlipId</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>dropdown<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">scale</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Flipped</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">DropdownBackground</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Flipped</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">DropdownRoot</span></span><span class=\"token punctuation\">></span></span></code></pre>\n<h1 id=\"chăm-chúc\"><a href=\"#ch%C4%83m-ch%C3%BAc\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Chăm chúc</h1>\n<p>Cũng gần được rồi, chúng ta cần để ý thêm vào những chi tiết nhỏ nhất để animate nhìn cool hơn</p>\n<p>Styled-components hỗ trợ rất tốt việc <a href=\"https://www.styled-components.com/docs/basics#animations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">thay đổi keyframe animation</a>. Chúng ta sẽ sử dụng tính năng này để làm animation lúc enter và cross-fade nội dung dropdown khi thay đổi ví trí chuột.</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getFadeContainerKeyFrame</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> animatingOut<span class=\"token punctuation\">,</span> direction <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>direction<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> keyframes<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token css language-css\">\n    <span class=\"token selector\">from</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translateX</span><span class=\"token punctuation\">(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n        animatingOut <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> direction <span class=\"token operator\">===</span> <span class=\"token string\">'left'</span> <span class=\"token operator\">?</span> <span class=\"token number\">20</span> <span class=\"token operator\">:</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span>\n      <span class=\"token interpolation-punctuation punctuation\">}</span></span>px<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token selector\">to</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">transform</span><span class=\"token punctuation\">:</span> <span class=\"token function\">translateX</span><span class=\"token punctuation\">(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n        <span class=\"token operator\">!</span>animatingOut <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> direction <span class=\"token operator\">===</span> <span class=\"token string\">'left'</span> <span class=\"token operator\">?</span> <span class=\"token operator\">-</span><span class=\"token number\">20</span> <span class=\"token operator\">:</span> <span class=\"token number\">20</span>\n      <span class=\"token interpolation-punctuation punctuation\">}</span></span>px<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> <span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>animatingOut <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token maybe-class-name\">FadeContainer</span> <span class=\"token operator\">=</span> styled<span class=\"token punctuation\">.</span><span class=\"token property-access\">div</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token css language-css\">\n  <span class=\"token property\">animation-name</span><span class=\"token punctuation\">:</span> <span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>getFadeContainerKeyFrame<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">animation-duration</span><span class=\"token punctuation\">:</span> <span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token parameter\">props</span> <span class=\"token arrow operator\">=></span> props<span class=\"token punctuation\">.</span><span class=\"token property-access\">duration</span> <span class=\"token operator\">*</span> <span class=\"token number\">0.5</span><span class=\"token interpolation-punctuation punctuation\">}</span></span>ms<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">animation-fill-mode</span><span class=\"token punctuation\">:</span> forwards<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">position</span><span class=\"token punctuation\">:</span> <span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token parameter\">props</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span><span class=\"token property-access\">animatingOut</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"absolute\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"relative\"</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">opacity</span><span class=\"token punctuation\">:</span> <span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token parameter\">props</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">.</span><span class=\"token property-access\">direction</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>props<span class=\"token punctuation\">.</span><span class=\"token property-access\">animatingOut</span> <span class=\"token operator\">?</span> <span class=\"token number\">0</span> <span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">animation-timing-function</span><span class=\"token punctuation\">:</span> linear<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">top</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token property\">left</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre>\n<p data-height=\"265\" data-theme-id=\"0\" data-slug-hash=\"NzPpwG\" data-default-tab=\"js,result\" data-user=\"aholachek\" data-embed-version=\"2\" data-pen-title=\"React Stripe Menu -- Simple FLIP\" class=\"codepen\">See the Pen <a href=\"https://codepen.io/aholachek/pen/NzPpwG/\">React Stripe Menu -- Simple FLIP</a> by Alex (<a href=\"https://codepen.io/aholachek\">@aholachek</a>) on <a href=\"https://codepen.io\">CodePen</a>.</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<p>Khi user đưa chuột lên menu mới, chúng ta ko chỉ đưa vào dropdown hiện tại mà con dropdown trước đó như children cho <code class=\"language-text\">DropdownContainer</code>, cùng với những thông tin về hướng di chuột của user. Sau đó <code class=\"language-text\">DropdonwContainer</code> sẽ wrap hết tất cả children của nó trong một component mới, <code class=\"language-text\">FadeContents</code>, thằng này sẽ sử dụng keyframe animation code ở trên để thêm animation tương ứng</p>\n<h1 id=\"background-animation\"><a href=\"#background-animation\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Background animation</h1>\n<p>Cuối cùng chúng ta thêm gray background</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">updateAltBackground</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n  altBackground<span class=\"token punctuation\">,</span>\n  prevDropdown<span class=\"token punctuation\">,</span>\n  currentDropdown\n<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> prevHeight <span class=\"token operator\">=</span> <span class=\"token function\">getFirstDropdownSectionHeight</span><span class=\"token punctuation\">(</span>prevDropdown<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> currentHeight <span class=\"token operator\">=</span> <span class=\"token function\">getFirstDropdownSectionHeight</span><span class=\"token punctuation\">(</span>currentDropdown<span class=\"token punctuation\">)</span>\n  \n  <span class=\"token comment\">// we'll use this function when we want a change </span>\n  <span class=\"token comment\">// to happen immediately, without CSS transitions</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">immediateSetTranslateY</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">el<span class=\"token punctuation\">,</span> translateY</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    el<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">transform</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translateY(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>translateY<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px)</span><span class=\"token template-punctuation string\">`</span></span>\n    el<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">transition</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"transform 0s\"</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">(</span>el<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">transitionDuration</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevHeight<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// transition the grey (\"alt\") background from its previous height</span>\n    <span class=\"token comment\">// to its current height</span>\n    <span class=\"token function\">immediateSetTranslateY</span><span class=\"token punctuation\">(</span>altBackground<span class=\"token punctuation\">,</span> prevHeight<span class=\"token punctuation\">)</span>\n    <span class=\"token function\">requestAnimationFrame</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n      altBackground<span class=\"token punctuation\">.</span><span class=\"token property-access\">style</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">transform</span> <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">translateY(</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>currentHeight<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">px)</span><span class=\"token template-punctuation string\">`</span></span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// immediately set the background to the appropriate height</span>\n    <span class=\"token comment\">// since we don't have a stored value</span>\n    <span class=\"token function\">immediateSetTranslateY</span><span class=\"token punctuation\">(</span>altBackground<span class=\"token punctuation\">,</span> currentHeight<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p data-height=\"265\" data-theme-id=\"0\" data-slug-hash=\"qKRWBe\" data-default-tab=\"js,result\" data-user=\"aholachek\" data-embed-version=\"2\" data-pen-title=\"React Stripe Menu -- Animated Background\" class=\"codepen\">See the Pen <a href=\"https://codepen.io/aholachek/pen/qKRWBe/\">React Stripe Menu -- Animated Background</a> by Alex (<a href=\"https://codepen.io/aholachek\">@aholachek</a>) on <a href=\"https://codepen.io\">CodePen</a>.</p>\n<script async src=\"https://static.codepen.io/assets/embed/ei.js\"></script>\n<p>Source: <a href=\"https://github.com/aholachek/react-stripe-menu\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/aholachek/react-stripe-menu</a></p>\n<p><a href=\"https://css-tricks.com/building-a-complex-ui-animation-in-react-simply/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Link bài gốc của tác giả</a></p>\n","cover_image":"","related":[{"id":"6314a0ae5c8d97df66e38b0f4d856d99","path":"/viet-animation-cho-vue-component/","title":"Viết animation cho Vue Component","desc":"Làm một số animation đơn giản bằng công cụ có sẵn của Vue"},{"id":"82094eb3a75f8e7cc086b97fe788ec2e","path":"/huong-dan-tao-mot-package-publish-no-len-npm/","title":"Hướng dẫn tạo một package, publish nó lên npm","desc":"Nếu bạn có một package nào đó muốn chia sẽ cùng mọi người trên npm, thì đây là cách bạn publish package make-by-me như vậy lên npm"},{"id":"083e430e680dbd971e00fd9a00b5b00e","path":"/tao-slider-component-trong-react-native-bang-pan-responder/","title":"Tạo slider component trong React Native bằng PanResponder","desc":"Tuts này sẽ hướng dẫn các bạn tạo một slider component đơn giản trong React Native bằng PanResponder"},{"id":"4f5128f52679191e40ab274c3db1314d","path":"/bao-mat-web-mot-so-kieu-tan-cong/","title":"Bảo mật web - Một số kiểu tấn công","desc":"Tổng quát các vấn đề bạn cần quan tâm để bảo mật ứng dụng web"}]}},"context":{}}