{"hash":"9aeee0a3b55006b00a80cc09aa73da4e17f71410","data":{"post":{"title":"Ràng buộc dữ liệu input với HTML5","path":"/2019-03-25-rang-buoc-du-lieu-voi-html5/","slug":"/2019-03-25-rang-buoc-du-lieu-voi-html5","date":"2019-03-25","timeToRead":4,"tags":[{"id":"mobile-web-specialist","title":"mobile-web-specialist","path":"/tag/mobile-web-specialist/"}],"desc":"Vì form quá phức tạp, chúng ta cần thêm một bài viết nữa về validation với html","content":"<p>Với HTML5 chúng ta có một số kiểu input để validate những giá trị mà user đưa vào, ko cần tự viết javascript để check, chỉ đơn giản là khai báo mấy cái attribute, trường hợp phức tạp hơn, chúng ta có thể can thiệp trong cái <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Constraint_validation\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Validation API</a> để có kết quả mong muốn</p>\n<blockquote>\n<p>Luôn nhớ validate ở phía client không có nghĩa là ko cần đến validate ở server.</p>\n</blockquote>\n<h2 id=\"một-vài-ràng-buộc-phổ-biến\"><a href=\"#m%E1%BB%99t-v%C3%A0i-r%C3%A0ng-bu%E1%BB%99c-ph%E1%BB%95-bi%E1%BA%BFn\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Một vài ràng buộc phổ biến</h2>\n<p>Dùng kiểu input\n<code class=\"language-inline-text\">&lt;input type=”email” /></code>: bắt buộc là giá trị email\n<code class=\"language-inline-text\">&lt;input type=\"url\" /></code>: bắt buộc là giá trị url</p>\n<p>Dùng attribute khác</p>\n<table>\n<thead>\n<tr>\n<th>Attribute</th>\n<th align=\"center\">Kiểu input hỗ trợ</th>\n<th align=\"right\">Giải thích</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-inline-text\">pattern</code></td>\n<td align=\"center\">text, search, url, tel, email, password</td>\n<td align=\"right\">phải khớp với giá trị regular expression</td>\n</tr>\n<tr>\n<td><code class=\"language-inline-text\">min</code></td>\n<td align=\"center\">range, number, date, month, week, datetime, datetime-local, time</td>\n<td align=\"right\">giá trị phải lớn hơn hoặc bằng giá trị <code class=\"language-inline-text\">min</code></td>\n</tr>\n<tr>\n<td><code class=\"language-inline-text\">max</code></td>\n<td align=\"center\">range, number, date, month, week, datetime, datetime-local, time</td>\n<td align=\"right\">giá trị phải nhỏ hơn hoặc bằng giá trị <code class=\"language-inline-text\">max</code></td>\n</tr>\n<tr>\n<td><code class=\"language-inline-text\">required</code></td>\n<td align=\"center\">text, search, url, tel, email, password, date, datetime, datetime-local, month, week, time, number, checkbox, radio, file, select, textarea</td>\n<td align=\"right\">bắt buộc phải có giá trị</td>\n</tr>\n<tr>\n<td><code class=\"language-inline-text\">minlength</code></td>\n<td align=\"center\">text, search, url, tel, email, password, textarea</td>\n<td align=\"right\">số ký tự nhập vào phải thỏa lớn hơn hoặc bằng <code class=\"language-inline-text\">minlength</code></td>\n</tr>\n<tr>\n<td><code class=\"language-inline-text\">maxlength</code></td>\n<td align=\"center\">text, search, url, tel, email, password, textarea</td>\n<td align=\"right\">số ký tự nhập vào phải thỏa nhỏ hơn hoặc bằng <code class=\"language-inline-text\">maxlength</code></td>\n</tr>\n</tbody>\n</table>\n<p>Ví dụ</p>\n<div class=\"gridsome-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Enter username (upper and lowercase letters): <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>name<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">required</span> <span class=\"token attr-name\">pattern</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>[A-Za-z]+<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span>Submit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2 id=\"quá-trình-validate-dữ-liệu\"><a href=\"#qu%C3%A1-tr%C3%ACnh-validate-d%E1%BB%AF-li%E1%BB%87u\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Quá trình validate dữ liệu</h2>\n<p>Quá trình này sẽ thông qua bộ Validation API, nó có thể là trên cả form hoặc trên từng element trong form. Được thực hiện bằng một trong các cách sau\nbằng cách gọi <code class=\"language-inline-text\">checkValidity()</code> của các element input, select, button, textarea. Nó sẽ chỉ validate dữ liệu trên element đó thôi. Nó thường được thực hiện bởi trình duyệt, sau đó chúng ta dùng selector của CSS là <code class=\"language-inline-text\">:valid</code> và <code class=\"language-inline-text\">:invalid</code> để format\ngọi <code class=\"language-inline-text\">checkValidity()</code> hoặc <code class=\"language-inline-text\">reportValidity()</code> trên thằng form\nKhi form được submit bằng click ‘<input type=’submit’ /><code class=\"language-inline-text\">hoặc ‘&lt;button type=’submit’ /></code> hoặc ấn enter</p>\n<p>Lưu ý</p>\n<ul>\n<li>Nếu set novalidate trên thẻ <code class=\"language-inline-text\">&lt;form novalidate /></code>, là chúng ta bỏ qua hết việc validate</li>\n<li>Khi gọi <code class=\"language-inline-text\">submit()</code> trên form, không trigger validation, phương thức này sẽ gửi hết dữ liệu của form lên server dù nó có hay không thỏa điều kiện. Nên gọi sự kiện <code class=\"language-inline-text\">click()</code> của nút submit</li>\n</ul>\n<h2 id=\"can-thiệp-vào-quá-trình-validate-bằng-bộ-validation-api\"><a href=\"#can-thi%E1%BB%87p-v%C3%A0o-qu%C3%A1-tr%C3%ACnh-validate-b%E1%BA%B1ng-b%E1%BB%99-validation-api\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Can thiệp vào quá trình validate bằng bộ Validation API</h2>\n<p>Ý tưởng chính là bắt một sự kiện nào đó trên element như <code class=\"language-inline-text\">onchange</code>, rồi trigger một đoạn javascript để validate, sau đó dùng phương thức <code class=\"language-inline-text\">field.setCustomValidity()</code> để set kết quả validate: nếu là String rỗng nghĩa là ok, còn ngược lại là error, đoạn string này sẽ đem đi hiển thị như thông báo error cho user</p>\n<h3 id=\"giới-hạn-file-size-khi-upload\"><a href=\"#gi%E1%BB%9Bi-h%E1%BA%A1n-file-size-khi-upload\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Giới hạn file size khi upload</h3>\n<div class=\"gridsome-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>label</span> <span class=\"token attr-name\">for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>FS<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Select a file smaller than 75 kB : <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>label</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>file<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>FS<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Dùng javascript để đọc file được chọn, <code class=\"language-inline-text\">FIle.size()</code>, so sánh kích thước này rồi trả về kết quả cho trình duyệt</p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">checkFileSize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> <span class=\"token constant\">FS</span> <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FS\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> files <span class=\"token operator\">=</span> <span class=\"token constant\">FS</span><span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Nếu có ít nhất 1 file được chọn</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>files<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n     <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>size <span class=\"token operator\">></span> <span class=\"token number\">75</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// kiểm tra size</span>\n       <span class=\"token constant\">FS</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCustomValidity</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"The selected file must not be larger than 75 kB\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n       <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// Không có file, ko check.</span>\n  <span class=\"token constant\">FS</span><span class=\"token punctuation\">.</span><span class=\"token function\">setCustomValidity</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Hook cái phương thức này vào trong sự kiện mong muốn</p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">window<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"FS\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>onchange <span class=\"token operator\">=</span> checkFileSize<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"hiển-thị-validation\"><a href=\"#hi%E1%BB%83n-th%E1%BB%8B-validation\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Hiển thị validation</h2>\n<p>Dùng <code class=\"language-inline-text\">:required</code> và <code class=\"language-inline-text\">:optional</code> để trỏ đến các element nào có thuộc tính <code class=\"language-inline-text\">required</code> hoặc không</p>\n<div class=\"gridsome-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">input:required</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">input:optional</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-inline-text\">:valid</code> và <code class=\"language-inline-text\">:invalid</code> trên các element bị/không bị lỗi</p>\n<div class=\"gridsome-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">input:valid</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> black<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token selector\">input:invalid</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> red<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Để thay đổi nội dung câu thông báo, sử dụng <code class=\"language-inline-text\">element.setCustomValidity('thông báo')</code> trên các element: <code class=\"language-inline-text\">&lt;fieldset></code>, <code class=\"language-inline-text\">&lt;input></code>, <code class=\"language-inline-text\">&lt;output></code>, <code class=\"language-inline-text\">&lt;select></code>, <code class=\"language-inline-text\">&lt;button></code>, <code class=\"language-inline-text\">&lt;textarea></code></p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> nameInput <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> form <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'form'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nnameInput<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  nameInput<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomValidity</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  nameInput<span class=\"token punctuation\">.</span><span class=\"token function\">checkValidity</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nnameInput<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'invalid'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>nameInput<span class=\"token punctuation\">.</span>value <span class=\"token operator\">===</span> <span class=\"token string\">''</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    nameInput<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomValidity</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Enter your username!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    nameInput<span class=\"token punctuation\">.</span><span class=\"token function\">setCustomValidity</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Usernames can only contain upper and lowercase letters. Try again!'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/HTML5/Constraint_validation\">Constraint validation\n</a></p>\n","cover_image":"","related":[{"id":"77a81e0c87ac4c028e3855b09ed9acca","path":"/2019-11-18-huong-dan-goi-fetch-api-bang-react-hook/","title":"Làm sao để fetch dữ liệu bằng React Hook","desc":"Trong bài này chúng ta sẽ sử dụng React.useState, React.useEffect, React.useReducer để fetch dữ liệu từ API, đồng thời cũng viết một custom hook để có thể sử dụng ở bất kỳ đâu"},{"id":"c96e777ca9db4c279c1d03ebd80ea3f8","path":"/2018-10-03-huong-dan-reactjs-table-du-lieu-lon/","title":"Xử lý tập dữ liệu lớn trong React","desc":"Tình huống: bạn có một table với rất nhiều dữ liệu đổ vào, nếu bạn thấy component đó render chậm trên màn hình, đó là lúc cần tái cấu trúc"},{"id":"5550e857a813d3da05f329dcad94b730","path":"/2018-03-14-huong-dan-sync-addin-vscode/","title":"Sync extensions của VSCode","desc":"Khi sử dụng VSCode chắc ai cũng cài thêm một mớ extensions, lỡ ngày nào cài lại máy, hay sử dụng máy công ty, máy tính ở nhà muốn VSCode sync mấy cái extention hay sử dụng"}]}},"context":{}}