{"hash":"bd8bcf9d282230d74addc27b33bcc5555a134956","data":{"post":{"title":"7 thủ thuật trong gatsby","path":"/7-thu-thuat-trong-gatsby/","date":"2019-03-31","timeToRead":4,"tags":[{"id":"gatsby","title":"gatsby","path":"/tag/gatsby/"}],"desc":"Tập hợp những thủ thuật khi làm việc với gatsby","content":"<!-- TOC -->\n<ul>\n<li><a href=\"#l%E1%BA%A5y-ng%C3%A0y-build-g%E1%BA%A7n-nh%E1%BA%A5t\">Lấy Ngày build gần nhất</a></li>\n<li><a href=\"#ng%C3%A0y-ch%E1%BB%89nh-s%E1%BB%ADa-g%E1%BA%A7n-nh%E1%BA%A5t\">Ngày chỉnh sửa gần nhất</a></li>\n<li><a href=\"#c%C3%B9ng-source-kh%C3%A1c-queries\">Cùng source, khác Queries</a></li>\n<li><a href=\"#previousnext\">Previous/Next</a></li>\n<li><a href=\"#b%C3%A0i-vi%E1%BA%BFt-ng%E1%BA%ABu-nhi%C3%AAn\">Bài viết ngẫu nhiên</a></li>\n<li><a href=\"#m%E1%BA%B7c-%C4%91%E1%BB%8Bnh-m%E1%BB%9F-tr%C3%ACnh-duy%E1%BB%87t\">Mặc định mở trình duyệt</a></li>\n<li><a href=\"#s%E1%BB%AD-d%E1%BB%A5ng-dotenv\">Sử dụng dotenv</a></li>\n</ul>\n<!-- /TOC -->\n<h2 id=\"lấy-ngày-build-gần-nhất\"><a href=\"#l%E1%BA%A5y-ng%C3%A0y-build-g%E1%BA%A7n-nh%E1%BA%A5t\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Lấy Ngày build gần nhất</h2>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">React</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword module\">import</span> <span class=\"token punctuation\">{</span> useStaticQuery<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'gatsby'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\"><span class=\"token maybe-class-name\">IndexPage</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token function\">useStaticQuery</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token maybe-class-name\">This</span> site was last built on<span class=\"token operator\">:</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span><span class=\"token property-access\">site</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">buildTime</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token maybe-class-name\">IndexPage</span>\n\n<span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token graphql language-graphql\">\n  <span class=\"token keyword\">query</span> Info <span class=\"token punctuation\">{</span>\n    site <span class=\"token punctuation\">{</span>\n      buildTime<span class=\"token punctuation\">(</span><span class=\"token attr-name\">formatString</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"DD/MM/YYYY\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre>\n<h2 id=\"ngày-chỉnh-sửa-gần-nhất\"><a href=\"#ng%C3%A0y-ch%E1%BB%89nh-s%E1%BB%ADa-g%E1%BA%A7n-nh%E1%BA%A5t\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Ngày chỉnh sửa gần nhất</h2>\n<pre class=\"language-js\"><code class=\"language-js\">query <span class=\"token maybe-class-name\">YourQuery</span> <span class=\"token punctuation\">{</span>\n  allMdx <span class=\"token punctuation\">{</span>\n    edges <span class=\"token punctuation\">{</span>\n      node <span class=\"token punctuation\">{</span>\n        parent <span class=\"token punctuation\">{</span>\n          <span class=\"token spread operator\">...</span> on <span class=\"token maybe-class-name\">File</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">modifiedTime</span><span class=\"token punctuation\">(</span>formatString<span class=\"token operator\">:</span> <span class=\"token string\">\"MM/DD/YYYY\"</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h2 id=\"cùng-source-khác-queries\"><a href=\"#c%C3%B9ng-source-kh%C3%A1c-queries\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Cùng source, khác Queries</h2>\n<p>Khi chúng ta định nghĩa 2 ( hoặc nhiều hơn) giá trị trong <code class=\"language-text\">gatsby-source-filesystem</code></p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// file gatsby-config.js</span>\nmodule<span class=\"token punctuation\">.</span><span class=\"token property-access\">exports</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  plugins<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/src/assets</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      resolve<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      options<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">logos</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>__dirname<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/src/logos</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-transformer-sharp</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-plugin-sharp</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Chúng ta có thể filter trong câu GraphQL chỉ lấy 1 trong 2 source đó</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// file src/pages/index.js</span>\n<span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">React</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword module\">import</span> <span class=\"token punctuation\">{</span> useStaticQuery<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'gatsby'</span>\n<span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">Img</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'gatsby-image'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\"><span class=\"token maybe-class-name\">IndexPage</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token function\">useStaticQuery</span><span class=\"token punctuation\">(</span>query<span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token maybe-class-name\">First</span> <span class=\"token function\">image</span> <span class=\"token punctuation\">(</span>logo<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token maybe-class-name\">Img</span>\n        style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> width<span class=\"token operator\">:</span> <span class=\"token string\">'200px'</span><span class=\"token punctuation\">,</span> marginBottom<span class=\"token operator\">:</span> <span class=\"token string\">'2rem'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        fluid<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span><span class=\"token property-access\">logo</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">childImageSharp</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">fluid</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span><span class=\"token maybe-class-name\">Assets</span> <span class=\"token function\">images</span> <span class=\"token punctuation\">(</span>two<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> display<span class=\"token operator\">:</span> <span class=\"token string\">'flex'</span><span class=\"token punctuation\">,</span> flexWrap<span class=\"token operator\">:</span> <span class=\"token string\">'wrap'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">.</span><span class=\"token property-access\">assets</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">edges</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">img</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">(</span>\n          <span class=\"token operator\">&lt;</span><span class=\"token maybe-class-name\">Img</span>\n            style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> width<span class=\"token operator\">:</span> <span class=\"token string\">'200px'</span><span class=\"token punctuation\">,</span> marginBottom<span class=\"token operator\">:</span> <span class=\"token string\">'2rem'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n            fluid<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>img<span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">childImageSharp</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">fluid</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token maybe-class-name\">IndexPage</span>\n\n<span class=\"token keyword\">const</span> query <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token graphql language-graphql\">\n  <span class=\"token keyword\">query</span> Images <span class=\"token punctuation\">{</span>\n    <span class=\"token attr-name\">logo</span><span class=\"token punctuation\">:</span> file<span class=\"token punctuation\">(</span><span class=\"token attr-name\">sourceInstanceName</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"logos\"</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      childImageSharp <span class=\"token punctuation\">{</span>\n        fluid<span class=\"token punctuation\">(</span><span class=\"token attr-name\">maxWidth</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">quality</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token operator\">...</span><span class=\"token fragment function\">GatsbyImageSharpFluid</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token attr-name\">assets</span><span class=\"token punctuation\">:</span> allFile<span class=\"token punctuation\">(</span><span class=\"token attr-name\">filter</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">sourceInstanceName</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"assets\"</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      edges <span class=\"token punctuation\">{</span>\n        node <span class=\"token punctuation\">{</span>\n          childImageSharp <span class=\"token punctuation\">{</span>\n            fluid<span class=\"token punctuation\">(</span><span class=\"token attr-name\">maxWidth</span><span class=\"token punctuation\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token attr-name\">quality</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token operator\">...</span><span class=\"token fragment function\">GatsbyImageSharpFluid</span>\n            <span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre>\n<h2 id=\"previousnext\"><a href=\"#previousnext\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Previous/Next</h2>\n<p>Để show bài viết trước và sau bài viết hiện tại</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// file gatsby-node.js</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">wrapper</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">promise</span> <span class=\"token arrow operator\">=></span>\n  promise<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span><span class=\"token property-access\">errors</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> result<span class=\"token punctuation\">.</span><span class=\"token property-access\">errors</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> result\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nexports<span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> actions <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createPage <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n  <span class=\"token keyword\">const</span> bookTemplate <span class=\"token operator\">=</span> require<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./src/templates/book.js'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">wrapper</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n      {\n        allBooksYaml(sort: { fields: [title], order: ASC }) {\n          edges {\n            node {\n              slug\n              title\n            }\n          }\n        }\n      }\n    </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> books <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">allBooksYaml</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">edges</span>\n\n  books<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">edge<span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// đặt biến prev/next cho tất cả node</span>\n    <span class=\"token comment\">// để có truy cập slug &amp; title ở bất kỳ đâu</span>\n\n    <span class=\"token keyword\">const</span> prev <span class=\"token operator\">=</span> index <span class=\"token operator\">===</span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token keyword null nil\">null</span> <span class=\"token operator\">:</span> books<span class=\"token punctuation\">[</span>index <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span>\n    <span class=\"token keyword\">const</span> next <span class=\"token operator\">=</span> index <span class=\"token operator\">===</span> books<span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token keyword null nil\">null</span> <span class=\"token operator\">:</span> books<span class=\"token punctuation\">[</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span>\n\n    <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      path<span class=\"token operator\">:</span> edge<span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">slug</span><span class=\"token punctuation\">,</span>\n      component<span class=\"token operator\">:</span> bookTemplate<span class=\"token punctuation\">,</span>\n      context<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        slug<span class=\"token operator\">:</span> edge<span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">slug</span><span class=\"token punctuation\">,</span>\n        prev<span class=\"token punctuation\">,</span>\n        next<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// file src/templates/books</span>\n<span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">React</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword module\">import</span> <span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> <span class=\"token maybe-class-name\">Link</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'gatsby'</span>\n\n<span class=\"token keyword module\">import</span> <span class=\"token maybe-class-name\">Layout</span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'../components/layout'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">BookTemplate</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> booksYaml <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">props</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span>\n    <span class=\"token comment\">// prev &amp; next được truyền từ gatsby-node.js</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> prev<span class=\"token punctuation\">,</span> next <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">props</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">pageContext</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token maybe-class-name\">Layout</span> <span class=\"token dom variable\">location</span><span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">props</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">location</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>booksYaml<span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span>prev <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">></span><span class=\"token maybe-class-name\">Previous</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span><span class=\"token maybe-class-name\">Link</span> to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>prev<span class=\"token punctuation\">.</span><span class=\"token property-access\">slug</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>prev<span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token maybe-class-name\">Link</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n          <span class=\"token punctuation\">{</span>next <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>\n            <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">></span><span class=\"token maybe-class-name\">Next</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n              <span class=\"token operator\">&lt;</span><span class=\"token maybe-class-name\">Link</span> to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>next<span class=\"token punctuation\">.</span><span class=\"token property-access\">slug</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>next<span class=\"token punctuation\">.</span><span class=\"token property-access\">title</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token maybe-class-name\">Link</span><span class=\"token operator\">></span>\n            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n          <span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token maybe-class-name\">Layout</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token maybe-class-name\">BookTemplate</span>\n\n<span class=\"token keyword module\">export</span> <span class=\"token keyword\">const</span> pageQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token graphql language-graphql\">\n  <span class=\"token keyword\">query</span> BookBySlug<span class=\"token punctuation\">(</span><span class=\"token variable\">$slug</span><span class=\"token punctuation\">:</span> String<span class=\"token operator\">!</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    booksYaml<span class=\"token punctuation\">(</span><span class=\"token attr-name\">slug</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token attr-name\">eq</span><span class=\"token punctuation\">:</span> <span class=\"token variable\">$slug</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      title\n      content\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre>\n<h2 id=\"bài-viết-ngẫu-nhiên\"><a href=\"#b%C3%A0i-vi%E1%BA%BFt-ng%E1%BA%ABu-nhi%C3%AAn\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Bài viết ngẫu nhiên</h2>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// gatsby-node.js</span>\n\n<span class=\"token keyword\">const</span> _ <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lodash'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">prevNext</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">list<span class=\"token punctuation\">,</span> item</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// lấy danh sách bài post (không bao gồm bài post hiện tại)</span>\n  <span class=\"token keyword\">const</span> filterUnique <span class=\"token operator\">=</span> _<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">filter</span><span class=\"token punctuation\">(</span>\n    list<span class=\"token punctuation\">,</span>\n    <span class=\"token parameter\">input</span> <span class=\"token arrow operator\">=></span> input<span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">slug</span> <span class=\"token operator\">!==</span> item<span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">slug</span>\n  <span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> sample <span class=\"token operator\">=</span> _<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">sampleSize</span><span class=\"token punctuation\">(</span>filterUnique<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    left<span class=\"token operator\">:</span> sample<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">,</span>\n    right<span class=\"token operator\">:</span> sample<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">wrapper</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">promise</span> <span class=\"token arrow operator\">=></span>\n  promise<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span><span class=\"token property-access\">errors</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> result<span class=\"token punctuation\">.</span><span class=\"token property-access\">errors</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> result\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nexports<span class=\"token punctuation\">.</span><span class=\"token method-variable function-variable method function property-access\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> actions <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createPage <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n  <span class=\"token keyword\">const</span> bookTemplate <span class=\"token operator\">=</span> require<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./src/templates/book.js'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">wrapper</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n      {\n        allBooksYaml {\n          edges {\n            node {\n              slug\n              title\n            }\n          }\n        }\n      }\n    </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> books <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span><span class=\"token property-access\">data</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">allBooksYaml</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">edges</span>\n\n  books<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">edge</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> left<span class=\"token punctuation\">,</span> right <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">prevNext</span><span class=\"token punctuation\">(</span>books<span class=\"token punctuation\">,</span> edge<span class=\"token punctuation\">)</span>\n\n    <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      path<span class=\"token operator\">:</span> edge<span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">slug</span><span class=\"token punctuation\">,</span>\n      component<span class=\"token operator\">:</span> bookTemplate<span class=\"token punctuation\">,</span>\n      context<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        slug<span class=\"token operator\">:</span> edge<span class=\"token punctuation\">.</span><span class=\"token property-access\">node</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">slug</span><span class=\"token punctuation\">,</span>\n        left<span class=\"token punctuation\">,</span>\n        right<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h2 id=\"mặc-định-mở-trình-duyệt\"><a href=\"#m%E1%BA%B7c-%C4%91%E1%BB%8Bnh-m%E1%BB%9F-tr%C3%ACnh-duy%E1%BB%87t\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Mặc định mở trình duyệt</h2>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gatsby develop -o\"</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h2 id=\"sử-dụng-dotenv\"><a href=\"#s%E1%BB%AD-d%E1%BB%A5ng-dotenv\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Sử dụng dotenv</h2>\n<p>Mặc định thì chúng ta có thể sử dụng biến môi trường khi cài Gatsby, do đó chỉ việc import <code class=\"language-text\">dotenv</code> trong file <code class=\"language-text\">gatsby-config.js</code> là có thể sử dụng.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// gatsby-config.js</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dotenv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">.env.</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span><span class=\"token property-access\">env</span><span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://www.lekoarts.de/en/blog/tips-and-tricks-for-gatsby\">Tips &#x26; Tricks for Gatsby\n</a></p>\n","cover_image":"","related":[{"id":"b4daa487e028c8d0bac138d052dc785a","path":"/7-thu-thuat-trong-javascript/","title":"7 thủ thuật trong javascript","desc":"7 thủ thuật hữu ích trong javascript"},{"id":"6c9e83d801157396289a748804460b25","path":"/thuat-toan-quick-sort/","title":"Thuật toán QuickSort","desc":"Một thuật toán rất phổ biến mà chúng ta phải nắm thật chắc và hình dung được cách hiện thực nó ngay khi được nhắc tới."},{"id":"c764b91e3b81ee538e35cfc01d180b37","path":"/thu-thuat-su-dung-don-vi-viewport-tren-mobile/","title":"Thủ thuật sử dụng đơn vị viewport trên mobile","desc":"Để có thể quản lý được state của ứng dụng một cách tốt nhất, chúng ta cần sự phân chia phù hợp giữa local state (internal state của component) và state cửa ứng dụng đặt trong React Context. Một vài điều muốn chia sẽ để nâng cao khả năng bảo trì và trải nghiệm nếu sử dụng đến context trong React."},{"id":"8a96e1bde836a981c3694b7c5bb64b27","path":"/8-thu-thuat-khi-lam-viec-voi-object-su-dung-resting-va-spreading/","title":"8 thủ thuật khi làm việc với Object sử dụng resting và spreading","desc":"Những đoạn code bỏ túi hay xài nhất khi đụng tới object"}]}},"context":{}}