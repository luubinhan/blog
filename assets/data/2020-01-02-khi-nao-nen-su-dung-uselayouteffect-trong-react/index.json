{"hash":"742daa8ab2f1a95986978ecdcd9d0a2d9a3b753f","data":{"post":{"title":"Khi nÃ o nÃªn sá»­ dá»¥ng useLayoutEffect thay vÃ¬ useEffect","path":"/2020-01-02-khi-nao-nen-su-dung-uselayouteffect-trong-react/","date":"2020-01-02","timeToRead":2,"tags":[{"id":"thu-thuat","title":"thu-thuat","path":"/tag/thu-thuat/"},{"id":"react","title":"react","path":"/tag/react/"}],"desc":"2 React Hook lÃ m nhiá»‡m vá»¥ khÃ¡ giá»‘ng nhau lÃ  useEffect vÃ  useLayoutEffect báº¡n Ä‘Ã£ biáº¿t cÃ¡ch sá»­ dá»¥ng tháº¿ nÃ o cho Ä‘Ãºng","content":"<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// thá»±c hiá»‡n side effect</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token comment\">/* dá»n rÃ¡c */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>khai bÃ¡o cÃ¡c giÃ¡ trá»‹ mÃ  nÃ³ phá»¥ thuá»™c<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">useLayoutEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// thá»±c hiá»‡n side effect</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token comment\">/* dá»n rÃ¡c */</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>thá»±c hiá»‡n side effect<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Náº¿u ko cÃ³ khÃ¡c nhau thÃ¬ React team sáº½ khÃ´ng táº¡o ra 2 tháº±ng, hiá»ƒn nhiÃªn?. (Háº§u nhÆ° cÃ³ thá»ƒ dá»¥ng <code class=\"language-text\">useEffect</code> trong má»i tÃ¬nh huá»‘ng)</p>\n<p>KhÃ¡c nhau lÃ  á»Ÿ <strong>THá»œI GIAN THá»°C HIá»†N</strong></p>\n<p><code class=\"language-text\">useEffect</code> cháº¡y <strong>báº¥t tuáº§n tá»±</strong> vÃ  Ä‘á»£i <strong>sau</strong> khi viá»‡c component Ä‘Ã£ xuáº¥t hiá»‡n trÃªn mÃ n hÃ¬nh (sau khi trÃ¬nh duyá»‡t <em>paint</em>)</p>\n<p>QuÃ¡ trÃ¬nh cá»¥ tháº¿ lÃ  tháº¿ nÃ y</p>\n<ol>\n<li>Component gá»i Ä‘áº¿n <code class=\"language-text\">render</code></li>\n<li>MÃ n hÃ¬nh cáº­p nháº­p láº¡i UI má»›i</li>\n<li><strong>SAU ÄÃ“</strong> cháº¡y <code class=\"language-text\">useEffect</code></li>\n</ol>\n<p><code class=\"language-text\">useLayoutEffect</code>, ngÆ°á»£c láº¡i, cháº¡y <strong>tuáº§n tá»±</strong> sau khi render nhÆ°ng lÃ  <strong>trÆ°á»›c</strong> khi UI cáº­p nháº­p</p>\n<p>QuÃ¡ trÃ¬nh</p>\n<ol>\n<li>Component gá»i Ä‘áº¿n <code class=\"language-text\">render</code></li>\n<li><code class=\"language-text\">useLayoutEffect</code> Ä‘Æ°á»£c gá»i, Ä‘á»£i cháº¡y xong má»›i Ä‘i tiáº¿p</li>\n<li>MÃ n hÃ¬nh cáº­p nháº­p láº¡i UI má»›i</li>\n</ol>\n<p>Trong 99% cÃ¡c trÆ°á»ng há»£p, sá»­ dá»¥ng <code class=\"language-text\">useEffect</code>  sáº½ lÃ  cÃ¡ch tá»‘t nháº¥t, vÃ¬ nhá»¯ng effect cá»§a chÃºng ta sáº½ cáº§n Ä‘á»“ng bá»™ vá»›i prop, state, khÃ´ng cáº§n xáº£y ra <strong>NGAY Láº¬P Tá»¨C</strong> vÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n káº¿t quáº£ cuá»‘i cÃ¹ng cá»§a UI.</p>\n<p>VÃ­ dá»¥ nhÆ° fetch dá»¯ liá»‡u sáº½ khÃ´ng cáº§n cÃ³ káº¿t quáº£ ngay láº­p tá»©c, hay Ä‘áº·t Ä‘á»ƒ cÃ¡c event handler</p>\n<p>Náº¿u tháº¥y UI bá»‹ <code class=\"language-text\">flickering</code> (giá»‘ng nhÆ° xuáº¥t hiá»‡n sá»c sá»c trÃªn mÃ n hÃ¬nh tivi) khi cáº­p nháº­p, nguyÃªn nhÃ¢n do nÃ³ Ä‘Ã£ render khi <em>vá»«a cÃ³</em> state, sau Ä‘Ã³ láº¡i re-render láº¡i vá»›i state nháº­n Ä‘Æ°á»£c sau cÃ¹ng. ÄÃ³ lÃ  lÃºc báº¡n dÃ¹ng <code class=\"language-text\">useLayoutEffect</code></p>\n<p>VÃ­ dá»¥ nhÃ©, báº¡n cho user click Ä‘á»ƒ thay Ä‘á»•i state <code class=\"language-text\">value</code>, nÃ³ sáº½ re-render component, sau Ä‘Ã³ effect cháº¡y, nÃ³ láº¡i set giÃ¡ trá»‹ <code class=\"language-text\">value</code> thÃ nh má»™t con sá»‘ ngáº«u nhiÃªn => láº¡i re-render component.</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword module\">import</span> <span class=\"token imports\"><span class=\"token maybe-class-name\">React</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  useState<span class=\"token punctuation\">,</span>\n  useLayoutEffect\n<span class=\"token punctuation\">}</span></span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword module\">import</span> <span class=\"token imports\"><span class=\"token maybe-class-name\">ReactDOM</span></span> <span class=\"token keyword module\">from</span> <span class=\"token string\">'react-dom'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\"><span class=\"token maybe-class-name\">BlinkyRender</span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">,</span> setValue<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">useLayoutEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>value <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span> <span class=\"token operator\">+</span> <span class=\"token known-class-name class-name\">Math</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">200</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>value<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'render'</span><span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token function\">setValue</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      value: </span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span> <span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token maybe-class-name\">ReactDOM</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">render</span><span class=\"token punctuation\">(</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">BlinkyRender</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token dom variable\">document</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#root'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Vá»›i cÃ¡ch dÃ¹ng <code class=\"language-text\">useLayoutEffect</code> chÃºng ta chá»‰ cáº­p nháº­p UI Ä‘Ãºng <strong>1</strong> láº§n, trong khi component gá»i render <strong>2</strong> láº§n.</p>\n<p><a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://daveceddia.com/useeffect-vs-uselayouteffect/\">ğŸ“œ When to useLayoutEffect Instead of useEffect</a></p>\n","cover_image":"","related":[{"id":"1ba061475abb23bc0355ce6df2e57b4c","path":"/2020-02-15-7-ly-do-chinh-dang-khuyen-ban-khong-nen-dung-typescript/","title":"7 lÃ½ do báº¡n khÃ´ng nÃªn sá»­ dá»¥ng TypeScript","desc":"TypeScript cÃ³ pháº£i lÃ  con Ã¡c chá»§ bÃ i, ngÃ´n ngá»¯ cá»§a tÆ°Æ¡ng lai, viáº¿t TypeScript thÃ¬ má»i thá»© sáº½ khÃ´ng thá»ƒ nÃ o cÃ²n lá»—i, nhá»¯ng lÃ½ do khiáº¿n báº¡n pháº£i suy nghÄ© láº¡i nhá»¯ng nháº­n Ä‘á»‹nh trÃªn"},{"id":"d2e65b2b5b2523d59011e21cbc5ecf7f","path":"/2020-10-31-the-nao-duoc-goi-la-senior-developer/","title":"Khi nÃ o báº¡n Ä‘Ã£ lÃ  Senior dev","desc":"Chia sáº» cá»§a má»™t láº­p trÃ¬nh viÃªn Ä‘Ã£ á»©ng tuyá»ƒn vÃ o vá»‹ trÃ­ Senior dev vÃ  toÃ n tháº¥t báº¡i"},{"id":"2bda1aea7bf5ac181ed1d3a656b277f5","path":"/2020-10-26-huong-dan-su-dung-usememo-react/","title":"HÆ°á»›ng dáº«n sá»­ dá»¥ng useMemo trong React","desc":"Náº¿u báº¡n tháº¥y app cá»§a mÃ¬nh báº¯t Ä‘áº§u cháº­m, Ä‘Ã³ lÃ  lÃºc báº¡n nÃªn báº¯t Ä‘áº§u cÃ¢n nháº¯c cÃ¡c phÆ°Æ¡ng phÃ¡p Ä‘á»ƒ tá»‘i Æ°u tá»‘c Ä‘á»™ vÃ  Ä‘á»c bÃ i viáº¿t nÃ y."},{"id":"0f44ee174018384de200da37b4aac6d7","path":"/2018-10-18-huong-dan-dung-chrome-dev-tool-de-kiem-tra-contrast/","title":"HÆ°á»›ng dáº«n sá»­ dá»¥ng cÃ´ng cá»¥ Ä‘á»ƒ check contrast trong Chrome","desc":"Tip siÃªu ngáº¯n Ä‘á»ƒ kiá»ƒm tra contrast cÃ³ há»£p nhÃ£n vá»›i Chrome khÃ´ng"}]}},"context":{}}