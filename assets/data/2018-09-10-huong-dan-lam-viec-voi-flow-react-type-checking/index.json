{"hash":"e9b68f06fb111aac58002f267ca77e83dd3d3eb3","data":{"post":{"title":"Tại sao sử dụng Flow, và sử dụng Flow như thế nào trong React","path":"/2018-09-10-huong-dan-lam-viec-voi-flow-react-type-checking/","slug":"/2018-09-10-huong-dan-lam-viec-voi-flow-react-type-checking","date":"2018-09-10","timeToRead":4,"tags":[{"id":"react","title":"react","path":"/tag/react/"}],"desc":"Tại sao chúng ta cần type checking trong javascript, tại sao Flow lại là lựa chọn của nhiều developer hiện nay","content":"<p><em>Bài viết mang tính chất tham khảo, hiện tại đội ngũ Facebook đã bỏ rơi Flow để theo TypeScript <a href=\"https://github.com/facebook/jest/pull/7554\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/facebook/jest/pull/7554</a></em></p>\n<!-- TOC -->\n<ul>\n<li><a href=\"#static-vs-dynamic-typing\">Static vs Dynamic Typing</a></li>\n<li><a href=\"#t%E1%BA%A1i-sao-ch%E1%BB%8Dn-flow\">Tại sao chọn Flow</a></li>\n<li><a href=\"#setup-flow-v%E1%BB%9Bi-react\">Setup Flow với React</a></li>\n<li><a href=\"#define-type-check-cho-prop-v%C3%A0-state-c%E1%BB%A7a-cho-react-component\">Define type check cho Prop và State của cho React Component</a></li>\n</ul>\n<!-- /TOC -->\n<h1 id=\"static-vs-dynamic-typing\"><a href=\"#static-vs-dynamic-typing\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Static vs Dynamic Typing</h1>\n<p>Để bắt đầu chúng ta phải hiểu cách javascript làm việc với <code class=\"language-inline-text\">type</code></p>\n<p>Một cách ngắn gọn nhất, ngôn ngữ <strong>statically-typed</strong> thì <code class=\"language-inline-text\">type</code> của biến có thể xác định lúc <strong>compile</strong> (trước khi chạy), ngôn ngữ <strong>dynamically-typed</strong> thì chỉ biết được type của biến lúc <strong>run time</strong></p>\n<p>Như vậy với ngôn ngữ dạng <em>statically-typed</em>, lỗi sẽ được báo ngay khi build hoặc trên editor khi chúng ta sử dụng type không đúng. Nhưng với những ngôn ngữ kiểu dynamically-typed như Javascript nó sẽ khác chút. Xem xét đoạn code sau</p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> myObject <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">prop1</span><span class=\"token operator\">:</span> <span class=\"token string\">'Some text here'</span>\n<span class=\"token punctuation\">}</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>myObject<span class=\"token punctuation\">.</span><span class=\"token function\">prop1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-inline-text\">prop1</code> được định nghĩ là một <strong>string</strong> nhưng chúng ta lại gọi <code class=\"language-inline-text\">myObject.prop1()</code> như một <strong>function</strong>. Nếu chúng ta chạy đoạn code này chúng ta sẽ nhận được lỗi trên trình duyệt</p>\n<div class=\"gridsome-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">TypeError: myObject.prop1 is not a <span class=\"token keyword\">function</span></code></pre></div>\n<p>Những trường hợp <strong>quên mất</strong> kiểu của biến như vậy rất dễ gặp trong lúc code. Việc sử dụng static type check sẽ giúp phát hiện lỗi sớm hơn, mà phát hiện lỗi sớm hơn thì sẽ tốt hơn, right?</p>\n<p>Trong javascript chúng ta cũng có thể thay đổi type của biến như vầy</p>\n<div class=\"gridsome-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> myNumber <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> myNumber<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// number</span>\nmyNumber <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> myNumber<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// boolean</span></code></pre></div>\n<p>Để ngăn chặn những người khác hoặc chỉnh bản thân làm những chuyện sằn bậy như vậy, chúng ta phải đặt ràng buộc về type cho những biến này</p>\n<h1 id=\"tại-sao-chọn-flow\"><a href=\"#t%E1%BA%A1i-sao-ch%E1%BB%8Dn-flow\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Tại sao chọn Flow</h1>\n<p>Để đặt ràng buộc type trong Javascript hay React chúng có những 3 tên tuổi nổi bật Typescript, PropTypes, Flow.</p>\n<p>Flow là thư viện của Facebook, hỗ trợ tốt nhất cho React, đứng trên góc độ của người làm sell, nếu nói chúng ta sử dụng Flow từ Facebook sẽ ngon hơn, Typescript là superset của javascript, việc dùng Typescript cũng thay đổi khá nhiều thứ khác trong project, mình cảm thấy nó tiêu tốn khá nhiều thời gian hơn trong lúc dev, <code class=\"language-inline-text\">PropTypes</code> đã ko còn được quan tâm nhiều như trước nữa từ sau khi có Flow</p>\n<p>Còn theo như phát biểu từ những người tạo ra Flow (những developer trong Facebook)</p>\n<p>\"Chúng tôi built Flow vì thấy TypeScript đang đi theo hướng mà công đồng không mong đợi. Ví dụ, TypeScript cố tình không muốn đi theo hướng tập trung vào vấn đề type checking như một type system, không cung cấp việc generate ra document cho API với type đã định nghĩa. Nếu bạn muốn TypeScript làm cái gì, bạn cũng phải bảo nó hết, ko hoàn toàn tự động. Mặc dù từ TypeScript 2.0 họ bắt đầu để ý chuyện này, tuy nhiên còn phải rất lâu mới bắt kịp Flow nhé\"</p>\n<h1 id=\"setup-flow-với-react\"><a href=\"#setup-flow-v%E1%BB%9Bi-react\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Setup Flow với React</h1>\n<p>Theo hướng dẫn trên tài liệu chính thức <a href=\"https://flow.org/en/docs/react/\" target=\"_blank\" rel=\"noopener noreferrer\">https://flow.org/en/docs/react/</a></p>\n<p>Nếu khởi tạo project bằng create-react-App thì chỉ việc install Flow và tạo file <code class=\"language-inline-text\">.flowconfig</code></p>\n<div class=\"gridsome-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">npm i flow-bin <span class=\"token operator\">--</span><span class=\"token function\">save-dev</span></code></pre></div>\n<p>Bên trong file <code class=\"language-inline-text\">package.json</code>, add thêm đoạn script để chạy flow</p>\n<div class=\"gridsome-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"flow\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"flow\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Để init file <code class=\"language-inline-text\">.flowconfig</code></p>\n<div class=\"gridsome-highlight\" data-language=\"powershell\"><pre class=\"language-powershell\"><code class=\"language-powershell\">npm run flow init</code></pre></div>\n<p>Sau khi chạy lệnh này xong chúng ta sẽ có file <code class=\"language-inline-text\">.flowconfig</code> với nội dung sau</p>\n<div class=\"gridsome-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[ignore]\n[include]\n[libs]\n[lints]\n[options]\n[strict]</code></pre></div>\n<p>Để thêm type check của từng component</p>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//@flow</span>\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>Component<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Props</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>app<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Nếu dùng cách viết thêm <code class=\"language-inline-text\">//@flow</code> vào mỗi file như vậy hơi chuối, chúng ta thay đổi config một chút trong file <code class=\"language-inline-text\">.flowconfig</code></p>\n<div class=\"gridsome-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[ignore] // file nào ko check bỏ vào đây\n.*/node_modules/.* // bỏ qua file trong thư mục node_modules\n.*/src/registerServiceWWorker\\.js\n.*/src/index\\.js\n.*\\.test\\.js\n\n[options]\nall=true // check tất cả file, gồm cả node_modules</code></pre></div>\n<h1 id=\"define-type-check-cho-prop-và-state-của-cho-react-component\"><a href=\"#define-type-check-cho-prop-v%C3%A0-state-c%E1%BB%A7a-cho-react-component\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Define type check cho Prop và State của cho React Component</h1>\n<div class=\"gridsome-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\ntype Props <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">strType</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span>\n  numberType<span class=\"token operator\">?</span><span class=\"token operator\">:</span> number\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Props</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\"> </span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>strType<span class=\"token punctuation\">,</span> numberType<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">'</span>app<span class=\"token punctuation\">'</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">String </span><span class=\"token punctuation\">{</span>strType<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Number </span><span class=\"token punctuation\">{</span>numberType<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"/2018-09-13-huong-dan-su-dung-flow-voi-react-redux\">Đọc thêm: Sử dụng Flow để check type trong React Redux</a></p>\n<p><a href=\"https://www.lullabot.com/articles/flow-for-static-type-checking-javascript\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Nguồn tham khảo: Why I Chose to Use Flow for Static Type Checking My JavaScript</a></p>\n","cover_image":"","related":[{"id":"788d202fd25a809668b62e0786539170","path":"/2018-09-13-huong-dan-su-dung-flow-voi-react-redux/","title":"Sử dụng Flow để check type trong React Redux","desc":"Chúng ta sẽ không nói nhiều cách sử dụng Redux trong bài này, các bạn có thể xem các bài trước, ở đây mình chỉ đi đến vấn đề đưa Flow vào để check type trong Redux"},{"id":"f8528e820fefc73636e76fd4e555b660","path":"/2018-10-13-css-content-hop-le/","title":"Sử dụng CSS content như thế nào cho đúng","desc":"Thuộc tính content trong CSS thường được sử dụng cùng với 2 ghost element là after và before, những giá trị nào có thể đưa vào cho thuộc tính content này"},{"id":"5eadb4fb31a8a53f91d7af473359e9f1","path":"/2019-03-12-su-khac-nhau-giua-function-component-va-class-component-trong-react/","title":"Function Component khác Class component như thế nào trong React","desc":"Ngày xưa khi chưa có hook, thì rất dễ để trả lời câu này, nhưng từ ngày hook được sử dụng, câu hỏi lại này lại được đặt ra, ủa vậy 2 thằng nó khác nhau ở điểm nào."},{"id":"f90de95d29146b4eeebfade65137bde1","path":"/2018-10-21-huong-dan-su-dung-local-storage/","title":"Sử dụng localStorage trên website như thế nào","desc":"Kiến thức căn bản sử dụng localStorage để lưu thông tin cần thiết xuống trình duyệt"}]}},"context":{}}