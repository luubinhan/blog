{"hash":"80b05d4cf7c7757ed6d67805cf5444ee65da77d8","data":{"post":{"title":"Tìm hiểu Currying function trong Javascript","path":"/tim-hieu-currying-function-trong-javascript/","slug":"/2018-12-19-tim-hieu-curring-function-trong-javascript","date":"2018-12-19","timeToRead":3,"tags":[{"id":"javascript","title":"javascript","path":"/tag/javascript/"},{"id":"senior","title":"senior","path":"/tag/senior/"}],"desc":"Bài viết này chúng ta sẽ tìm hiểu về cái cà-ri này, nó chạy ra sao, hữu dụng thế nào.","content":"<blockquote>\n<p><strong>Currying function</strong> là một function có thể xử lý việc chúng ta truyền <em>lắc nhắc</em> từng tham số, thay vì truyền tất cả tham số cùng một lúc. Mỗi lần gọi function chúng ta lại truyền tiếp một tham số</p>\n</blockquote>\n<p>Truyền cùng lúc</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">normal</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c<span class=\"token punctuation\">)</span></code></pre>\n<p>Truyền <em>lắc nhắc</em></p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">carrying</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span></code></pre>\n<p>Một function <strong>thông thường</strong></p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">multiply</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> a <span class=\"token operator\">*</span> b <span class=\"token operator\">*</span> c<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token function\">multiply</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 6</span></code></pre>\n<p>Đây là phiên bản <em>cà-ry</em> của function <code>multiply</code> ở trên</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">multiply</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">b</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">c</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword control-flow\">return</span> a <span class=\"token operator\">*</span> b <span class=\"token operator\">*</span> c\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">multiply</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 6</span></code></pre>\n<p>Bạn có thể chửi viết chi mà phức con mẹ nó tạp vậy, callback hell. Nhưng lợi ích của nó là giúp chúng ta gọi được hàm <code>multiply</code> theo kiểu <code>multiply(1)(2)(3)</code> thay vì <code>multiply(1,2,3)</code>. <em>Vẫn chưa thấy lợi ích?</em> Viết tách ra cho dễ nhìn nè</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> mul1 <span class=\"token operator\">=</span> <span class=\"token function\">multiply</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> mul2 <span class=\"token operator\">=</span> <span class=\"token function\">mul1</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token function\">mul2</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// result : 6</span></code></pre>\n<p>Vẫn chưa thấy lợi ích luôn? Xem tiếp ví dụ để tính giảm giá theo hóa đơn</p>\n<h2 id=\"currying-function-để-làm-gì\"><a href=\"#currying-function-%C4%91%E1%BB%83-l%C3%A0m-g%C3%AC\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Currying function để làm gì?</h2>\n<p>Thí dụ bạn có một hàm để tính giá trị <em>discount</em>, giảm ngay 10% cho khách hàng thân thiết.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">price<span class=\"token punctuation\">,</span> discount</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> price <span class=\"token operator\">*</span> discount\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// Giảm ngay giảm 10% trên hóa đơn</span>\n<span class=\"token keyword\">const</span> price <span class=\"token operator\">=</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// $50 </span>\n<span class=\"token comment\">// $500  - $50 = $450</span></code></pre>\n<p>Khách hàng tiêu tiền điên cuồng, chúng ta gọi hàm này say mê</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> price <span class=\"token operator\">=</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token number\">1500</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// $150</span>\n<span class=\"token comment\">// $1,500 - $150 = $1,350</span>\n<span class=\"token keyword\">const</span> price <span class=\"token operator\">=</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token number\">2000</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// $200</span>\n<span class=\"token comment\">// $2,000 - $200 = $1,800</span>\n<span class=\"token keyword\">const</span> price <span class=\"token operator\">=</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// $5</span>\n<span class=\"token comment\">// $50 - $5 = $45</span>\n<span class=\"token keyword\">const</span> price <span class=\"token operator\">=</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// $500</span>\n<span class=\"token comment\">// $5,000 - $500 = $4,500</span>\n<span class=\"token keyword\">const</span> price <span class=\"token operator\">=</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// $30</span>\n<span class=\"token comment\">// $300 - $30 = $270</span></code></pre>\n<p>Curry function sẽ giúp được gì trong tình huống này đây? Chúng ta vẫn cho phép truyền % <code>discount</code> và cho phép việc giá trị truyền này một lần thôi</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">discount</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">price</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword control-flow\">return</span> price <span class=\"token operator\">*</span> discount<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> tenPercentDiscount <span class=\"token operator\">=</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">tenPercentDiscount</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// $50</span>\n<span class=\"token keyword\">const</span> twentyPercentDiscount <span class=\"token operator\">=</span> <span class=\"token function\">discount</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">twentyPercentDiscount</span><span class=\"token punctuation\">(</span><span class=\"token number\">500</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 100</span>\n<span class=\"token comment\">// $500 - $100 = $400</span>\n<span class=\"token function\">twentyPercentDiscount</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1000</span>\n<span class=\"token comment\">// $5,000 - $1,000 = $4,000</span>\n<span class=\"token function\">twentyPercentDiscount</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 200000</span>\n<span class=\"token comment\">// $1,000,000 - $200,000 = $600,000</span></code></pre>\n<blockquote>\n<p>Khi cần truyền vào 1 argument ít thay đổi, cố định trong đa số các trường hợp, nghĩ đến carrying.</p>\n</blockquote>\n<h2 id=\"chuyển-bất-cứ-hàm-nào-thành-hàm-currying\"><a href=\"#chuy%E1%BB%83n-b%E1%BA%A5t-c%E1%BB%A9-h%C3%A0m-n%C3%A0o-th%C3%A0nh-h%C3%A0m-currying\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Chuyển bất cứ hàm nào thành hàm Currying</h2>\n<p>Chúng ta sẽ viết một cái hàm, nhiệm vụ của nó là biến một hàm bất kỳ và trả về một phiên bản currying  của function đó.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">curry</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fn<span class=\"token punctuation\">,</span> <span class=\"token spread operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token spread operator\">...</span>_arg</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword control-flow\">return</span> <span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token spread operator\">...</span>args<span class=\"token punctuation\">,</span> <span class=\"token spread operator\">...</span>_arg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Giải thích hàm này nha, hàm <code>curry</code> này nhận vào argument đầu tiên là một function, các argument tiếp theo sẽ là giá trị số. Sử dụng với hàm <code>multiply</code> ban đầu</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">multiply</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">,</span> c</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword control-flow\">return</span> a <span class=\"token operator\">*</span> b <span class=\"token operator\">*</span> c<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// phiên bản currying</span>\n<span class=\"token keyword\">const</span> multiplyCurrying <span class=\"token operator\">=</span> <span class=\"token function\">curry</span><span class=\"token punctuation\">(</span>multiply<span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">multiplyCurrying</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">multiplyCurrying</span><span class=\"token punctuation\">(</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Hoặc dùng <code>lodash.curry</code>, <code>lodash.curryRight</code> nếu bàn thích sự hoàn hảo :D</p>\n","cover_image":"","related":[{"id":"2cf605d9c4b14a739c24f879844a55f9","path":"/tim-hieu-execution-context-trong-javascript/","title":"Tìm hiểu Execution context trong Javascript","desc":"Theo quan điểm của mình, khái niệm căn bản và quan trọng bật nhất của javascript là hiểu được Execution Context,"},{"id":"65395bae8cda365addbb20f99ba00455","path":"/tim-hieu-ve-time-zone/","title":"Tìm hiểu về Time Zone","desc":"Cùng luận bàn những vấn đề liên quan đến time zone"},{"id":"1ae2a37d4f8455d37c67ec40ca86232b","path":"/tim-hieu-phuong-thuc-slice-cua-mang-trong-javascript/","title":"Tìm hiểu phương thức slice của mảng trong javascript","desc":"Bài viết phù họp cho các bạn mới biết javascript, không phù hợp cho bạn nào đã quá rành"},{"id":"ce342e02627f4d7a07148ba5a1d1fa85","path":"/higher-order-function-trong-javascript/","title":"Higher-Order function trong javascript","desc":"Một trong những đặc thù của Javascript khiến nó rất phù hợp với function programming là cho phép viết function higher-order, kiểu function cho phép nhận một function khác như một argument hoặc trả về một function"}]}},"context":{}}