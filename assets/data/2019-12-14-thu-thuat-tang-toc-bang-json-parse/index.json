{"hash":"3274fa32f48b39b818211d541fbcf5a00b3e3bc4","data":{"post":{"title":"á»¨ng dá»¥ng JSON.parse Ä‘á»ƒ cáº£i thiá»‡n tá»‘c Ä‘á»™?","path":"/2019-12-14-thu-thuat-tang-toc-bang-json-parse/","date":"2019-12-14","timeToRead":3,"tags":[{"id":"javascript","title":"javascript","path":"/tag/javascript/"},{"id":"thu-thuat","title":"thu-thuat","path":"/tag/thu-thuat/"}],"desc":"Thá»§ thuáº­t Ä‘á»ƒ cáº£i thiá»‡n tá»‘c Ä‘á»™ báº±ng JSON.parse","content":"<p>Vá»›i cÃ¡c á»©ng dá»¥ng web ngÃ y nay, khÃ´ng khÃ³ báº¯t gáº·p viá»‡c sá»­ dá»¥ng object nhÆ° má»™t nÆ¡i lÆ°u trá»¯ state vÃ  cÃ¡c dáº¡ng dá»¯ liá»‡u cáº§n thiáº¿t khÃ¡c cho á»©ng dá»¥ng. Cá»¥ thá»ƒ nháº¥t chÃºng ta thÆ°á»ng tháº¥y trong store cá»§a Redux.</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> foo<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> bar<span class=\"token operator\">:</span> <span class=\"token number\">1337</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ğŸŒ</span></code></pre>\n<p>Trong thá»±c táº¿ nÃ³ sáº½ khÃ´ng Ä‘Æ¡n giáº£n nhÆ° vÃ­ dá»¥ á»Ÿ trÃªn, mÃ  cáº¥u trÃºc náº¿u khÃ´ng chá»“ng chÃ©o thÃ¬ cÅ©ng ráº¥t lá»›n vÃ¬ pháº£i gÃ¡nh vÃ¡c toÃ n bá»™ <code class=\"language-text\">state</code> cá»§a á»©ng dá»¥ng. Náº¿u nÃ³ láº¡i dá»¯ liá»‡u cáº§n thiáº¿t trong lÃºc khá»Ÿi táº¡o á»©ng dá»¥ng láº§n Ä‘áº§u tiÃªn. Viá»‡c nÃ y sáº½ náº±m trong render critical path cá»§a trÃ¬nh duyá»‡t, Ä‘á»“ng nghÄ©a vá»›i viá»‡c user khÃ´ng tháº¥y gÃ¬ háº¿t cho Ä‘áº¿n khi dá»¯ liá»‡u nÃ y Ä‘Æ°á»£c load, parse, compile, execute bá»Ÿi Javascript engine bÃªn dÆ°á»›i.</p>\n<p>Äá»ƒ kháº¯c phá»¥c viá»‡c nÃ y má»™t trong nhá»¯ng cÃ¡ch lÃ m lÃ  dÃ¹ng server side rendering, chÃºng ta chá»‰ quÄƒng cÃ¡i HTML Ä‘Ã£ chá»©a toÃ n bá»™ káº¿t quáº£ cá»§a quÃ¡ trÃ¬nh xuá»‘ng user. TrÃ¬nh duyá»‡t user khÃ´ng cáº§n Ä‘áº£m Ä‘Æ°Æ¡ng cÃ´ng viá»‡c Ä‘Ã³ ná»¯a.</p>\n<p>NhÆ°ng náº¿u chÃºng ta khÃ´ng thá»ƒ dÃ¹ng server side rendering thÃ¬ sao?</p>\n<p>Náº¿u object chÃºng ta cáº§n khÃ´ng chá»©a nhá»¯ng gÃ¬ mÃ  JSON khÃ´ng há»— trá»£, nhÆ° BigInt, Maps, Sets,... ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng <code class=\"language-text\">JSON.parse</code></p>\n<p>VÃ¬ cÃº phÃ¡p cá»§a JSON Ä‘Æ¡n giáº£n hÆ¡n nhiá»u so vá»›i Javascript, nÃªn quÃ¡ trÃ¬nh parse sáº½ Ã­t tá»‘n kÃ©m hÆ¡n so vá»›i Javascript ráº¥t nhiá»u.</p>\n<p>Ná»™i dung bÃªn trong JSON Ä‘á»‘i vá»›i cÃ¡c engine ráº¥t dá»… Ä‘oÃ¡n, vÃ  ngÆ°á»£c láº¡i vá»›i cÃ¡c object. ThÃ­ dá»¥ náº¿u báº¡n lÃ  cÃ¡i engine rá»“i nhÃ¬n vÃ o Ä‘Ã¢y</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">parse</span><span class=\"token punctuation\">(</span>'<span class=\"token punctuation\">{</span></code></pre>\n<p>Khi báº¡n tháº¥y dáº¥u <code class=\"language-text\">{</code>, báº¡n sáº½ biáº¿t Ä‘Æ°á»£c chá»‰ cÃ³ 2 kháº£ nÄƒng cÃ³ thá»ƒ xáº£y ra: má»™t lÃ  báº¯t Ä‘áº§u má»™t object, hai lÃ  má»™t JSON khÃ´ng há»£p lá»‡.</p>\n<p>Trong khi Ä‘Ã³ sau dáº¥u <code class=\"language-text\">{</code>  cá»§a object, cÃ³ ráº¥t nhiá»u kháº£ nÄƒng xáº£y ra</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> <span class=\"token number\">42</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>x<span class=\"token punctuation\">}</span></code></pre>\n<p>ÄÃ¢y cÃ³ pháº£i lÃ  object khÃ´ng? GiÃ¡ trá»‹ x Ä‘ang trá» tá»›i Ä‘Ã¢u? KhÃ´ng thá»ƒ nÃ o cÃ³ Ä‘Ã¡p Ã¡n náº¿u khÃ´ng xem háº¿t toÃ n bá»™ code</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// khá»Ÿi táº¡o object, x trá»Ÿ tá»›i tháº±ng khai bÃ¡o trÆ°á»›c Ä‘Ã³</span>\n<span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>x<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// object destructuring, x khÃ´ng trá» tá»›i tháº±ng Ä‘áº§u</span>\n<span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>x<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> x<span class=\"token operator\">:</span> <span class=\"token number\">21</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// má»™t arrow function</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">y</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>x<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> x<span class=\"token punctuation\">;</span></code></pre>\n<p>NhÆ° váº­y, náº¿u gáº·p dáº¥u <code class=\"language-text\">{</code>, cÃ¡c engine pháº£i vÃ´ cÃ¹ng tháº­n trá»ng vÃ¬ pháº£i biáº¿t ngá»¯ cáº£nh hiá»‡n táº¡i má»›i biáº¿t nÃ³ lÃ  gÃ¬. </p>\n<p>Lá»£i dá»¥ng Ä‘áº·c tÃ­nh nÃ y chÃºng ta cÃ³ thá»ƒ cáº£i thiá»‡n tá»‘c Ä‘á»™ cá»§a cÃ¡c á»©ng dá»¥ng web cÃ³ sá»­ dá»¥ng má»™t object cÃ³ cáº¥u trÃºc tÆ°Æ¡ng tá»± nhÆ° JSON ( vÃ­ dá»¥ nhÆ° Redux Store). Thay vÃ¬ sá»­ dá»¥ng má»™t khai bÃ¡o object nhÆ° tháº¿ nÃ y</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> foo<span class=\"token operator\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> bar<span class=\"token operator\">:</span> <span class=\"token number\">1337</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ğŸŒ</span></code></pre>\n<p>CÃ³ thá»ƒ tÄƒng tá»‘c báº±ng cÃ¡ch viáº¿t</p>\n<pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token known-class-name class-name\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">parse</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{\"foo\":42,\"bar\":1337}'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ğŸš€</span></code></pre>\n<p>Miá»…n lÃ  viá»‡c tÃ­nh toÃ¡n nÃ y chá»‰ cáº§n parse má»™t láº§n báº±ng <code class=\"language-text\">JSON.parse</code>, nÃ³ sáº½ nhanh hÆ¡n nhiá»u so vá»›i cÃ¡ch khai bao object bÃ¬nh thÆ°á»ng, vÃ  chá»‰ nÃªn suy nghÄ© Ã¡p dá»¥ng khi object Ä‘Ã£ vÆ°á»£t quÃ¡ kÃ­ch thÆ°á»›c 10kB. </p>\n<p>Thá»±c hiá»‡n kiá»ƒm tra tá»‘c Ä‘á»™ cá»§a má»™t object khoáº£ng 8Mb dung lÆ°á»£ng trÃªn cÃ¡c engine khÃ¡c nhau. Káº¿t quáº£ nháº­n Ä‘Æ°á»£c Ã­t nháº¥t cÅ©ng tÄƒng tá»‘c gáº¥p 1.5 láº§n trÃªn cÃ¡c phiÃªn báº£n khÃ¡c nhau cá»§a V8</p>\n<p><img src=\"https://v8.dev/_img/cost-of-javascript-2019/json.svg\"></p>\n<p><a href=\"https://v8.dev/blog/cost-of-javascript-2019#json\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://v8.dev/blog/cost-of-javascript-2019#json</a></p>\n<p><a href=\"https://www.youtube.com/watch?v=ff4fgQxPaO0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Faster apps with JSON.parse (Chrome Dev Summit 2019)</a></p>\n","cover_image":"","related":[{"id":"1b2de7c708c340c3c39f2150b714a897","path":"/2019-12-24-4-ung-dung-cua-array-from/","title":"4 á»©ng dá»¥ng cá»§a Array.from","desc":"VÃ i á»©ng dá»¥ng nhá» cá»§a hÃ m Array.from"},{"id":"3cbd2588e65e7ca4b1ebac17d5d87485","path":"/2018-06-21-huong-dan-mot-so-ung-dung-cua-middleware/","title":"Má»™t sá»‘ á»©ng dá»¥ng cá»§a middleware","desc":"Tiáº¿p theo bÃ i trÆ°á»›c vá» middleware, á»©ng dá»¥ng vá»›i cÃ¡c trÆ°á»ng há»£p thá»±c táº¿"},{"id":"0da94706a1e6b0e733fc6085a9118cc2","path":"/2018-10-25-mot-so-nguyen-tac-su-dung-hinh-responsive/","title":"Má»™t sá»‘ nguyÃªn táº¯c vá»›i hÃ¬nh áº£nh responsive","desc":"Náº¿u báº¡n Ä‘Ã£ quÃªn hoáº·c chÆ°a biáº¿t, hÃ¬nh tiÃªu tá»‘n hÆ¡n 50% dung lÆ°á»£ng táº£i trang. Responsive image tuy dá»… nhÆ°ng khÃ´ng nÃªn xem nháº¹"},{"id":"ed20ea853375e5181c942b2bd43f7653","path":"/2018-05-01-huong-dan-cai-thien-performance-react-app/","title":"Cáº£i thiá»‡n performance cá»§a React App","desc":"Trong bÃ i nÃ y, chÃºng ta cÃ¹ng Ä‘i qua cÃ¡c bÆ°á»›c Ä‘á»ƒ fix nhá»¯ng issue liÃªn quan Ä‘áº¿n performance thÆ°á»ng tháº¥y."}]}},"context":{}}