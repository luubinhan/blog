{"hash":"5ee00dc0b71878963f9b5fb39ff7b4fecc0fc2a1","data":{"post":{"title":"Sử dụng Firebase Realtime với React Native","path":"/su-dung-firebase-realtime-voi-react-native/","date":"2018-08-07","timeToRead":2,"tags":[{"id":"react-native","title":"react-native","path":"/tag/react-native/"}],"desc":"Những tính năng của Firebase có thể đáp ứng nhu cầu của ứng dụng nhỏ, đơn giản, không cần đến server.","content":"<!-- TOC -->\n<ul>\n<li><a href=\"#setup\">Setup</a></li>\n<li><a href=\"#ghi-d%E1%BB%AF-li%E1%BB%87u\">Ghi dữ liệu</a></li>\n<li><a href=\"#%C4%91%E1%BB%8Dc-d%E1%BB%AF-li%E1%BB%87u\">Đọc dữ liệu</a></li>\n<li><a href=\"#c%E1%BA%ADp-nh%E1%BA%ADp-database\">Cập nhập database</a></li>\n<li><a href=\"#x%C3%B3a-d%E1%BB%AF-li%E1%BB%87u\">Xóa dữ liệu</a></li>\n</ul>\n<!-- /TOC -->\n<h1 id=\"setup\"><a href=\"#setup\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Setup</h1>\n<p>Trước khi đọc bài này bạn nên đọc trước bài <a href=\"http://www.androidgig.com/getting-started-with-firebase-android/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Bắt đầu với Firebase</a> để biết những tính năng có trong Firebase</p>\n<p>Bài này chúng ta sẽ bàn về cách sử dụng Firebase realtime với React Native. Trước khi bắt đầu ta cần tạo một project trên <a href=\"https://console.firebase.google.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Firebase Console</a></p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*lPogJSrLiNKRjIGwrUBalA.png\" alt=\"Sử dụng Firebase Realtime Database Với React Native\"></p>\n<p>Sau khi nhập tên project, khu vực, chúng ta đến màn hình welcome\n<img src=\"https://cdn-images-1.medium.com/max/1600/1*YqSdnt-L5BN8CxEId8jWuA.png\" alt=\"Sử dụng Firebase Realtime Database Với React Native\"></p>\n<p>Chọn <strong>Add Firebase to your web app</strong>, copy mấy thông tin này lại lưu ở đâu để dành dùng sau này</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*VUN6hQdArAdLy2yZ44msTA.jpeg\" alt=\"Sử dụng Firebase Realtime Database Với React Native\"></p>\n<p>Cài firebase thôi</p>\n<pre class=\"language-text\"><code class=\"language-text\">npm install firebase --save</code></pre>\n<p>Khởi tạo firebase object để bắt đầu sử dụng, trong file <code class=\"language-text\">app.js</code> hoặc <code class=\"language-text\">index.js</code></p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    databaseURL<span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;database-url>\"</span><span class=\"token punctuation\">,</span>\n    projectId<span class=\"token operator\">:</span> <span class=\"token string\">\"&lt;project-id>\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nfirebase<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">initializeApp</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre>\n<p>Khả năng cao là sẽ gặp lỗi sau <strong>Firebase app named ‘[DEFAULT]’ already exists (app/duplicate-app)</strong></p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*qHXMIrUPR0lhWXdm3M5BWg.png\" alt=\"Sử dụng Firebase Realtime Database Với React Native\"></p>\n<p>Để fix lỗi này, chỉ cần kiểm tra xem có bao nhiêu instance đang sử dụng <code class=\"language-text\">firebase.apps</code></p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>firebase<span class=\"token punctuation\">.</span><span class=\"token property-access\">apps</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">length</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    firebase<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">initializeApp</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Vậy là chúng ta có thể bắt đầu sử dụng Firebase realtime, hay bắt đầu với một thao tác đọc/ghi dữ liệu đơn giản</p>\n<h1 id=\"ghi-dữ-liệu\"><a href=\"#ghi-d%E1%BB%AF-li%E1%BB%87u\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Ghi dữ liệu</h1>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">writeUserData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">email<span class=\"token punctuation\">,</span> fname<span class=\"token punctuation\">,</span> lname</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  firebase<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">ref</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Users/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    email<span class=\"token punctuation\">,</span>\n    fname<span class=\"token punctuation\">,</span>\n    lname\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error'</span><span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Kết quả khi thành công</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*Vc2fHUmnfNPcLsYAQ5pPeg.png\" alt=\"Sử dụng Firebase Realtime Database Với React Native\"></p>\n<p>Để push vào một array</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">writeUserData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">email<span class=\"token punctuation\">,</span>fname<span class=\"token punctuation\">,</span>lname</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    firebase<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">ref</span><span class=\"token punctuation\">(</span><span class=\"token string\">'UsersList/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        email<span class=\"token punctuation\">,</span>\n        fname<span class=\"token punctuation\">,</span>\n        lname\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">data</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'data '</span> <span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">catch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'error '</span> <span class=\"token punctuation\">,</span> error<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p><img src=\"https://cdn-images-1.medium.com/max/1600/1*kCplR2waJQe5m7-G-AEuKg.png\" alt=\"Sử dụng Firebase Realtime Database Với React Native\"></p>\n<h1 id=\"đọc-dữ-liệu\"><a href=\"#%C4%91%E1%BB%8Dc-d%E1%BB%AF-li%E1%BB%87u\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Đọc dữ liệu</h1>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">readUserData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  firebase<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">ref</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Users/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">once</span><span class=\"token punctuation\">(</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">snapshot</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>snapshot<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Nếu muốn lấy data khi có 1 thay đổi xảy ra, ta dùng hàm <code class=\"language-text\">on</code></p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">readUserData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    firebase<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">ref</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Users/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'value'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">snapshot</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token console class-name\">console</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">log</span><span class=\"token punctuation\">(</span>snapshot<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">val</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h1 id=\"cập-nhập-database\"><a href=\"#c%E1%BA%ADp-nh%E1%BA%ADp-database\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Cập nhập database</h1>\n<p>Nếu muốn cập nhập data của một object, tạo một reference tới nó và sử dụng hàm <code class=\"language-text\">update()</code> với dữ liệu muốn thay đổi</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">updateSingleData</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">email</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  firebase<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">ref</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Users/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">update</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    email<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<h1 id=\"xóa-dữ-liệu\"><a href=\"#x%C3%B3a-d%E1%BB%AF-li%E1%BB%87u\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Xóa dữ liệu</h1>\n<p>Dùng hàm <code class=\"language-text\">remove()</code> hoặc là <code class=\"language-text\">set</code>, <code class=\"language-text\">update</code> giá trị về <code class=\"language-text\">null</code>, nó sẽ tự động xóa</p>\n<pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">deleteData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  firebase<span class=\"token punctuation\">.</span><span class=\"token method function property-access\">database</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">ref</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Users/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">remove</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p><a href=\"https://medium.com/mindorks/firebase-realtime-database-with-react-native-5f357c6ee13b\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Link bài gốc</a></p>\n","cover_image":"","related":[{"id":"34e1a6e4e7dac657edca4c9832d737dc","path":"/su-dung-tabindex/","title":"Sử dụng tabindex","desc":"Mặc định thứ tự tab theo vị trí của DOM rất hữu dụng, tuy nhiên có trường hợp chúng ta sẽ muốn thay đổi thứ tự tab này. Cùng nghiên cứu tabindex để set thứ tự tab"},{"id":"c739028abbcb89e9d3e7c89db87fa879","path":"/transition-trong-react-native-voi-react-navigation/","title":"Transition trong React Native với React Navigation","desc":"Hướng dẫn làm transition trong React Native với react navigation"},{"id":"8eedc3591fcf6d3c79f1d05a3ad61ae6","path":"/danh-sach-do-choi-de-bat-dau-voi-react-native/","title":"Danh sách đồ chơi để bắt đầu với React Native","desc":"Để bắt đầu và đào sâu vọc vạch với React Native, bạn sẽ cần đụng tới những món đồ chơi sau"},{"id":"b1851cc1980bb093ae4f97c8d1a1d08d","path":"/su-dung-react-hook-effect/","title":"Sử dụng React Hook Effect","desc":"Bài này mình contribute cho http://vi.reactjs.org về cách sử dụng React Hook Effect"},{"id":"597ad0a254fb16071f112cf582624065","path":"/chia-se-cua-lead-team-react-native-trong-qua-trinh-lap-team-react-native/","title":"Chia sẻ của lead team React Native trong quá trình lập team React Native","desc":"Bài viết sẽ phù hợp với founder của một startup, hoặc CTO. Bài viết này là chia sẻ của một team lead đang làm React Native, khía cạnh kỹ thuật cũng như cách tổ chức một team."},{"id":"cb3f4bb6b7e51df501700726716dff04","path":"/tai-sao-su-dung-flow-va-su-dung-flow-nhu-the-nao-trong-react/","title":"Tại sao sử dụng Flow, và sử dụng Flow như thế nào trong React","desc":"Tại sao chúng ta cần type checking trong javascript, tại sao Flow lại là lựa chọn của nhiều developer hiện nay"},{"id":"4c10a4ea5b43449c00b3d2717f69c6a3","path":"/su-dung-ellipsis-text-voi-flexbox/","title":"Sử dụng ellipsis text với flexbox","desc":"Câu chuyển cắt chuỗi khi quá dài bằng CSS, trong tình huống sau, cái tên file của bạn quá dài, nhưng bạn không muốn cắt ở cuối chuỗi, mà cắt ở giữa để vẫn thấy được file extension"},{"id":"431b04c69be9d0d7ae9bcf9c672a6d4f","path":"/cach-su-dung-ref-trong-react/","title":"Cách sử dụng ref trong React","desc":"Công dụng của ref là để truy cập đến DOM thật trong React, một vài tính huống sử dụng và dùng ref"},{"id":"02a02d68e2737698423d912c23786ac2","path":"/mot-so-cach-viet-su-dung-trong-react/","title":"Một số cách viết sử dụng trong React","desc":"Tổng hợp các cách làm phổ biến trong React"},{"id":"02a5a60cd7a087f460f4ccfd777912ea","path":"/su-dung-middleware-voi-redux-danh-cho-nguoi-moi-bat-dau/","title":"Sử dụng Middleware với Redux dành cho người mới bắt đầu","desc":"Nếu đã nắm rõ redux, bước tiếp theo phải tìm hiểu là middleware"}]}},"context":{}}