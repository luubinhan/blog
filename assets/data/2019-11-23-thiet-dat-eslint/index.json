{"hash":"99e40fc31a30de3332c68fee139e44329976dab8","data":{"post":{"title":"Thiết đặt ESLint cho dự án React","path":"/2019-11-23-thiet-dat-eslint/","date":"2019-11-23","timeToRead":2,"tags":[{"id":"thu-thuat","title":"thu-thuat","path":"/tag/thu-thuat/"},{"id":"tool","title":"tool","path":"/tag/tool/"}],"desc":"Các thiết đặt và công cụ cần thiết để eslint hoạt động tốt trong dự án React","content":"<p>ESLint có thể cài global, nhưng mình thấy nên cài trên từng project sẽ tiện hơn khi phải mang đi mang lại. Đây là những package cần thiết cho eslint chạy trên project React</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save-dev\neslint\nbabel-eslint\neslint-config-airbnb\neslint-config-babel\neslint-config-prettier\neslint-plugin-import\neslint-plugin-react</code></pre>\n<p>Bên trong thư mục gốc của project, tạo một file <code class=\"language-text\">.eslintrc</code>, với nội dung ngắn gọn thế này (muốn thêm bớt như thế này thì mọi người tự tùy chỉnh theo ý thích)</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"extends\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"airbnb\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:prettier/recommended\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"plugin:jsx-a11y/recommended\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"prettier\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"jsx-a11y\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"parser\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"babel-eslint\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token property\">\"env\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"browser\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Mấy bộ config sẵn của <strong>airbnb</strong>, <strong>prettier</strong> và <strong>jsx-a11y</strong> nếu không đủ dùng, bạn có thể tự thêm mắm muối vào trong file này luôn.</p>\n<p>Thay vì mỗi lần phải chạy lint thủ công trên từng file/thư mục</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">npx eslint src/App.js</code></pre>\n<p><img src=\"https://miro.medium.com/max/1480/1*_P4YPpbVg4L-Utu7egF-vg.png\"></p>\n<p>Chúng ta có thể thêm một đoạn shortcut vào trong <code class=\"language-text\">package.json</code></p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"lint\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eslint .\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"lint:fix\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"eslint --fix .\"</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Sau này chúng ta có thể chạy</p>\n<pre class=\"language-bash\"><code class=\"language-bash\">// chạy kiểm tra\n<span class=\"token function\">npm</span> run lint\n\n// chạy sửa lỗi\n<span class=\"token function\">npm</span> run lint:fix</code></pre>\n<p>Đợi nó chạy mới báo lỗi cũng được, nếu đang xài VSCode, cài package <a href=\"https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint#overview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">vscode-eslint</a> này vào, nó sẽ highlight những lỗi eslint ngay trên giao diện không cần phải đợi chạy mới báo</p>\n<p><img src=\"https://miro.medium.com/max/2880/1*O6Q5VDIKC4UM_sfJOlE82w.png\" alt=\"Chưa cài ESLint\"></p>\n<p><img src=\"https://miro.medium.com/max/2880/1*n20krHQQGci7D347-4HELQ.png\" alt=\"Đã cài ESlint\"></p>\n<p>Để hỗ trợ team tối đa, bạn có thể <em>export</em> những thiết đặt của VSCode vào 1 file trong thư mục <code class=\"language-text\">.vscode</code>, khi team nhận được thư mục project đồng thời cũng có luôn các plugin và thiết đặt cần thiết</p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// file extensions.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"recommendations\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"dbaeumer.vscode-eslint\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"esbenp.prettier-vscode\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"dzannotti.vscode-babel-coloring\"</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// File settings.json</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"eslint.validate\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">\"javascript\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"javascriptreact\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token property\">\"language\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"typescript\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"autoFix\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token property\">\"language\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"typescriptreact\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"autoFix\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"eslintConfig\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"extends\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"react-app\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"shared-config\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"rules\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"additional-rule\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"warn\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"overrides\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"files\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"**/*.ts?(x)\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"rules\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"additional-typescript-only-rule\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"warn\"</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Chúng ta cũng nên dùng Prettier để format code lại trước khi commit lên git. Cài đặt các package cần thiết cho nhu cầu này</p>\n<pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save\nhusky\nlint-staged\nprettier</code></pre>\n<ul>\n<li><code class=\"language-text\">husky</code> sẽ giúp chúng ta tương tác với git hook</li>\n<li><code class=\"language-text\">lint-stated</code> cho phép chúng ta chạy script trên các file đang nằm trong staged</li>\n<li><code class=\"language-text\">prettier</code> là công cụ để format code</li>\n</ul>\n<p>Tiếp theo, mở file <code class=\"language-text\">package.json</code></p>\n<pre class=\"language-json\"><code class=\"language-json\"><span class=\"token property\">\"husky\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"hooks\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"pre-commit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"lint-staged\"</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n<p>Bên dưới chỗ dependencies của file package.json</p>\n<pre class=\"language-diff\"><code class=\"language-diff\">\"dependencies\": {\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   // ...\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> },\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\"> \"lint-staged\": {\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">   \"src/**/*.{js,jsx,ts,tsx,json,css,scss,md}\": [\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">     \"prettier --write\",\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">     \"git add\"\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">   ]\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\"> },\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> \"scripts\": {</span></span></code></pre>\n<p>Hết ! 😉</p>\n","cover_image":"","related":[{"id":"f1e7e7301a64eaa87386851839352f42","path":"/2020-02-03-huong-dan-cai-dat-eslint-react-javascript-typescript-vscode/","title":"Chỉ dẫn thiết đặt ESLint trong nhiều tình huống sử dụng Javascript, Typescript, React","desc":"Chúng ta bắt đầu với Javascript trước, sau đó sẽ là TypeScript, và React. Mục tiêu là làm đúng, tránh trường hợp cài package không cần thiết hoặc copy/paste các config tới khi nó chạy được thì thôi."},{"id":"4819e08d90839e2a61d516158dad2f2e","path":"/2018-09-25-huong-dan-thiet-ke-react-component-tot/","title":"Chỉ dẫn để thiết kế React Component","desc":"Tốt hơn, tốt nữa, tốt mãi, luôn là điều mình muốn, ngoài chuyện viết cho nó chạy đúng, viết thế nào tốt nhất nên là mục tiêu khi làm việc"},{"id":"13769eb9687935dbba28cbe5e1a0818b","path":"/2019-10-14-huong-dan-dat-ten-bien-trong-javascript/","title":"Đặt tên sao cho đẹp trong javascript","desc":"Kim chỉ nam khi đặt tên trong javascript, nếu thật sự ban quan tâm những gì mình đang viết"}]}},"context":{}}