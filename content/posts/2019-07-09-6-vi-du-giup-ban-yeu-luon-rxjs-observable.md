---
slug: "/2019-07-09-6-vi-du-giup-ban-yeu-luon-rxjs-observable"
date: "2019-07-09"
title: "6 v√≠ d·ª• ƒë·ªÉ b·∫°n y√™u lu√¥n observable"
desc: "Th√™m nh·ªØng l√Ω do ƒë·ªÉ d·ª• d·ªó b·∫°n x√†i Observable"
cover: ""
type: "post"
lesson: 0
chapter: 0
tags: ["javascript", "thu-thuat"]
---

<!-- TOC -->

- [Handle c√°c event b·∫±ng Observable](#Handle-c%C3%A1c-event-b%E1%BA%B1ng-Observable)
- [Operator, operator](#Operator-operator)
- [Ai c√≥ th·ªÉ l√† Observable](#Ai-c%C3%B3-th%E1%BB%83-l%C3%A0-Observable)
- [Observable cho c√°c HTTP request](#Observable-cho-c%C3%A1c-HTTP-request)
- [K·∫øt h·ª£p c√°c Observable](#K%E1%BA%BFt-h%E1%BB%A3p-c%C3%A1c-Observable)
- [K·∫øt](#K%E1%BA%BFt)

<!-- /TOC -->

**Observable** m√¨nh d·ªãch ra ti·∫øng vi·ªát th·∫ø n√†y cho b·∫°n d·ªÖ h√¨nh dung. M·ªôt khi b·∫°n b·∫≠t ch·∫ø ƒë·ªô `observable` v·ªõi m·ªôt ƒë·ª©a con g√°i n√†o ƒë√≥, l√† b·∫°n ƒëang trong giai ƒëo·∫°n b·ªã n√≥ √°m ·∫£nh, nh·∫•t c·ª≠ nh·∫•t ƒë·ªông c·ªßa n√≥ b·∫°n ƒëi·ªÅu ƒë·ªÉ √Ω, n√≥ h·∫Øc x√¨ b·∫°n c≈©ng bi·∫øt, m·ªôt tu·∫ßn n√≥ m·∫∑c m·∫•y b·ªô ƒë·ªì b·∫°n c≈©ng bi·∫øt. Ch·ªâ c·∫ßn nghe ti·∫øng b∆∞·ªõc ch√¢n l√† b·∫°n bi·∫øt ƒë∆∞·ª£c h√¥m nay n√≥ mang ƒë√¥i d√©p g√¨ (m·ª©c ƒë·ªô n√†y h∆°i kinh kh·ªßng l·∫Øm r·ªìi) l√† b·∫°n c√≥ nh·ªØng ph·∫£n x·∫° v√¥ ƒëi·ªÅu ki·ªán b·ªôc ph√°t n∆°i c·ª≠a mi·ªáng "Chi·ªÅu nay tr·ªùi m∆∞a nhe em, mang d√©p l√†o ƒëi cho chu·∫©n". Ph·∫£n x·∫° n√†y l√† g·ªçi l√† **subscription**

R·ªìi quay l·∫°i v·ªõi v·∫•n ƒë·ªÅ k·ªπ thu·∫≠t, b√†i n√†y kh√¥ng gi·∫£i th√≠ch r√µ Observable pattern, c√°c kh√°i ni·ªám ch√≠nh c·ªßa n√≥, n·∫øu mu·ªën b·∫°n ƒë·ªçc l·∫°i b√†i n√†y tr∆∞·ªõc ƒë√¢y [c√≥ vi·∫øt r·ªìi](https://luubinhan.github.io/blog/2018-10-30-gioi-thieu-reactive-programing-trong-javascript), nh∆∞ c√°i t·ª±a b√†i vi·∫øt n√≥ spoil h·∫øt c√°i n·ªôi dung r·ªìi "V√≠ d·ª• ƒë·ªÉ th·∫•y t·∫°i sao ch√∫ng ta n√™n *b·∫≠t ch·∫ø ƒë·ªô* Observable v·ªõi m·ªôt em g√°i n√†o ƒë√≥"

Th·∫ßn ch√∫ m√¨nh mu·ªën b·∫°n thu·ªôc l·∫ßu

> L·∫≠p tr√¨nh Reactive l√† l√†m vi·ªác v·ªõi lu·ªìng d·ªØ li·ªáu b·∫•t ƒë·ªìng b·ªô

L·∫°i ph·∫£i gi·∫£i th√≠ch c√¢u n√†y ch√∫t, **N·∫øu nh·ªØng g√¨ di·ªÖn ra tr√™n ·ª©ng d·ª•ng ƒëang x·∫£y ra m·ªôt c√°ch b·∫•t ƒë·ªìng b·ªô, kh·∫£ nƒÉng r·∫•t cao l√† Observable s·∫Ω gi√∫p √≠ch cho cu·ªôc s·ªëng c·ªßa anh em ch√∫ng ta b·ªõt kh·ªï h∆°n**.

C√≥ nhi·ªÅu c√°ch l√†m v√† th∆∞ vi·ªán handle v·ª• lu·ªìng d·ªØ li·ªáu b·∫•t ƒë·ªìng b·ªô n√†y, tuy nhi√™n, Observable c√≥ g√¨ m√† cool, s·∫Øp ƒë∆∞·ª£c chu·∫©n h√≥a v√† ƒë∆∞a v√†o ECMAScript. Th∆∞ vi·ªán RxJS ƒëang ƒë∆∞·ª£c s·ª≠ d·ª•ng r·ªông r√£i v√† qu√° ngon r·ªìi.

R·ªìi v√¥ lu√¥n v√≠ d·ª• nhe

## Handle c√°c event b·∫±ng Observable

Ch√∫ng ta c√≥ 1 button, khi button n√†y click t·∫°o ra m·ªôt chu·ªói ng·∫´u nhi√™n. Vi·∫øt b·∫±ng c·∫£ 2 c√°ch javascript thu·∫ßn, v√† s·ª≠ d·ª•ng RxJS

```js
const button = document.querySelector('button');
const output = document.querySelector('output');

button.addEventListener('click', e => {
    output.textContent = Math.random().toString(36).slice(2);
})
```

B·∫±ng RxJS n√®

```js
const button = document.querySelector('button');
const output = document.querySelector('output');

Rx.Observable
    .fromEvent(button, 'click')
    .subscribe(() => {
        output.textContent = Math.random().toString(36).slice(3);
    })
```

N√≥ d√†i h∆°n khi vi·∫øt javascript thu·∫ßn m√† man üòÇ. Chi m√† ph·ª©c t·∫°p v·∫≠y? ƒê√∫ng lu√¥n, nh∆∞ng gi·ªù th√™m y√™u c·∫ßu n√†y v√†o th√¨ sao: *·ªû m·ªói l·∫ßn click ƒë·∫øn b·ªôi s·ªë c·ªßa 3 ( 3,6,9,12,...) th√¨ m·ªõi random m·ªôt string m·ªõi*

```js
Rx.Observable
    .fromEvent(button, 'click')
    .bufferCount(3) // m·ªôt d√≤ng duy nh·∫•t
    .subscribe(() => {
        output.textContent = Math.random().toString(36).slice(3);
    })
```

V·∫≠y b·∫°n vi·∫øt JS th√¥i th√¨ sao, kh·ªèi n√≥i c≈©ng bi·∫øt n√≥ s·∫Ω d√†i d√≤ng h∆°n.

## Operator, operator

Trong v√≠ d·ª• tr√™n, `.bufferCount` *ƒë√£ cho th·∫•y s·ª©c m·∫°nh v∆∞·ª£t tr·ªôi** so v·ªõi c√°ch th√¥ng th∆∞·ªùng. C√≥ th·ªÉ n√≥i th·∫ø n√†y, **ch√∫ng ta x√†i Observable n√†y l√† v√¨ nh·ªØng g√¨ ch√∫ng ta l√†m ƒë∆∞·ª£c b·∫±ng operator**. Trong th∆∞ vi·ªán RxJS n√≥ c·∫£ t√° Operator tha h·ªì m√† ch∆°i.

M·ªôt v√≠ d·ª• kh√°c, c≈©ng l√† v·ª• random string ·ªü tr√™n, m√† gi·ªù ch·ªâ mu·ªën random **khi n√≥ l√† m·ªôt c√∫ triple click** (m·ªôt ph√°t 3 nh√°y, kh√¥ng ph·∫£i double click nhoa)

```js
const click$ = Rx.Observable.fromEvent(button, 'click');

click$.Observable
    .bufferWhen(() => {
        click$.delay(400);
        // kkho·∫£ng th·ªùi gian c·ªßa m·ªôt c√∫ 3 click
    })
    .filter(events => events.length >= 3)
    .subscribe(() => {
        output.textContent = Math.random().toString(36).slice(3);
    })
```

D·ªäch ra ng√¥n ng·ªØ con ng∆∞·ªùi n√≥ s·∫Ω nh∆∞ th·∫ø n√†y, **trong kho·∫£ng th·ªùi gian l√† 400ms, trong ƒë√°m event ƒë∆∞·ª£c emit (t·ª•i n√†y ƒë∆∞·ª£c ƒë∆∞a v√†o m·∫£ng `events`), n·∫øu m·∫£ng n√†y l·ªõn h∆°n ho·∫∑c b·∫±ng 3, th·ª±c hi·ªán ƒë·ªëng vi·ªác ƒë√£ ƒëƒÉng k√Ω b√™n d∆∞·ªõi `subscribe`**

B·∫°n ƒë√£ b·∫Øt ƒë·∫ßu y√™u Observable ch∆∞a? M√¨nh ƒë√£ kho√°i kho√°i r·ªìi ƒë√≥.

## Ai c√≥ th·ªÉ l√†  Observable

ƒê∆°n gi·∫£n, b·∫•t k·ªÉ gi√† tr·∫ª l·ªõn b√©, trai g√°i, n·∫øu RxJS c√≥ h√†m ( khi n√£y l√† `.fromEvent`) th√¨ ch√∫ng ta c√≥ th·ªÉ bi·∫øn n√≥ th√†nh ƒë·ªëi t∆∞·ª£ng b·ªã theo d√µi li√™n t·ª•c.

## Observable cho c√°c HTTP request

M·ªôt s·ª©c m·∫°nh *si√™u nhi√™n* kh√°c c·ªßa RxJS: x·ª≠ l√Ω m·∫•y em HTTP request r·∫•t m∆∞·ª£t m√†

V√≠ d·ª•, fetching m·ªôt danh s√°ch album v√† render.

```js
const albumsApiUrl = 'https://jsonplaceholder.typicode.com/albums';

Rx.Observable
    .ajax(albumsApiUrl)
    .subscribe(
        res => console.log(res),
        err => console.log(err)
    )
```

Tr·ªôn chung v·ªõi v√≠ d·ª• ·ªü tr√™n, ch√∫ng ta l√†m c√°i t√≠nh nƒÉng awsome sau, click  l√† c√≥ danh s√°ch album ng·∫´u nhi√™n

```js
Rx.Observable
    .fromEvent(button, 'click')
    .flatMap(getAlbums)
    .subscribe(
        render,
        err => console.error(err)
    )

function getAlbums() {
    const userId = Math.round(Math.random() * 10);
    return Rx.Observable.ajax(
        `https://jsonplaceholder.typicode.com/albums?userId=${userId}`
        )
}
```

<iframe height="265" style="width: 100%;" scrolling="no" title="Observables 4" src="//codepen.io/mmiszy/embed/WZOJjy/?height=265&theme-id=0&default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true">
  See the Pen <a href='https://codepen.io/mmiszy/pen/WZOJjy/'>Observables 4</a> by Micha≈Ç Miszczyszyn
  (<a href='https://codepen.io/mmiszy'>@mmiszy</a>) on <a href='https://codepen.io'>CodePen</a>.
</iframe>


V√≠ d·ª• tr√™n c√≥ s·ª≠ d·ª•ng operator `flatMap`, 1 trong nh·ªØng operator si√™u kinh ƒëi·ªÉn c·ªßa RxJS, cho ph√©p merge 2 m·∫£ng ki·ªÉu Observable th√†nh 1

N·∫øu ch√∫ng ta click li√™n t·ª•c trong th·ªùi gian ng·∫Øn, l√† c√≥ v·∫•n ƒë·ªÅ, re-render nhi·ªÅu l·∫ßn, ch√∫ng ta c≈©ng ko x√°c ƒë·ªãnh ƒë∆∞·ª£c request n√†o ƒë∆∞·ª£c resolve cu·ªëi c√πng. C·ª• th·ªÉ l√† th·∫ø n√†y, c√≥ th·ªÉ th·∫±ng xu·∫•t ph√°t tr∆∞·ªõc l·∫°i v·ªÅ ƒë√≠ch sau c√πng, chuy·ªán c·ªßa network ai m√† bi·∫øt ƒë∆∞·ª£c th·ªùi ƒëi·ªÉm ƒë√≥ n√≥ download film g√¨ l√†m ch·∫≠m m·∫°ng, th·∫±ng request sau c√≥ khi l·∫°i v·ªÅ ƒë√≠ch tr∆∞·ªõc, nh∆∞ v·∫≠y th√¨ d√πng c·ª•c response l√∫c n√†o ƒë·ªÉ render, m√¨nh mu·ªën response c·ªßa th·∫±ng request cu·ªëi c√πng.

B·∫°n mu·ªën, trong c√¥ng cu·ªôc t√°n g√°i, ƒë·ª©a n√†o ·ªü l·∫°i ƒë·∫øn gi√¢y ph√∫t cu·ªëi c√πng l√† ƒë·ª©a chi·∫øn th·∫Øng, b·∫°n s·∫Ω d·∫πp lu√¥n nh·ªØng ƒë·ª©a n√†o th·∫£ th√≠nh tr∆∞·ªõc ƒë√≥? V√≠ von nh∆∞ v·∫≠y c≈©ng ch∆∞a chu·∫©n, ph·∫£i l√† ƒë·ª©a n√†o ƒë·∫øn sau c√πng th√¨ d·ªØ l·∫°i, d·∫πp m·∫π t·ª•i t·ªõi tr∆∞·ªõc (th·∫ø n√†y th√¨ b·∫•t c√¥ng vl m·∫•y b·∫°n)

RxJS l√†m ƒë∆∞·ª£c chuy·ªán ƒë√≥ kh√¥ng? C√≥ ch·ª©, **m·ªçi th·ª© ƒë√£ c√≥ operator**, chuy·ªÉn qua d√πng `switchMap`, s·∫Ω ch·ªâ c√≥ **response cu·ªëi c√πng ƒë∆∞·ª£c render**, m·∫•y request tr∆∞·ªõc ƒë√≥ s·∫Ω b·ªã cancel h·∫øt

![](https://res.cloudinary.com/dukp6c7f7/image/upload/f_auto,fl_lossy,q_auto/s3-ghost/2017/09/Screen_Shot_2017_09_29_at_9_24_06_PM-1506713083152.png)

```js{3}
Rx.Observable
    .fromEvent(button, 'click')
    .switchMap(getAlbums)
    .subscribe(
        render,
        err => console.error(err)
    )
```

## K·∫øt h·ª£p c√°c Observable

M·ªôt use case kh√°c m√† ch√∫ng ta g·∫∑p ho√†i. Ch·ª©c nƒÉng filter ho·∫°t ƒë·ªông nh∆∞ sau: cho t·ª•i user nh·∫≠p v√†o `user id` b·∫±ng `<input />`, v√† ch·ªçn th·ªÉ lo·∫°i √¢m nh·∫°c n√≥ mu·ªën b·∫±ng `<select />`. ƒêi·ªÅu quan tr·ªçng l√† ch·ªâ t·∫°o request m·ªõi khi c·∫£ 2 gi√° tr·ªã trong ƒë√≥ ƒëi·ªÅu c√≥ d·ªØ li·ªáu, v√† re-render khi m·ªôt trong 2 gi√° tr·ªã n√†y b·ªã thay ƒë·ªïi.

T·∫°o Observable tr∆∞·ªõc nh√©

```js
const id$ = Rx.Observable
    .fromEvent(input, 'input')
    .map(e => e.target.value)

const resource$ = Rx.Observable
    .fromEvent(select, 'change')
    .map(e => e.target.value)
```

Ch√∫ng ta ph·∫£i h·ª£p th·ªÉ 2 th·∫±ng tr√™n v√†o m·ªôt, ƒë·ªÉ khi m·ªôt trong 2 th·∫±ng c√≥ thay ƒë·ªïi ch√∫ng ta l·∫•y ƒë∆∞·ª£c gi√° tr·ªã sau c√πng c·ªßa c·∫£ 2. **m·ªçi th·ª© ƒë√£ c√≥ operator**, nhi·ªÅu l·∫Øm, ·ªü ƒë√¢y d√πng `combineLatest`

```js
Rx.Observable
    .combineLatest(id$, resource$)
    .switchMap(getResource)
    .subscribe(render)
```

<iframe height="265" style="width: 100%;" scrolling="no" title="Observables 6" src="//codepen.io/mmiszy/embed/mBwLoX/?height=265&theme-id=0&default-tab=js,result" frameborder="no" allowtransparency="true" allowfullscreen="true">
  See the Pen <a href='https://codepen.io/mmiszy/pen/mBwLoX/'>Observables 6</a> by Micha≈Ç Miszczyszyn
  (<a href='https://codepen.io/mmiszy'>@mmiszy</a>) on <a href='https://codepen.io'>CodePen</a>.
</iframe>


## K·∫øt

B·∫°n ƒë√£ th·∫•y s·ª≠ d·ª•ng Observable th√∫ v·ªã d∆∞·ªùng n√†o ch∆∞a? N·∫øu c√¢u tr·∫£ l·ªùi l√† "C√≥ ‚ù§Ô∏è, tr·ªçn ƒë·ªùi y√™u em", b·∫°n h√£y nh√†o v√¥ document c·ªßa n√≥ ƒë·ªÉ nghi√™n c·ª©u chuy√™n s√¢u h∆°n. Ho·∫∑c [ƒë·ªçc l·∫°i b√†i tr∆∞·ªõc ƒë√¢y c·ªßa m√¨nh](https://luubinhan.github.io/blog/2018-10-30-gioi-thieu-reactive-programing-trong-javascript).

N·∫øu c√¢u tr·∫£ l·ªùi l√† "No üí©, anh √©o care m·∫•y ƒë·ª©a ·∫°". Th√¨ b·∫°n c≈©ng n√™n b·ªõt b·ªõt ƒë·ªëi x·ª≠ t·ªá v·ªõi n√≥ ƒëi, v√¨ trong t∆∞∆°ng lai JS s·∫Ω ƒë∆∞a n√†o v√†o nh∆∞ m·ªôt object ch√≠nh th·ª©c lu√¥n, kh√¥ng ch·∫°y ƒë·∫±ng tr·ªùi ƒë∆∞·ª£c ƒë√¢u c√°c b·∫°n ·∫°.

Hy v·ªçng anh em h√¥m nay ƒë√£ h·ªçc th√™m ƒë∆∞·ª£c c√°i g√¨ ƒë√≥ th√∫ v·ªã, h·∫πn g·∫∑p l·∫°i anh em v√†o m·ªôt vi·∫øt th√∫ v·ªã kh√°c.


<a target="_blank" rel="noopener noreferrer" href="https://x-team.com/blog/rxjs-observables/">6 SIMPLE EXAMPLES WHICH WILL MAKE YOU LOVE OBSERVABLES (RXJS 5)</a>