<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Bảo mật web - Một số kiểu tấn công - VuiLapTrinh.com</title><meta name="gridsome:hash" content="0395a9475e6dcec202a1209b8bd40b74ee081359"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.21"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Tutorials, Blog, Hướng dẫn, chia sẽ kinh nghiệm về Frontend, react, vue, ux, ui"><meta data-vue-tag="ssr" name="desc" content="Tổng quát các vấn đề bạn cần quan tâm để bảo mật ứng dụng web"><link rel="preload" href="/assets/css/0.styles.4e7b3092.css" as="style"><link rel="preload" href="/assets/js/app.88e72233.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.0d21aba4.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.204466f8.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.0b0d171f.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.854eb99f.js"><link rel="stylesheet" href="/assets/css/0.styles.4e7b3092.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <script>
      // Add dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
      (function() {
        window.__onThemeChange = function() {};
        function setTheme(newTheme) {
          window.__theme = newTheme;
          preferredTheme = newTheme;
          document.body.setAttribute('data-theme', newTheme);
          window.__onThemeChange(newTheme);
        }

        var preferredTheme;
        try {
          preferredTheme = localStorage.getItem('theme');
        } catch (err) { }

        window.__setPreferredTheme = function(newTheme) {
          setTheme(newTheme);
          try {
            localStorage.setItem('theme', newTheme);
          } catch (err) {}
        }

        var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
        darkQuery.addListener(function(e) {
          window.__setPreferredTheme(e.matches ? 'dark' : 'light')
        });

        setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
      })();
    </script>

    <div id="app" data-server-rendered="true" class="layout-blog"><header class="header"><div class="header__left"><a href="/" class="logo active"><span class="logo__text">
    ← VuiLapTrinh.com
  </span></a></div><div class="header__right"><button role="button" aria-label="Toggle dark/light" class="toggle-theme"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button></div></header><main class="main"><div class="single-post"><div class="single-post-container"><article><header><div class="post-title"><h1 class="post-title__text single-post-title">Bảo mật web - Một số kiểu tấn công</h1><div class="post-meta">
  Đăng ngày 2018-11-18.
  
    Mất khoảng
    <strong>4 phút</strong> để đọc.
  </div></div></header><div class="post content-box"><div class="post__header"><!----></div><div className="blog-post"><div class="post-content"><div class="post__content"><!-- TOC -->
<ul>
<li>
<p><a href="#c%C3%A1ch-qu%E1%BA%A3n-l%C3%BD-session-hi%E1%BB%87n-t%E1%BA%A1i">Cách quản lý Session hiện tại</a></p>
<ul>
<li><a href="#session-qu%E1%BA%A3n-l%C3%BD-b%E1%BB%9Fi-server">Session quản lý bởi server</a></li>
<li><a href="#session-qu%E1%BA%A3n-l%C3%BD-%E1%BB%9F-client">Session quản lý ở client</a></li>
</ul>
</li>
<li>
<p><a href="#m%E1%BB%99t-s%E1%BB%91-ki%E1%BB%83u-t%E1%BA%A5n-c%C3%B4ng">Một số kiểu tấn công</a></p>
<ul>
<li>
<p><a href="#csrf-cross-site-request-forgery">CSRF (Cross-Site Request Forgery)</a></p>
<ul>
<li><a href="#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-1-s%E1%BB%AD-d%E1%BB%A5ng-html-token">Cách ngăn chặn #1: Sử dụng HTML token</a></li>
<li><a href="#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-2-origin-header">Cách ngăn chặn #2: Origin Header</a></li>
<li><a href="#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-3-d%C3%B9ng-transparent-token">Cách ngăn chặn #3: dùng transparent token</a></li>
</ul>
</li>
<li>
<p><a href="#cross-site-scripting-xss">Cross-Site Scripting (XSS)</a></p>
<ul>
<li><a href="#store-xss---l%C6%B0u-%C4%91o%E1%BA%A1n-script-%C4%91%C3%B3-l%C3%AAn-tr%C3%AAn-server">Store XSS - lưu đoạn script đó lên trên server</a></li>
<li><a href="#reflect-xss">Reflect XSS</a></li>
<li><a href="#dom-based-xss">DOM-Based XSS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#c%C3%B4ng-c%E1%BB%A5-ki%E1%BB%83m-tra">Công cụ kiểm tra</a></li>
</ul>
<!-- /TOC -->
<h2 id="cách-quản-lý-session-hiện-tại"><a href="#c%C3%A1ch-qu%E1%BA%A3n-l%C3%BD-session-hi%E1%BB%87n-t%E1%BA%A1i" aria-hidden="true"><span class="icon icon-link"></span></a>Cách quản lý Session hiện tại</h2>
<p>HTTP = stateless</p>
<ul>
<li>Tất cả request từ cùng 1 client không liên quan gì với nhau</li>
<li>Server không có cách nào để lưu tạm giá trị state
HTTP hỗ trợ gửi đi dữ liệu authentication</li>
<li>Thông qua <strong>Header.Authorization</strong></li>
<li>Gửi thông tin kèm theo tất cả request</li>
<li>Server không can thiệp gì trên từng session</li>
</ul>
<h3 id="session-quản-lý-bởi-server"><a href="#session-qu%E1%BA%A3n-l%C3%BD-b%E1%BB%9Fi-server" aria-hidden="true"><span class="icon icon-link"></span></a>Session quản lý bởi server</h3>
<p>Server toàn quyền kiểm soát session, kiểm tra tình trạng active, expire, invalid date, xóa session</p>
<p>Đại diện cho cách này là dùng Cookie</p>
<ul>
<li>Dữ liệu được truyền qua lại giữa server và client</li>
<li>Hầu hết các trình duyệt đều hỗ trợ, <strong>khó</strong>, nếu sử dụng bên ngoài trình duyệt (ứng dụng điện thoại chẳng hạn)</li>
<li>Bị tấn công <a href="#csrf-cross-site-request-forgery">CSRF</a></li>
</ul>
<p>Theo mặc định các request sẽ không nên gửi kèm thông tin xác thực tài khoản (ví dụ cookie), nếu cần gửi thêm thông tin này bằng thiết đặt <code class="language-text">withCredentials</code> thủ công, phía server đồng thời cũng gửi lại trong response header giá trị <code class="language-text">Access-Control-Allow-Credentials: true</code></p>
<h3 id="session-quản-lý-ở-client"><a href="#session-qu%E1%BA%A3n-l%C3%BD-%E1%BB%9F-client" aria-hidden="true"><span class="icon icon-link"></span></a>Session quản lý ở client</h3>
<p>Đưa toàn bộ thông tin session xuống phía client
Server không kiểm soát session nào đang active
Dữ liệu session được gửi đi trên mỗi request</p>
<p>Đại diện cho kiểu này là dùng Token (JWT đang là phổ biến nhất)</p>
<ul>
<li>Dữ liệu session được lưu xuống token, server gửi token này qua HTTP header hoặc body của response</li>
<li>Ứng dụng tự quản lý chuyện gửi server token này</li>
<li>Trên mỗi request gửi đi nó không tự chèn token vào, do đó nó không thể tấn công bằng <a href="#csrf-cross-site-request-forgery">CSRF</a></li>
<li>Mồi ngon của tấn công <a href="#cross-site-scripting-xss">XSS</a></li>
</ul>
<h2 id="một-số-kiểu-tấn-công"><a href="#m%E1%BB%99t-s%E1%BB%91-ki%E1%BB%83u-t%E1%BA%A5n-c%C3%B4ng" aria-hidden="true"><span class="icon icon-link"></span></a>Một số kiểu tấn công</h2>
<h3 id="csrf-cross-site-request-forgery"><a href="#csrf-cross-site-request-forgery" aria-hidden="true"><span class="icon icon-link"></span></a>CSRF (Cross-Site Request Forgery)</h3>
<p>Kiểu tấn công rất phổ biến, nếu thông tin session được gửi qua Cookie. Đại khái là nếu bạn đăng nhập vào facebook.com, sau đó truy cập vào trang web nào đó bị hack rồi, trang bị hack này sẽ gửi một trang có nội dung html bên trong đó nó dùng một thẻ nào đó (như <code class="language-text">&lt;img /&gt;</code>, <code class="language-text">&lt;iframe/&gt;</code>, <code class="language-text">&lt;link/&gt;</code>, <code class="language-text">&lt;bgsound/&gt;</code>, <code class="language-text">&lt;background /&gt;</code>) để gửi một request thay đổi email lên trang facebook.com</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>facebook.com/api/1/destroy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>facebook.com/api/1/destroy<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bgsound</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>facebook.com/api/1/destroy<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>background</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>facebook.com/api/1/destroy<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>facebook.com/api/1/destroy<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></code></pre>
<p><img src="https://i.imgur.com/sRrzge5.png" alt="CSRF (Cross-Site Request Forgery)"></p>
<h4 id="cách-ngăn-chặn-1-sử-dụng-html-token"><a href="#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-1-s%E1%BB%AD-d%E1%BB%A5ng-html-token" aria-hidden="true"><span class="icon icon-link"></span></a>Cách ngăn chặn #1: Sử dụng HTML token</h4>
<p>Dấu token bên trong HTML, ví dụ như nhét nó trong form, server khi nhận được sẽ kiểm tra lại để chắc chắn là token này hợp lệ </p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>hidden<span class="token punctuation">'</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>CSRFToken<span class="token punctuation">'</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>OWY4NmQwODE4ODRjN2Q2NTlhMmZlYWEwYzU1YWQwMTVhM2JmNGYxYjJiMGI4MjJjZDE1ZDZMGYwMGEwOA==<span class="token punctuation">'</span></span> <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></code></pre>
<p>Tuy nhiên cách này sẽ không thích hợp với SPA, vì yêu cầu phía server phải quản lý session của từng user đang login</p>
<h4 id="cách-ngăn-chặn-2-origin-header"><a href="#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-2-origin-header" aria-hidden="true"><span class="icon icon-link"></span></a>Cách ngăn chặn #2: Origin Header</h4>
<p>Với những request như POST/PUT/DELETE, tự động thêm Origin Header để xác thực yêu cầu</p>
<p><img src="https://i.stack.imgur.com/ymk6L.png" alt="Cách ngăn chặn #2: Origin Header"></p>
<p><img src="https://i.imgur.com/wXzd41T.jpg" alt="Cách ngăn chặn #2: Origin Header"></p>
<h4 id="cách-ngăn-chặn-3-dùng-transparent-token"><a href="#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-3-d%C3%B9ng-transparent-token" aria-hidden="true"><span class="icon icon-link"></span></a>Cách ngăn chặn #3: dùng transparent token</h4>
<p>So sánh giá trị cookie với giá trị header</p>
<p>User gửi đi một request, nó nhận được 1 Session Cookie và 1 CSRF Token Cookie.</p>
<pre class="language-text"><code class="language-text">Set-Cookie: session=...
Set-Cookie: CSRF-Token=123</code></pre>
<p>Khi ứng dụng gửi đi một request, javascript sẽ copy cookie và đưa vào header <code class="language-text">X-CSRF-Token</code> chỉ javascript trên trang hiện tại mới truy xuất được thông tin này</p>
<pre class="language-text"><code class="language-text">Cookie: session=...
Cookie: CSRF-Token=123
X-CSRF-Token: 123</code></pre>
<p>Server đơn giản là kiểm tra 2 giá trị <code class="language-text">Cookie: CSRF-Token</code> và <code class="language-text">X-CSRF-Token</code> có khớp không</p>
<h3 id="cross-site-scripting-xss"><a href="#cross-site-scripting-xss" aria-hidden="true"><span class="icon icon-link"></span></a>Cross-Site Scripting (XSS)</h3>
<p>Hacker sẽ tìm cách để chạy javascript trên trang trình duyệt của user, khi user truy cập vào một trang đã bị hack. Hacker sẽ dùng những cách sau</p>
<h4 id="store-xss---lưu-đoạn-script-đó-lên-trên-server"><a href="#store-xss---l%C6%B0u-%C4%91o%E1%BA%A1n-script-%C4%91%C3%B3-l%C3%AAn-tr%C3%AAn-server" aria-hidden="true"><span class="icon icon-link"></span></a>Store XSS - lưu đoạn script đó lên trên server</h4>
<p><img src="https://i.imgur.com/45lHKy2.jpg" alt="Cross-Site Scripting (XSS)"></p>
<h4 id="reflect-xss"><a href="#reflect-xss" aria-hidden="true"><span class="icon icon-link"></span></a>Reflect XSS</h4>
<p><img src="https://i.imgur.com/dbRVLC5.jpg" alt="Reflect XSS"></p>
<h4 id="dom-based-xss"><a href="#dom-based-xss" aria-hidden="true"><span class="icon icon-link"></span></a>DOM-Based XSS</h4>
<p><img src="https://i.imgur.com/29G28Ee.jpg" alt="Reflect XSS"></p>
<p>Cách phổ biến để phòng chống</p>
<ul>
<li>Filter hết mấy đoạn html nguy hiểm (như &#x3C; >, " ", &#x26;) trước khi lưu</li>
<li>Dùng thư viện để escape context-sensitive trước khi output</li>
</ul>
<h2 id="công-cụ-kiểm-tra"><a href="#c%C3%B4ng-c%E1%BB%A5-ki%E1%BB%83m-tra" aria-hidden="true"><span class="icon icon-link"></span></a>Công cụ kiểm tra</h2>
<p>Một số trang online để check</p>
<p><a href="https://securityheaders.com/" target="_blank" rel="nofollow noopener noreferrer">https://securityheaders.com/</a></p>
<p><a href="https://sitecheck.sucuri.net/" target="_blank" rel="nofollow noopener noreferrer">https://sitecheck.sucuri.net/</a></p>
<p><a href="https://www.ssllabs.com/ssltest/" target="_blank" rel="nofollow noopener noreferrer">https://www.ssllabs.com/ssltest/</a></p>
<p><a href="https://quttera.com/" target="_blank" rel="nofollow noopener noreferrer">https://quttera.com/</a></p>
<p><a href="https://detectify.com/" target="_blank" rel="nofollow noopener noreferrer">https://detectify.com/</a></p>
<p><a href="https://app.webinspector.com/" target="_blank" rel="nofollow noopener noreferrer">https://app.webinspector.com/</a></p>
<p><a href="https://app.upguard.com/webscan" target="_blank" rel="nofollow noopener noreferrer">https://app.upguard.com/webscan</a></p>
<p><a href="https://www.youtube.com/watch?v=UFPGOvDrTOk" target="_blank" rel="noopener noreferrer">Getting Single Page Application Security Right by Philippe De Ryck</a></p>
</div></div></div><div class="post__footer"><div class="post-tags"><a href="/tag/javascript/" class="post-tags__link"><span>#</span> javascript
		</a></div></div></div><div class="post-comments"></div><div class="author post-author"><img alt="Author image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 180 180' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-52311ff214b737f722259e901102d6b3'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='5'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-52311ff214b737f722259e901102d6b3)' width='180' height='180' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCABAAEADASIAAhEBAxEB/8QAHAAAAQUBAQEAAAAAAAAAAAAABwEDBAUGCAAC/8QAMxAAAQMCAwcBBgYDAAAAAAAAAQIDEQAEBRIhBhMxQVFhcQciIzJCgbEIFDORodEWgsH/xAAZAQEBAQEBAQAAAAAAAAAAAAAEAwUGAAH/xAAhEQABBAMAAgMBAAAAAAAAAAABAAIDEQQSISJBBRNRMf/aAAwDAQACEQMRAD8A6Pr1fOalmvLyUAk6AnxS5VROUx4oR%2bvmPXNjZYbhti48DcKUt9LRIJAHsgkaxMmO1ByzxnG8PeQ/a3d5bOIIUVJdUOHMifvWjB8c6aMP2q0CfPbC/TW119SVz9YetmOMLYRfWWH3TaSA4pKVNrWOuhgH6UYtkNrsK2stFvYU65nbjesOpyrbnhPIjuKhPhSwDZw4qw5kU5ph6r%2blpCYFNOLKflV5o1JSXMkDlS5xy1qtDo4mfrWe2/xhWEbJ3t400%2b6oZWyGpkBRiTGoSNJj/tVbEXEN/VMyAC1iPUTaS2xjG3bO3IS3ay2HNJc1lR6xPDx3oa4g0RvVlQcSfhFRLrEF3V0LpSAh10layOMzw7eKl3jqLhxsxLaRw4610MUYiAa1ZMxMosrPugpJJ0nlwiiJ%2bH69eZ28NulfuX7R0LTOhygKB8yKxWLaWoC0BJKpgfL2rdfh8sV3G1F9iBTLNnalGbkFuEADzAVVMpwOO6/xCx4izJaAuiSsT8UV8KKyBznmKih1J714OqIiCa5jVdJsqk4ggL9oRPSqDbty4/w/GnLVzKPyypBkaEif4p5N2RwA/anlPtvsrafAW0tJStChKVA8QR0p4ZqQQil1ilz5Y5nGloXKkcNev908G8iUoSCUiiHtVhFhhdou6wu2O6JyuNg/pzwUCdY5a8JrAXtwErWi3RmIEZwZE9utaccm/QEVzKVZjVrltN4JyJMqFdGemuz7OzmyFjbBGS5eQLm6PMuLAMf6iE/SgBavuMPNOON75wKC0tr4GDPtdqO%2bxm0i8ew0O3O7RfJnett6J4mCnXhH81DNDzGK/i%2b4/wBbZSb7S1xQ2IIVBHWvb2BAIioBcVxMCml3KgYFZQZadtSzAK460hCpkk%2bBTzahmmnXnRA0APmadsj0ol1uE2T6r5SEWgbO9K%2bARGs0H7stto3luczSyS3mEKUJIBI66VrvUnGWlJZwlKsuaHnjmgafCk/f9qwD6y%2b2pbjhKU%2bylWaJ8dabjxmtne0HInolrVcYThj18w5clKzl1KOZ/sVLRtJ%2bQbQ7akpum/01oEA9c3bvULB8WtGbRYuW1vvBOVtTivm48eVUt9Z3dwpKlIbaZIhJQZEdJq7fJxDxxHcdWgxnvtFbZz1ItsQCWMWyWb8hJcn3ZV3Pyz14eK2e9WpUBJoGYHhVpmCQyCtTZBMaHz1oq7DYxvmBh11IeZT7pR%2bZA5eR9vFCyoGs8owm4sz38kK//9k=' /%3e%3c/svg%3e" width="180" data-src="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg" data-srcset="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg 180w" data-sizes="(max-width: 180px) 100vw, 180px" class="author__image g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg" class="author__image g-image g-image--loaded" width="180" alt="Author image"></noscript><!----><p class="author__intro">Hiện tại site đang nâng cấp, các bạn xài tạm</p></div></article></div></div></main><footer class="footer"><span class="footer__copyright">Copyright © 2020.</span><span class="footer__links">luckyluu</span></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Bảo mật web - Một số kiểu tấn công","path":"\u002Fbao-mat-web-mot-so-kieu-tan-cong\u002F","date":"2018-11-18","timeToRead":4,"tags":[{"id":"javascript","title":"javascript","path":"\u002Ftag\u002Fjavascript\u002F"}],"desc":"Tổng quát các vấn đề bạn cần quan tâm để bảo mật ứng dụng web","content":"\u003C!-- TOC --\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca href=\"#c%C3%A1ch-qu%E1%BA%A3n-l%C3%BD-session-hi%E1%BB%87n-t%E1%BA%A1i\"\u003ECách quản lý Session hiện tại\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"#session-qu%E1%BA%A3n-l%C3%BD-b%E1%BB%9Fi-server\"\u003ESession quản lý bởi server\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#session-qu%E1%BA%A3n-l%C3%BD-%E1%BB%9F-client\"\u003ESession quản lý ở client\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca href=\"#m%E1%BB%99t-s%E1%BB%91-ki%E1%BB%83u-t%E1%BA%A5n-c%C3%B4ng\"\u003EMột số kiểu tấn công\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca href=\"#csrf-cross-site-request-forgery\"\u003ECSRF (Cross-Site Request Forgery)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-1-s%E1%BB%AD-d%E1%BB%A5ng-html-token\"\u003ECách ngăn chặn #1: Sử dụng HTML token\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-2-origin-header\"\u003ECách ngăn chặn #2: Origin Header\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-3-d%C3%B9ng-transparent-token\"\u003ECách ngăn chặn #3: dùng transparent token\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca href=\"#cross-site-scripting-xss\"\u003ECross-Site Scripting (XSS)\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"#store-xss---l%C6%B0u-%C4%91o%E1%BA%A1n-script-%C4%91%C3%B3-l%C3%AAn-tr%C3%AAn-server\"\u003EStore XSS - lưu đoạn script đó lên trên server\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#reflect-xss\"\u003EReflect XSS\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#dom-based-xss\"\u003EDOM-Based XSS\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#c%C3%B4ng-c%E1%BB%A5-ki%E1%BB%83m-tra\"\u003ECông cụ kiểm tra\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C!-- \u002FTOC --\u003E\n\u003Ch2 id=\"cách-quản-lý-session-hiện-tại\"\u003E\u003Ca href=\"#c%C3%A1ch-qu%E1%BA%A3n-l%C3%BD-session-hi%E1%BB%87n-t%E1%BA%A1i\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECách quản lý Session hiện tại\u003C\u002Fh2\u003E\n\u003Cp\u003EHTTP = stateless\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ETất cả request từ cùng 1 client không liên quan gì với nhau\u003C\u002Fli\u003E\n\u003Cli\u003EServer không có cách nào để lưu tạm giá trị state\nHTTP hỗ trợ gửi đi dữ liệu authentication\u003C\u002Fli\u003E\n\u003Cli\u003EThông qua \u003Cstrong\u003EHeader.Authorization\u003C\u002Fstrong\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EGửi thông tin kèm theo tất cả request\u003C\u002Fli\u003E\n\u003Cli\u003EServer không can thiệp gì trên từng session\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"session-quản-lý-bởi-server\"\u003E\u003Ca href=\"#session-qu%E1%BA%A3n-l%C3%BD-b%E1%BB%9Fi-server\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESession quản lý bởi server\u003C\u002Fh3\u003E\n\u003Cp\u003EServer toàn quyền kiểm soát session, kiểm tra tình trạng active, expire, invalid date, xóa session\u003C\u002Fp\u003E\n\u003Cp\u003EĐại diện cho cách này là dùng Cookie\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EDữ liệu được truyền qua lại giữa server và client\u003C\u002Fli\u003E\n\u003Cli\u003EHầu hết các trình duyệt đều hỗ trợ, \u003Cstrong\u003Ekhó\u003C\u002Fstrong\u003E, nếu sử dụng bên ngoài trình duyệt (ứng dụng điện thoại chẳng hạn)\u003C\u002Fli\u003E\n\u003Cli\u003EBị tấn công \u003Ca href=\"#csrf-cross-site-request-forgery\"\u003ECSRF\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003ETheo mặc định các request sẽ không nên gửi kèm thông tin xác thực tài khoản (ví dụ cookie), nếu cần gửi thêm thông tin này bằng thiết đặt \u003Ccode class=\"language-text\"\u003EwithCredentials\u003C\u002Fcode\u003E thủ công, phía server đồng thời cũng gửi lại trong response header giá trị \u003Ccode class=\"language-text\"\u003EAccess-Control-Allow-Credentials: true\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"session-quản-lý-ở-client\"\u003E\u003Ca href=\"#session-qu%E1%BA%A3n-l%C3%BD-%E1%BB%9F-client\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESession quản lý ở client\u003C\u002Fh3\u003E\n\u003Cp\u003EĐưa toàn bộ thông tin session xuống phía client\nServer không kiểm soát session nào đang active\nDữ liệu session được gửi đi trên mỗi request\u003C\u002Fp\u003E\n\u003Cp\u003EĐại diện cho kiểu này là dùng Token (JWT đang là phổ biến nhất)\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EDữ liệu session được lưu xuống token, server gửi token này qua HTTP header hoặc body của response\u003C\u002Fli\u003E\n\u003Cli\u003EỨng dụng tự quản lý chuyện gửi server token này\u003C\u002Fli\u003E\n\u003Cli\u003ETrên mỗi request gửi đi nó không tự chèn token vào, do đó nó không thể tấn công bằng \u003Ca href=\"#csrf-cross-site-request-forgery\"\u003ECSRF\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EMồi ngon của tấn công \u003Ca href=\"#cross-site-scripting-xss\"\u003EXSS\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"một-số-kiểu-tấn-công\"\u003E\u003Ca href=\"#m%E1%BB%99t-s%E1%BB%91-ki%E1%BB%83u-t%E1%BA%A5n-c%C3%B4ng\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EMột số kiểu tấn công\u003C\u002Fh2\u003E\n\u003Ch3 id=\"csrf-cross-site-request-forgery\"\u003E\u003Ca href=\"#csrf-cross-site-request-forgery\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECSRF (Cross-Site Request Forgery)\u003C\u002Fh3\u003E\n\u003Cp\u003EKiểu tấn công rất phổ biến, nếu thông tin session được gửi qua Cookie. Đại khái là nếu bạn đăng nhập vào facebook.com, sau đó truy cập vào trang web nào đó bị hack rồi, trang bị hack này sẽ gửi một trang có nội dung html bên trong đó nó dùng một thẻ nào đó (như \u003Ccode class=\"language-text\"\u003E&lt;img \u002F&gt;\u003C\u002Fcode\u003E, \u003Ccode class=\"language-text\"\u003E&lt;iframe\u002F&gt;\u003C\u002Fcode\u003E, \u003Ccode class=\"language-text\"\u003E&lt;link\u002F&gt;\u003C\u002Fcode\u003E, \u003Ccode class=\"language-text\"\u003E&lt;bgsound\u002F&gt;\u003C\u002Fcode\u003E, \u003Ccode class=\"language-text\"\u003E&lt;background \u002F&gt;\u003C\u002Fcode\u003E) để gửi một request thay đổi email lên trang facebook.com\u003C\u002Fp\u003E\n\u003Cpre class=\"language-html\"\u003E\u003Ccode class=\"language-html\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Eiframe\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eheight\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E0\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ewidth\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E0\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Efacebook.com\u002Fapi\u002F1\u002Fdestroy\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Elink\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eref\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Estylesheet\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ehref\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Efacebook.com\u002Fapi\u002F1\u002Fdestroy\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Etype\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Etext\u002Fcss\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u002F\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Ebgsound\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Efacebook.com\u002Fapi\u002F1\u002Fdestroy\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u002F\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Ebackground\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Efacebook.com\u002Fapi\u002F1\u002Fdestroy\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u002F\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Eimg\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eheight\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E0\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ewidth\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E0\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Esrc\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Efacebook.com\u002Fapi\u002F1\u002Fdestroy\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u002F\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.imgur.com\u002FsRrzge5.png\" alt=\"CSRF (Cross-Site Request Forgery)\"\u003E\u003C\u002Fp\u003E\n\u003Ch4 id=\"cách-ngăn-chặn-1-sử-dụng-html-token\"\u003E\u003Ca href=\"#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-1-s%E1%BB%AD-d%E1%BB%A5ng-html-token\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECách ngăn chặn #1: Sử dụng HTML token\u003C\u002Fh4\u003E\n\u003Cp\u003EDấu token bên trong HTML, ví dụ như nhét nó trong form, server khi nhận được sẽ kiểm tra lại để chắc chắn là token này hợp lệ \u003C\u002Fp\u003E\n\u003Cpre class=\"language-html\"\u003E\u003Ccode class=\"language-html\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Eform\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Eaction\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003Esubmit.php\u003Cspan class=\"token punctuation\"\u003E\"\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u003C\u002Fspan\u003Einput\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Etype\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E'\u003C\u002Fspan\u003Ehidden\u003Cspan class=\"token punctuation\"\u003E'\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Ename\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E'\u003C\u002Fspan\u003ECSRFToken\u003Cspan class=\"token punctuation\"\u003E'\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token attr-name\"\u003Evalue\u003C\u002Fspan\u003E\u003Cspan class=\"token attr-value\"\u003E\u003Cspan class=\"token punctuation attr-equals\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E'\u003C\u002Fspan\u003EOWY4NmQwODE4ODRjN2Q2NTlhMmZlYWEwYzU1YWQwMTVhM2JmNGYxYjJiMGI4MjJjZDE1ZDZMGYwMGEwOA==\u003Cspan class=\"token punctuation\"\u003E'\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E\u002F\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token tag\"\u003E\u003Cspan class=\"token punctuation\"\u003E&lt;\u002F\u003C\u002Fspan\u003Eform\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ETuy nhiên cách này sẽ không thích hợp với SPA, vì yêu cầu phía server phải quản lý session của từng user đang login\u003C\u002Fp\u003E\n\u003Ch4 id=\"cách-ngăn-chặn-2-origin-header\"\u003E\u003Ca href=\"#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-2-origin-header\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECách ngăn chặn #2: Origin Header\u003C\u002Fh4\u003E\n\u003Cp\u003EVới những request như POST\u002FPUT\u002FDELETE, tự động thêm Origin Header để xác thực yêu cầu\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.stack.imgur.com\u002Fymk6L.png\" alt=\"Cách ngăn chặn #2: Origin Header\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.imgur.com\u002FwXzd41T.jpg\" alt=\"Cách ngăn chặn #2: Origin Header\"\u003E\u003C\u002Fp\u003E\n\u003Ch4 id=\"cách-ngăn-chặn-3-dùng-transparent-token\"\u003E\u003Ca href=\"#c%C3%A1ch-ng%C4%83n-ch%E1%BA%B7n-3-d%C3%B9ng-transparent-token\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECách ngăn chặn #3: dùng transparent token\u003C\u002Fh4\u003E\n\u003Cp\u003ESo sánh giá trị cookie với giá trị header\u003C\u002Fp\u003E\n\u003Cp\u003EUser gửi đi một request, nó nhận được 1 Session Cookie và 1 CSRF Token Cookie.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003ESet-Cookie: session=...\nSet-Cookie: CSRF-Token=123\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EKhi ứng dụng gửi đi một request, javascript sẽ copy cookie và đưa vào header \u003Ccode class=\"language-text\"\u003EX-CSRF-Token\u003C\u002Fcode\u003E chỉ javascript trên trang hiện tại mới truy xuất được thông tin này\u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003ECookie: session=...\nCookie: CSRF-Token=123\nX-CSRF-Token: 123\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EServer đơn giản là kiểm tra 2 giá trị \u003Ccode class=\"language-text\"\u003ECookie: CSRF-Token\u003C\u002Fcode\u003E và \u003Ccode class=\"language-text\"\u003EX-CSRF-Token\u003C\u002Fcode\u003E có khớp không\u003C\u002Fp\u003E\n\u003Ch3 id=\"cross-site-scripting-xss\"\u003E\u003Ca href=\"#cross-site-scripting-xss\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECross-Site Scripting (XSS)\u003C\u002Fh3\u003E\n\u003Cp\u003EHacker sẽ tìm cách để chạy javascript trên trang trình duyệt của user, khi user truy cập vào một trang đã bị hack. Hacker sẽ dùng những cách sau\u003C\u002Fp\u003E\n\u003Ch4 id=\"store-xss---lưu-đoạn-script-đó-lên-trên-server\"\u003E\u003Ca href=\"#store-xss---l%C6%B0u-%C4%91o%E1%BA%A1n-script-%C4%91%C3%B3-l%C3%AAn-tr%C3%AAn-server\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EStore XSS - lưu đoạn script đó lên trên server\u003C\u002Fh4\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.imgur.com\u002F45lHKy2.jpg\" alt=\"Cross-Site Scripting (XSS)\"\u003E\u003C\u002Fp\u003E\n\u003Ch4 id=\"reflect-xss\"\u003E\u003Ca href=\"#reflect-xss\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EReflect XSS\u003C\u002Fh4\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.imgur.com\u002FdbRVLC5.jpg\" alt=\"Reflect XSS\"\u003E\u003C\u002Fp\u003E\n\u003Ch4 id=\"dom-based-xss\"\u003E\u003Ca href=\"#dom-based-xss\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EDOM-Based XSS\u003C\u002Fh4\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.imgur.com\u002F29G28Ee.jpg\" alt=\"Reflect XSS\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ECách phổ biến để phòng chống\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EFilter hết mấy đoạn html nguy hiểm (như &#x3C; \u003E, \" \", &#x26;) trước khi lưu\u003C\u002Fli\u003E\n\u003Cli\u003EDùng thư viện để escape context-sensitive trước khi output\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"công-cụ-kiểm-tra\"\u003E\u003Ca href=\"#c%C3%B4ng-c%E1%BB%A5-ki%E1%BB%83m-tra\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECông cụ kiểm tra\u003C\u002Fh2\u003E\n\u003Cp\u003EMột số trang online để check\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fsecurityheaders.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fsecurityheaders.com\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fsitecheck.sucuri.net\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fsitecheck.sucuri.net\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.ssllabs.com\u002Fssltest\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fwww.ssllabs.com\u002Fssltest\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fquttera.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fquttera.com\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fdetectify.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fdetectify.com\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fapp.webinspector.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fapp.webinspector.com\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fapp.upguard.com\u002Fwebscan\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fapp.upguard.com\u002Fwebscan\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=UFPGOvDrTOk\" target=\"_blank\" rel=\"noopener noreferrer\"\u003EGetting Single Page Application Security Right by Philippe De Ryck\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n","cover_image":""}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.88e72233.js" defer></script><script src="/assets/js/page--src-templates-post-vue.0d21aba4.js" defer></script>
  </body>
</html>