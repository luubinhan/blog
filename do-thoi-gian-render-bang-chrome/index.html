<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Đo thời gian render bằng Chrome - VuiLapTrinh.com</title><meta name="gridsome:hash" content="0395a9475e6dcec202a1209b8bd40b74ee081359"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.21"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Tutorials, Blog, Hướng dẫn, chia sẽ kinh nghiệm về Frontend, react, vue, ux, ui"><meta data-vue-tag="ssr" name="desc" content="Bàn luận kỹ thuật để đo chính xác thời gian render"><link rel="preload" href="/assets/css/0.styles.4e7b3092.css" as="style"><link rel="preload" href="/assets/js/app.88e72233.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.0d21aba4.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.204466f8.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.0b0d171f.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.854eb99f.js"><link rel="stylesheet" href="/assets/css/0.styles.4e7b3092.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <script>
      // Add dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
      (function() {
        window.__onThemeChange = function() {};
        function setTheme(newTheme) {
          window.__theme = newTheme;
          preferredTheme = newTheme;
          document.body.setAttribute('data-theme', newTheme);
          window.__onThemeChange(newTheme);
        }

        var preferredTheme;
        try {
          preferredTheme = localStorage.getItem('theme');
        } catch (err) { }

        window.__setPreferredTheme = function(newTheme) {
          setTheme(newTheme);
          try {
            localStorage.setItem('theme', newTheme);
          } catch (err) {}
        }

        var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
        darkQuery.addListener(function(e) {
          window.__setPreferredTheme(e.matches ? 'dark' : 'light')
        });

        setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
      })();
    </script>

    <div id="app" data-server-rendered="true" class="layout-blog"><header class="header"><div class="header__left"><a href="/" class="logo active"><span class="logo__text">
    ← VuiLapTrinh.com
  </span></a></div><div class="header__right"><button role="button" aria-label="Toggle dark/light" class="toggle-theme"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button></div></header><main class="main"><div class="single-post"><div class="single-post-container"><article><header><div class="post-title"><h1 class="post-title__text single-post-title">Đo thời gian render bằng Chrome</h1><div class="post-meta">
  Đăng ngày 2018-10-23.
  
    Mất khoảng
    <strong>1 phút</strong> để đọc.
  </div></div></header><div class="post content-box"><div class="post__header"><!----></div><div className="blog-post"><div class="post-content"><div class="post__content"><p>Để thực hành bài này, bạn có thể sử dụng <a href="https://github.com/nolanlawson/measure-style-and-layout" target="_blank" rel="nofollow noopener noreferrer">source code có sẵn</a> này</p>
<p>Trên tab Performance của DevTools chúng ta có</p>
<p><img src="https://github.com/nolanlawson/measure-style-and-layout" alt="Đo thời gian render bằng Chrome"></p>
<p>Đây là giá trị CPU đã tiêu tốn để render component, theo đơn vị là mili giây. Nó sẽ được thực hiện 4 bước</p>
<ul>
<li>Thực thi javascript</li>
<li>Apply các format bằng CSS</li>
<li>Tính layout, trình duyệt tiếp tục tính toán để "đặt" các element trên màn hình ở chỗ nào</li>
<li>Render được thực hiện trên một <a href="https://blogs.windows.com/msedgedev/2017/08/17/making-web-smoother-independent-rendering/" target="_blank" rel="nofollow noopener noreferrer">thread riêng</a></li>
</ul>
<p>Đa phần mọi người sẽ bỏ qua các bước 2, 3, 4 khi đo, chỉ tính toán thời gian thực thi javascript</p>
<p><img src="https://nolanwlawson.files.wordpress.com/2018/09/screenshot-2018-09-22-11-45-56-3-copy.png?w=570&#x26;h=254" alt="Đo thời gian render bằng Chrome"></p>
<p>Bước render rất khó có thể đo được chính xác, nó được thực hiện trên threat riêng và dùng GPU</p>
<p>Phần style và layout thì có thể đo chính xác hơn vì nó block lại main thread</p>
<h1 id="đo-gì"><a href="#%C4%91o-g%C3%AC" aria-hidden="true"><span class="icon icon-link"></span></a>Đo gì?</h1>
<p>Chúng ta sẽ <a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance/mark" target="_blank" rel="nofollow noopener noreferrer">đánh dấu</a> từ khi javascript bắt đầu chạy, đến hết phần render</p>
<p>Sử dụng <code class="language-text">requestAnimationFrame</code> là chính, nó được gọi trước quá trình style và layout, nhưng thực tế trước Edge v18 và một số bản Safari thì không đúng, nên cũng có thể có chút sai xót</p>
<p><img src="https://nolanwlawson.files.wordpress.com/2018/09/screenshot-2018-09-22-11-45-56-3.png?w=570&#x26;h=254" alt="Đo thời gian render bằng Chrome"></p>
<pre class="language-js"><code class="language-js"><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token dom variable">performance</span><span class="token punctuation">.</span><span class="token method function property-access">mark</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>Phần code trong <code class="language-text">setTimeOut</code> được gọi ngay sau bước paint</p>
<p><img src="https://nolanwlawson.files.wordpress.com/2018/09/screenshot-2018-09-22-12-15-07.png?w=570&#x26;h=343" alt="Đo thời gian render bằng Chrome"></p>
<p><img src="https://i.imgur.com/Pwa9tV8.png" alt="Đo thời gian render bằng Chrome"></p>
<h1 id="một-số-vấn-đề"><a href="#m%E1%BB%99t-s%E1%BB%91-v%E1%BA%A5n-%C4%91%E1%BB%81" aria-hidden="true"><span class="icon icon-link"></span></a>Một số vấn đề</h1>
<ul>
<li><code class="language-text">setTimeOut</code> đôi khi có sai lệch tầm 4ms trên một số trình duyệt</li>
<li>Nếu có một <code class="language-text">setTimeOut</code> callback khác trong code, có thể không còn đúng</li>
<li>Sau này khi các trình duyệt đã hỗ trợ cách tốt hơn thì setTimeOut kiểu này là dư thừa</li>
</ul>
<p><a target="_blank" rel="noopener noreferrer" href="https://nolanlawson.com/2018/09/25/accurately-measuring-layout-on-the-web/">Accurately measuring layout on the web</a></p>
</div></div></div><div class="post__footer"><div class="post-tags"><a href="/tag/chrome/" class="post-tags__link"><span>#</span> chrome
		</a><a href="/tag/performance/" class="post-tags__link"><span>#</span> performance
		</a></div></div></div><div class="post-comments"></div><div class="author post-author"><img alt="Author image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 180 180' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-52311ff214b737f722259e901102d6b3'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='5'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-52311ff214b737f722259e901102d6b3)' width='180' height='180' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCABAAEADASIAAhEBAxEB/8QAHAAAAQUBAQEAAAAAAAAAAAAABwEDBAUGCAAC/8QAMxAAAQMCAwcBBgYDAAAAAAAAAQIDEQAEBRIhBhMxQVFhcQciIzJCgbEIFDORodEWgsH/xAAZAQEBAQEBAQAAAAAAAAAAAAAEAwUGAAH/xAAhEQABBAMAAgMBAAAAAAAAAAABAAIDEQQSISJBBRNRMf/aAAwDAQACEQMRAD8A6Pr1fOalmvLyUAk6AnxS5VROUx4oR%2bvmPXNjZYbhti48DcKUt9LRIJAHsgkaxMmO1ByzxnG8PeQ/a3d5bOIIUVJdUOHMifvWjB8c6aMP2q0CfPbC/TW119SVz9YetmOMLYRfWWH3TaSA4pKVNrWOuhgH6UYtkNrsK2stFvYU65nbjesOpyrbnhPIjuKhPhSwDZw4qw5kU5ph6r%2blpCYFNOLKflV5o1JSXMkDlS5xy1qtDo4mfrWe2/xhWEbJ3t400%2b6oZWyGpkBRiTGoSNJj/tVbEXEN/VMyAC1iPUTaS2xjG3bO3IS3ay2HNJc1lR6xPDx3oa4g0RvVlQcSfhFRLrEF3V0LpSAh10layOMzw7eKl3jqLhxsxLaRw4610MUYiAa1ZMxMosrPugpJJ0nlwiiJ%2bH69eZ28NulfuX7R0LTOhygKB8yKxWLaWoC0BJKpgfL2rdfh8sV3G1F9iBTLNnalGbkFuEADzAVVMpwOO6/xCx4izJaAuiSsT8UV8KKyBznmKih1J714OqIiCa5jVdJsqk4ggL9oRPSqDbty4/w/GnLVzKPyypBkaEif4p5N2RwA/anlPtvsrafAW0tJStChKVA8QR0p4ZqQQil1ilz5Y5nGloXKkcNev908G8iUoSCUiiHtVhFhhdou6wu2O6JyuNg/pzwUCdY5a8JrAXtwErWi3RmIEZwZE9utaccm/QEVzKVZjVrltN4JyJMqFdGemuz7OzmyFjbBGS5eQLm6PMuLAMf6iE/SgBavuMPNOON75wKC0tr4GDPtdqO%2bxm0i8ew0O3O7RfJnett6J4mCnXhH81DNDzGK/i%2b4/wBbZSb7S1xQ2IIVBHWvb2BAIioBcVxMCml3KgYFZQZadtSzAK460hCpkk%2bBTzahmmnXnRA0APmadsj0ol1uE2T6r5SEWgbO9K%2bARGs0H7stto3luczSyS3mEKUJIBI66VrvUnGWlJZwlKsuaHnjmgafCk/f9qwD6y%2b2pbjhKU%2bylWaJ8dabjxmtne0HInolrVcYThj18w5clKzl1KOZ/sVLRtJ%2bQbQ7akpum/01oEA9c3bvULB8WtGbRYuW1vvBOVtTivm48eVUt9Z3dwpKlIbaZIhJQZEdJq7fJxDxxHcdWgxnvtFbZz1ItsQCWMWyWb8hJcn3ZV3Pyz14eK2e9WpUBJoGYHhVpmCQyCtTZBMaHz1oq7DYxvmBh11IeZT7pR%2bZA5eR9vFCyoGs8owm4sz38kK//9k=' /%3e%3c/svg%3e" width="180" data-src="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg" data-srcset="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg 180w" data-sizes="(max-width: 180px) 100vw, 180px" class="author__image g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg" class="author__image g-image g-image--loaded" width="180" alt="Author image"></noscript><!----><p class="author__intro">Hiện tại site đang nâng cấp, các bạn xài tạm</p></div></article></div></div></main><footer class="footer"><span class="footer__copyright">Copyright © 2020.</span><span class="footer__links">luckyluu</span></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Đo thời gian render bằng Chrome","path":"\u002Fdo-thoi-gian-render-bang-chrome\u002F","date":"2018-10-23","timeToRead":1,"tags":[{"id":"chrome","title":"chrome","path":"\u002Ftag\u002Fchrome\u002F"},{"id":"performance","title":"performance","path":"\u002Ftag\u002Fperformance\u002F"}],"desc":"Bàn luận kỹ thuật để đo chính xác thời gian render","content":"\u003Cp\u003EĐể thực hành bài này, bạn có thể sử dụng \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fnolanlawson\u002Fmeasure-style-and-layout\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Esource code có sẵn\u003C\u002Fa\u003E này\u003C\u002Fp\u003E\n\u003Cp\u003ETrên tab Performance của DevTools chúng ta có\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fgithub.com\u002Fnolanlawson\u002Fmeasure-style-and-layout\" alt=\"Đo thời gian render bằng Chrome\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EĐây là giá trị CPU đã tiêu tốn để render component, theo đơn vị là mili giây. Nó sẽ được thực hiện 4 bước\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EThực thi javascript\u003C\u002Fli\u003E\n\u003Cli\u003EApply các format bằng CSS\u003C\u002Fli\u003E\n\u003Cli\u003ETính layout, trình duyệt tiếp tục tính toán để \"đặt\" các element trên màn hình ở chỗ nào\u003C\u002Fli\u003E\n\u003Cli\u003ERender được thực hiện trên một \u003Ca href=\"https:\u002F\u002Fblogs.windows.com\u002Fmsedgedev\u002F2017\u002F08\u002F17\u002Fmaking-web-smoother-independent-rendering\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ethread riêng\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EĐa phần mọi người sẽ bỏ qua các bước 2, 3, 4 khi đo, chỉ tính toán thời gian thực thi javascript\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fnolanwlawson.files.wordpress.com\u002F2018\u002F09\u002Fscreenshot-2018-09-22-11-45-56-3-copy.png?w=570&#x26;h=254\" alt=\"Đo thời gian render bằng Chrome\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EBước render rất khó có thể đo được chính xác, nó được thực hiện trên threat riêng và dùng GPU\u003C\u002Fp\u003E\n\u003Cp\u003EPhần style và layout thì có thể đo chính xác hơn vì nó block lại main thread\u003C\u002Fp\u003E\n\u003Ch1 id=\"đo-gì\"\u003E\u003Ca href=\"#%C4%91o-g%C3%AC\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EĐo gì?\u003C\u002Fh1\u003E\n\u003Cp\u003EChúng ta sẽ \u003Ca href=\"https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FAPI\u002FPerformance\u002Fmark\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eđánh dấu\u003C\u002Fa\u003E từ khi javascript bắt đầu chạy, đến hết phần render\u003C\u002Fp\u003E\n\u003Cp\u003ESử dụng \u003Ccode class=\"language-text\"\u003ErequestAnimationFrame\u003C\u002Fcode\u003E là chính, nó được gọi trước quá trình style và layout, nhưng thực tế trước Edge v18 và một số bản Safari thì không đúng, nên cũng có thể có chút sai xót\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fnolanwlawson.files.wordpress.com\u002F2018\u002F09\u002Fscreenshot-2018-09-22-11-45-56-3.png?w=570&#x26;h=254\" alt=\"Đo thời gian render bằng Chrome\"\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-js\"\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token function\"\u003ErequestAnimationFrame\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token arrow operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token function\"\u003EsetTimeout\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token arrow operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token dom variable\"\u003Eperformance\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Emark\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'end'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EPhần code trong \u003Ccode class=\"language-text\"\u003EsetTimeOut\u003C\u002Fcode\u003E được gọi ngay sau bước paint\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fnolanwlawson.files.wordpress.com\u002F2018\u002F09\u002Fscreenshot-2018-09-22-12-15-07.png?w=570&#x26;h=343\" alt=\"Đo thời gian render bằng Chrome\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.imgur.com\u002FPwa9tV8.png\" alt=\"Đo thời gian render bằng Chrome\"\u003E\u003C\u002Fp\u003E\n\u003Ch1 id=\"một-số-vấn-đề\"\u003E\u003Ca href=\"#m%E1%BB%99t-s%E1%BB%91-v%E1%BA%A5n-%C4%91%E1%BB%81\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EMột số vấn đề\u003C\u002Fh1\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode class=\"language-text\"\u003EsetTimeOut\u003C\u002Fcode\u003E đôi khi có sai lệch tầm 4ms trên một số trình duyệt\u003C\u002Fli\u003E\n\u003Cli\u003ENếu có một \u003Ccode class=\"language-text\"\u003EsetTimeOut\u003C\u002Fcode\u003E callback khác trong code, có thể không còn đúng\u003C\u002Fli\u003E\n\u003Cli\u003ESau này khi các trình duyệt đã hỗ trợ cách tốt hơn thì setTimeOut kiểu này là dư thừa\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"https:\u002F\u002Fnolanlawson.com\u002F2018\u002F09\u002F25\u002Faccurately-measuring-layout-on-the-web\u002F\"\u003EAccurately measuring layout on the web\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n","cover_image":""}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.88e72233.js" defer></script><script src="/assets/js/page--src-templates-post-vue.0d21aba4.js" defer></script>
  </body>
</html>