<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Vì sao quần hùng kéo nhau không xài moment.js nữa - VuiLapTrinh.com</title><meta name="gridsome:hash" content="5ee00dc0b71878963f9b5fb39ff7b4fecc0fc2a1"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.21"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Tutorials, Blog, Hướng dẫn, chia sẽ kinh nghiệm về Frontend, react, vue, ux, ui"><meta data-vue-tag="ssr" name="desc" content="Tất cả chúng ta đã từng và đang sử dụng moment.js mà ko hề dành chút thời gian để xem nó ảnh hưởng như thế nào đến performance"><link rel="preload" href="/assets/css/0.styles.8be83eab.css" as="style"><link rel="preload" href="/assets/js/app.46edf9ee.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.d170cb20.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.a46e8bb1.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.d7acbf4e.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.94dc72c0.js"><link rel="stylesheet" href="/assets/css/0.styles.8be83eab.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div id="fb-root"></div>
    <script
      async
      defer
      crossorigin="anonymous"
      src="https://connect.facebook.net/vi_VN/sdk.js#xfbml=1&version=v8.0&appId=445556375516928&autoLogAppEvents=1"
      nonce="NM6X5rUi"
    ></script>
    <script>
      // Add dark / light detection that runs before Vue.js load. Borrowed from overreacted.io
      (function() {
        window.__onThemeChange = function() {};
        function setTheme(newTheme) {
          window.__theme = newTheme;
          preferredTheme = newTheme;
          document.body.setAttribute("data-theme", newTheme);
          window.__onThemeChange(newTheme);
        }

        var preferredTheme;
        try {
          preferredTheme = localStorage.getItem("theme");
        } catch (err) {}

        window.__setPreferredTheme = function(newTheme) {
          setTheme(newTheme);
          try {
            localStorage.setItem("theme", newTheme);
          } catch (err) {}
        };

        var darkQuery = window.matchMedia("(prefers-color-scheme: dark)");
        darkQuery.addListener(function(e) {
          window.__setPreferredTheme(e.matches ? "dark" : "light");
        });

        setTheme(preferredTheme || (darkQuery.matches ? "dark" : "light"));
      })();
    </script>

    <div id="app" data-server-rendered="true" class="layout-blog"><div class="sidebar" data-v-d28e11ae><div class="sidebar__inner" data-v-d28e11ae><a href="/" class="go-home active" data-v-d28e11ae>VuiLapTrinh.com</a><div class="navigation-component" data-v-d28e11ae><ul class="nav primary-menu" data-v-d28e11ae><li class="javascript" data-v-d28e11ae><a href="/tag/javascript" aria-label="Kiến thức Javascript" title="Kiến thức Javascript" target="" data-v-d28e11ae><span class="primary-menu__icon" data-v-d28e11ae><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" data-v-d28e11ae><path d="M255.908 485.999c-6.116 0-12.323-1.642-17.708-4.746l-56.319-33.316c-8.397-4.747-4.29-6.389-1.551-7.303 11.226-3.925 13.508-4.745 25.465-11.592 1.279-.729 2.922-.457 4.199.366l43.266 25.648c1.552.912 3.741.912 5.202 0l168.592-97.304c1.553-.913 2.555-2.738 2.555-4.563V158.583c0-1.917-1.002-3.651-2.645-4.654L258.463 56.716c-1.551-.913-3.65-.913-5.202 0L84.852 154.019c-1.644.913-2.647 2.738-2.647 4.655v194.515c0 1.825 1.003 3.65 2.647 4.473l46.188 26.653c25.102 12.504 40.436-2.191 40.436-17.068V175.195c0-2.738 2.19-4.837 4.93-4.837h21.359c2.647 0 4.928 2.099 4.928 4.837v192.143c0 33.407-18.256 52.576-49.928 52.576-9.768 0-17.435 0-38.794-10.588l-44.179-25.467c-10.954-6.299-17.708-18.074-17.708-30.76V158.583c0-12.596 6.754-24.462 17.708-30.76L238.2 30.519c10.679-6.024 24.828-6.024 35.416 0l168.594 97.394c10.953 6.298 17.707 18.073 17.707 30.761v194.515c0 12.596-6.754 24.371-17.707 30.761l-168.594 97.303a35.5 35.5 0 01-17.708 4.746zm136.098-191.775c0-36.421-24.646-46.096-76.4-52.941-52.396-6.938-57.689-10.498-57.689-22.729 0-10.131 4.473-23.641 43.266-23.641 34.596 0 47.375 7.485 52.668 30.853.457 2.19 2.467 3.833 4.746 3.833h21.91c1.367 0 2.645-.547 3.559-1.552.914-1.003 1.369-2.373 1.275-3.743-3.375-40.252-30.121-58.965-84.158-58.965-48.103 0-76.764 20.264-76.764 54.311 0 36.876 28.569 47.101 74.664 51.662 55.225 5.387 59.514 13.511 59.514 24.373 0 18.805-15.15 26.835-50.658 26.835-44.635 0-54.403-11.227-57.689-33.406-.365-2.373-2.374-4.107-4.837-4.107h-21.817a4.81 4.81 0 00-4.836 4.836c0 28.39 15.426 62.254 89.271 62.254 53.305-.092 83.975-21.181 83.975-57.873z" fill="#539e43" data-v-d28e11ae></path></svg></span><!----><!----><!----><!----><!----><span class="primary-menu__label" data-v-d28e11ae>Javascript</span></a></li><li class="react" data-v-d28e11ae><a href="/tag/react" aria-label="Kiến thức React" title="Kiến thức React" target="" data-v-d28e11ae><!----><span class="primary-menu__icon" data-v-d28e11ae><svg id="Layer_2" version="1.1" viewBox="0 0 600 600" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" data-v-d28e11ae><circle cx="299.5" cy="299.6" r="50.2" class="st0" data-v-d28e11ae></circle><path d="M299.5 414.6c-70.5 0-132.1-8.3-178.2-24.1-29.9-10.2-55.3-23.8-73.4-39.3-19.2-16.4-29.4-34.3-29.4-51.6 0-33.2 36.4-65.7 97.5-86.9 50-17.4 115.2-27.1 183.4-27.1 67 0 131.3 9.4 181 26.6 29.1 10 53.6 23 71 37.4 18.9 15.8 28.9 33.1 28.9 50 0 34.5-40.7 69.4-106.3 91.1-46.4 15.4-108.4 23.9-174.5 23.9zm0-205c-64.7 0-128.7 9.4-175.5 25.7-56.2 19.6-81.4 46.4-81.4 64.3 0 18.6 27.1 47.9 86.5 68.2 43.6 14.9 102.6 22.8 170.4 22.8 63.6 0 122.9-8 167-22.7 61.7-20.5 89.9-49.8 89.9-68.3 0-9.5-7.2-20.7-20.3-31.6-15.1-12.6-37.1-24.1-63.4-33.2-47.3-16.2-108.8-25.2-173.2-25.2z" class="st0" data-v-d28e11ae></path><path d="M185.6 549.8c-10.2 0-19.2-2.2-26.8-6.6-28.7-16.6-38.7-64.4-26.6-127.9 9.9-52.1 34.1-113.3 68.2-172.4 33.5-58 73.7-109 113.4-143.5 23.2-20.2 46.7-35 67.9-42.8 23.1-8.5 43.1-8.5 57.7-.1 29.9 17.2 39.8 70 25.8 137.6-9.9 48-33.5 105.9-66.5 163.2-35.2 61-73.2 110.2-109.9 142.3-23.8 20.8-48.3 36-70.7 43.9-11.7 4.2-22.7 6.3-32.5 6.3zm25.1-300.9l10.4 6c-32.3 56-56.2 116.1-65.4 164.9-11.1 58.5-.4 93.7 15 102.6 3.8 2.2 8.8 3.4 14.9 3.4 19.9 0 51.2-12.6 87.4-44.2 34.7-30.3 71-77.5 104.9-136.2 31.8-55.1 54.4-110.5 63.8-156 13.1-63.7 1.8-102.7-14.3-112-8.2-4.7-21.5-4.1-37.5 1.8-18.5 6.8-39.4 20.1-60.4 38.4-37.7 32.8-76.2 81.6-108.4 137.4l-10.4-6.1z" class="st0" data-v-d28e11ae></path><path d="M413.4 550.1c-27.2 0-61.7-16.4-97.7-47.4-40.2-34.6-81.1-86.1-115.3-145.2-33.6-58-57.6-118.3-67.7-170-5.9-30.2-7-57.9-3.2-80.2 4.2-24.3 14.1-41.6 28.8-50.1 29.8-17.3 80.5.5 132.1 46.4 36.6 32.5 75 81.9 108.1 139.1 35.3 61 59 118.5 68.4 166.3 6.1 31 7.1 59.8 2.8 83.2-4.6 24.9-15 42.6-30 51.3-7.5 4.4-16.4 6.6-26.3 6.6zM221.2 345.5c32.4 56 72.6 106.7 110.2 139 45.1 38.8 80.9 47.2 96.4 38.2 16.1-9.3 27.9-47.4 15.7-109-9-45.2-31.7-100.2-65.7-158.9-31.9-55.1-68.6-102.4-103.3-133.2-48.6-43.2-88-52.9-104.1-43.6-8.2 4.7-14.3 16.6-17.2 33.4-3.3 19.4-2.3 44.2 3.1 71.5 9.6 49.1 32.6 106.8 64.9 162.6z" class="st0" data-v-d28e11ae></path></svg></span><!----><!----><!----><!----><span class="primary-menu__label" data-v-d28e11ae>React</span></a></li><li class="reactNative" data-v-d28e11ae><a href="/tag/react-native" aria-label="Kiến thức React native" title="Kiến thức React native" target="" data-v-d28e11ae><!----><!----><span class="primary-menu__icon" data-v-d28e11ae><svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" data-v-d28e11ae><defs data-v-d28e11ae></defs><g id="phone" data-v-d28e11ae><path d="M47 2H17a5 5 0 00-5 5v50a5 5 0 005 5h30a5 5 0 005-5V7a5 5 0 00-5-5zM27 26a2.5 2.5 0 11-2.5 2.5A2.5 2.5 0 0127 26zm1 13a2 2 0 01-1.33-.5 2 2 0 01-.16-2.83L32 29.49l2.51-2.82a2 2 0 113 2.66L32 35.51l-2.51 2.82A2 2 0 0128 39zm8.5 0a2.5 2.5 0 112.5-2.5 2.5 2.5 0 01-2.5 2.5z" class="cls-1" data-v-d28e11ae></path><path d="M52 7v50a5 5 0 01-5 5H32V2h15a5 5 0 015 5z" class="cls-2" data-v-d28e11ae></path><path fill="#fff200" d="M14 10h36v44H14z" data-v-d28e11ae></path><path d="M27 26a2.5 2.5 0 102.5 2.5A2.5 2.5 0 0027 26zm9.5 8a2.5 2.5 0 102.5 2.5 2.5 2.5 0 00-2.5-2.5zm.83-7.5a2 2 0 00-2.82.17L32 29.49l-5.49 6.18a2 2 0 00.16 2.83A2 2 0 0028 39a2 2 0 001.49-.67L32 35.51l5.49-6.18a2 2 0 00-.16-2.83z" class="cls-1" data-v-d28e11ae></path><path fill="#ffbe00" d="M32 10h18v44H32z" data-v-d28e11ae></path><path d="M37.33 26.5a2 2 0 00-2.82.17L32 29.49v6l5.49-6.18a2 2 0 00-.16-2.81z" class="cls-2" data-v-d28e11ae></path><circle cx="36.5" cy="36.5" r="2.5" class="cls-2" data-v-d28e11ae></circle></g></svg></span><!----><!----><!----><span class="primary-menu__label" data-v-d28e11ae>React native</span></a></li><li class="vue" data-v-d28e11ae><a href="/tag/vuejs" aria-label="Kiến thức Vue" title="Kiến thức Vue" target="" data-v-d28e11ae><!----><!----><!----><!----><span class="primary-menu__icon" data-v-d28e11ae><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" data-v-d28e11ae><path fill="#41b883" d="M392.46 59.011H313.5l-57.499 90.972-49.285-90.972H26.001l230 393.978L485.999 59.011z" data-v-d28e11ae></path><path fill="#35495e" d="M83.192 91.867h55.241l117.568 203.511L373.464 91.867h55.241l-172.704 295.92L83.192 91.867z" data-v-d28e11ae></path></svg></span><!----><span class="primary-menu__label" data-v-d28e11ae>Vue</span></a></li><li class="htmlCss" data-v-d28e11ae><a href="/tag/css" aria-label="Kiến thức HTML/CSS" title="Kiến thức HTML/CSS" target="" data-v-d28e11ae><!----><!----><!----><span class="primary-menu__icon" data-v-d28e11ae><svg version="1.0" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" data-v-d28e11ae><path fill="#E44D26" d="M27.377 28.889L16.001 32 4.625 28.889 2 0h28.002z" data-v-d28e11ae></path><path fill="#FF6C39" d="M16 2v27.75l9.232-2.742L27.688 2z" data-v-d28e11ae></path><path fill="#FFF" d="M24.363 6H7.607L8 10l.619 7h10.884l-.355 3.984L16 21.99l-3.143-1.006L12.648 19H8.803l.459 4.987L16 25.99l6.728-2.004.99-10.986H12.252l-.25-3H24z" data-v-d28e11ae></path></svg></span><!----><!----><span class="primary-menu__label" data-v-d28e11ae>HTML/CSS</span></a></li><li class="uxUi" data-v-d28e11ae><a href="/tag/ux-ui" aria-label="Kiến thức UX/UI" title="Kiến thức UX/UI" target="" data-v-d28e11ae><!----><!----><!----><!----><!----><span class="primary-menu__icon" data-v-d28e11ae><svg viewBox="0 0 512 454.633" xmlns="http://www.w3.org/2000/svg" data-v-d28e11ae><path d="M202.271 243.812c-9.741 10.73-12.13 18.428-24.884 38.588 8.237 5.752 24.104 19.055 35.095 41.959 21.953-12.592 32.188-14.514 43.821-24.309C332.24 236.092 518.244 6.836 511.839.204c-6.766-7.05-242.704 170.268-309.568 243.608zM155.442 300.209c-32.998-5.832-65.547 15.028-87.288 67.147C46.382 419.471 7.532 440.337.001 439.061c40.553 14.67 164.202 52.194 194.939-90.655-13.037-34.26-39.498-48.197-39.498-48.197z" data-v-d28e11ae></path></svg></span><span class="primary-menu__label" data-v-d28e11ae>UX/UI</span></a></li><li class="about" data-v-d28e11ae><a href="https://luubinhan.github.io/" target="_blank" data-v-d28e11ae>About</a></li></ul></div></div><div id="footer" data-v-d28e11ae><footer class="footer" data-v-d28e11ae><section class="footer-inner" data-v-d28e11ae><div class="social-links" data-v-d28e11ae><a href="https://www.youtube.com/channel/UC0Te8s0b0aplS1ZoVLfjKHA" target="_blank" rel="noopener noreferrer" class="link-youtube" data-v-d28e11ae><span class="link-youtube__icon" data-v-d28e11ae><svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" data-v-d28e11ae data-v-d28e11ae><path d="M512 256c0 141.4-114.6 256-256 256S0 397.4 0 256 114.6 0 256 0s256 114.6 256 256z" fill="#CD201F" data-v-d28e11ae data-v-d28e11ae></path><path d="M391.1 194.6c-2.3-19.9-7.1-25.7-10.5-28.4-5.4-4.2-15.2-5.7-28.3-6.6-21-1.4-56.7-2.3-95.2-2.3-38.6 0-74.2.8-95.2 2.3-13.1.9-22.9 2.4-28.3 6.6-3.4 2.7-8.1 8.5-10.5 28.4-3.4 28.7-3.4 94.1 0 122.8 2.4 19.9 7.1 25.7 10.5 28.4 5.4 4.2 15.2 5.7 28.3 6.6 21 1.4 56.6 2.3 95.2 2.3s74.2-.9 95.2-2.3c13.1-.9 22.9-2.4 28.3-6.6 3.4-2.6 8.1-8.5 10.5-28.4 3.4-28.7 3.4-94.1 0-122.8zm-167 104.3V213l82.4 42.9-82.4 43z" fill="#FFF" data-v-d28e11ae data-v-d28e11ae></path></svg></span>
            Youtube
          </a></div><div class="credit" data-v-d28e11ae>Copyright © 2019. luckyluu</div></section></footer></div></div><div class="master"><main class="inner"><div class="single-post"><div class="single-post-container"><article><header><div class="post-title"><h1 class="post-title__text single-post-title">Vì sao quần hùng kéo nhau không xài moment.js nữa</h1><div class="post-meta">
  Đăng ngày
  <time dateTime="2019-03-17" itemprop="dateModified" content="2019-03-17">2019-03-17</time>.
  
    Mất khoảng
    <strong>5 phút</strong> để đọc.
  </div></div></header><div class="post content-box"><div class="post__header"><!----></div><div class="blog-post"><div class="post-content"><!-- TOC -->
<ul>
<li>
<p><a href="#n%C3%B3-qu%C3%A1-ch%E1%BA%ADm">Nó quá chậm</a></p>
<ul>
<li><a href="#parsing-gi%C3%A1-tr%E1%BB%8B-iso-8601">Parsing giá trị ISO 8601</a></li>
<li><a href="#parsing-gi%C3%A1-tr%E1%BB%8B-epoch">Parsing giá trị EPOCH</a></li>
<li><a href="#format">Format</a></li>
<li><a href="#t%C3%ADnh-to%C3%A1n">Tính toán</a></li>
<li><a href="#so-s%C3%A1nh">So sánh</a></li>
</ul>
</li>
<li><a href="#n%C3%B3-qu%C3%A1-n%E1%BA%B7ng">Nó quá nặng</a></li>
<li><a href="#n%C3%B3-mutable">Nó Mutable</a></li>
<li><a href="#qu%C3%A1-kh%C3%B3-%C4%91%E1%BB%83-debug">Quá khó để debug</a></li>
</ul>
<!-- /TOC -->
<p>Trước đây khi nhắc đến thư viện xử lý ngày tháng, là trong đầu mọi developer frontend sẽ nghĩ ngay tới <a href="https://momentjs.com/" target="_blank" rel="nofollow noopener noreferrer">Moment.js</a>, tuy nhiên dạo gần đây, đâu đâu cũng nghe cũng thấy đến các bài viết khuyên chúng ta bỏ ngay moment.js hoặc ít nhất là xài một cách cẩn trọng hơn.</p>
<p>Thằng Date object build sẵn của javascript thì ko đủ xài. Sớm hay muộn chúng ta cùng cần đến một thư viện thứ 3 để làm việc với ngày tháng, và lựa chọn hiển nhiên trước đây là moment.js. Một thư viện tất cả trong một, giải quyết tuốt tuồn tật các vấn đề liên quan đến ngày tháng.</p>
<p><strong>Vậy tại sao bây giờ người ta chê nó?</strong></p>
<h2 id="nó-quá-chậm"><a href="#n%C3%B3-qu%C3%A1-ch%E1%BA%ADm" aria-hidden="true"><span class="icon icon-link"></span></a>Nó quá chậm</h2>
<p>Trong quá trình thực hiện optimize cho dự án, tác giả bài này (ko phải mình nhé) đã phát hiện ra rằng, phần lớn những chổ <strong>tắt nghẽn</strong> là ở chỗ  parsing ngày chuẩn ISO8601 từ database, cụ thể là hàm <code class="language-text">moment(ISO8601_DATE_HERE)</code>, khá là sốc với kết quả này, vì ko dùng bất cứ một định dạng đặc biệt nào, một input chuẩn ISO bình thường, nếu mà dùng <code class="language-text">moment(new Date(ISO8601_DATE_HERE))</code> thì nhanh hơn gấp 7 lần.</p>
<p>Thực hiện test và so sánh với một số thư viện khác</p>
<p><img src="https://i.imgur.com/QjK9gvY.png" alt="Nó quá nặng"></p>
<h3 id="parsing-giá-trị-iso-8601"><a href="#parsing-gi%C3%A1-tr%E1%BB%8B-iso-8601" aria-hidden="true"><span class="icon icon-link"></span></a>Parsing giá trị ISO 8601</h3>
<p>Moment.js tốn khoảng 9 giây để parse 100.000 giá trị ngày ISO8601, trong khi đó <a href="https://github.com/iamkun/dayjs" target="_blank" rel="nofollow noopener noreferrer">Day.js</a> chỉ mất .5 giây, các API cung cấp khá giống nhau, tuy nhiên thằng Day.js <strong>khôn hơn</strong>, nó xác định giá trị <code class="language-text">z</code> ở cuối string, nếu có nó sẽ gọi <code class="language-text">new Date(string)</code>. Trong khi Moment.js, <a href="https://moment.github.io/luxon/" target="_blank" rel="nofollow noopener noreferrer">Luxon</a> và <a href="https://js-joda.github.io/js-joda/" target="_blank" rel="nofollow noopener noreferrer">JS-Joda</a> sử dụng một regex của từng thằng để làm.</p>
<blockquote>
<p>Lưu ý không dùng Day.js hay Date-Fns nếu bạn cần hỗ trợ IE9, <em>hy vọng là bạn không xui tới vậy</em>, từ ES5 thì <code class="language-text">Date.parse</code> mới làm việc tốt với ISO 8601</p>
</blockquote>
<h3 id="parsing-giá-trị-epoch"><a href="#parsing-gi%C3%A1-tr%E1%BB%8B-epoch" aria-hidden="true"><span class="icon icon-link"></span></a>Parsing giá trị EPOCH</h3>
<p>Kết quả parse EPOCH Time thì các thư viện cho kết quả tương đương, tuy nhiên nếu bạn là đứa nghiện tốc độ, khuyến nghị sử dụng Date-Fns</p>
<h3 id="format"><a href="#format" aria-hidden="true"><span class="icon icon-link"></span></a>Format</h3>
<p>Về vấn đề format, các thư viện lại gần như ko cung cấp hàm nào cả, đa phần tụi nó sẽ dùng regex để thực hiện. Riêng thằng JS-Joda sử dụng một hàm trong đó nó ì các kiểu để kiểm tra, rồi <code class="language-text">charAt</code> nên nhanh hơn một chút so với những thằng dùng regex</p>
<h3 id="tính-toán"><a href="#t%C3%ADnh-to%C3%A1n" aria-hidden="true"><span class="icon icon-link"></span></a>Tính toán</h3>
<p>Các phép toán trên ngày tháng đúng là lằn xà ngoằn, moment.js làm khá tốt hơn hẳn Day.js và Luxon, tuy nhiên vô đối vấn là JS-Joda trên vụ này.</p>
<h3 id="so-sánh"><a href="#so-s%C3%A1nh" aria-hidden="true"><span class="icon icon-link"></span></a>So sánh</h3>
<p>Kiểm tra 2 giá trị ngày có là bằng nhau tương đối phức tạp hơn so sánh 2 ngày có lớn hơn nhau, bởi vì chúng ta không thực hiện so sánh giá trị khoảng thời gian (timestamps)
Mấy thư viện khác ngoài Luxon có vẻ ok, không rõ vì sao Luxon lại lấp vấp vụ này.</p>
<h2 id="nó-quá-nặng"><a href="#n%C3%B3-qu%C3%A1-n%E1%BA%B7ng" aria-hidden="true"><span class="icon icon-link"></span></a>Nó quá nặng</h2>
<p><img src="https://i.imgur.com/X7EsHHT.png" alt="Nó quá nặng"></p>
<p>Moment.js dung lượng khoảng 232kB (zip lại thì cỡ 66 kB), mà theo Yoshihide Jimbo thì có thể cắt bớt chỉ còn 68 kB ( 23 kB zip) bằng cách loại bỏ locale.</p>
<p>JS-Joda chỉ nhẹ hơn Moment.js chút xíu, tuy nhiên do nó cũng là thư viện nặng vì phải chứa period và time zone, 2 thằng này dùng Moment.js bạn phải cài thêm dạng plugin</p>
<p>Mấy thằng còn lại như Luxon, Day.js, Date-Fns thì nhẹ khỏi nói, ít nhất cũng phải nhẹ hơn 22 lần so với moment.js</p>
<p>Nếu bạn đang dùng moment.js ở Backend thì ko sợ nhiều, chứ còn ở Frontend thì 1kb cũng có giá của nó.</p>
<h2 id="nó-mutable"><a href="#n%C3%B3-mutable" aria-hidden="true"><span class="icon icon-link"></span></a>Nó Mutable</h2>
<p>Ví dụ bạn đang làm một cái app lịch hiển thị những sự kiện sắp diễn ra.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> startedAt <span class="token operator">=</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> endedAt   <span class="token operator">=</span> startedAt<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">)</span>

<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>startedAt<span class="token punctuation">)</span> <span class="token comment">// > 2020-02-09T13:39:07+01:00</span>
<span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>endedAt<span class="token punctuation">)</span>   <span class="token comment">// > 2020-02-09T13:39:07+01:00</span></code></pre>
<p><code class="language-text">startedAt</code>, <code class="language-text">endedAt</code> đều là mutable (có thể thay đổi), rõ ràng chúng ta không muốn giá trị của <code class="language-text">startedAt</code> bị thay đổi sau khi gọi hàm <code class="language-text">add</code></p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> init   <span class="token operator">=</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> add    <span class="token operator">=</span> init<span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> sub    <span class="token operator">=</span> init<span class="token punctuation">.</span><span class="token method function property-access">subtract</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'months'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> start  <span class="token operator">=</span> init<span class="token punctuation">.</span><span class="token method function property-access">startOf</span><span class="token punctuation">(</span><span class="token string">'year'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> end    <span class="token operator">=</span> init<span class="token punctuation">.</span><span class="token method function property-access">endOf</span><span class="token punctuation">(</span><span class="token string">'year'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> utc    <span class="token operator">=</span> init<span class="token punctuation">.</span><span class="token method function property-access">utc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> local  <span class="token operator">=</span> init<span class="token punctuation">.</span><span class="token method function property-access">local</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> offset <span class="token operator">=</span> init<span class="token punctuation">.</span><span class="token method function property-access">utcOffset</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">)</span></code></pre>
<p>Tất cả đống biến này đều trỏ tới cùng 1 object.  Giải quyết cũng đơn giản</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> startedAt <span class="token operator">=</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> endedAt   <span class="token operator">=</span> <span class="token function">moment</span><span class="token punctuation">(</span>startedAt<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'year'</span><span class="token punctuation">)</span></code></pre>
<blockquote>
<p>Khi dùng Moment.js luôn nhớ dùng cách này để tạo một instance mới</p>
</blockquote>
<h2 id="quá-khó-để-debug"><a href="#qu%C3%A1-kh%C3%B3-%C4%91%E1%BB%83-debug" aria-hidden="true"><span class="icon icon-link"></span></a>Quá khó để debug</h2>
<p>Nếu giá trị input đẹp đẽ, sạch sẽ, mọi việc đều sẽ trót lọt (ko tính đến vụ mutation nhé). Tuy nhiên đời mà ai lại ko có lỗi lầm</p>
<p>Giờ chúng ta thử ví dụ, có object là. <code class="language-text">person { lastVisitedAt }</code> </p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> person <span class="token operator">=</span> <span class="token punctuation">{</span> lastVisitedAt<span class="token operator">:</span> <span class="token string">'2017-11-11T00:00:00.000Z'</span> <span class="token punctuation">}</span>
<span class="token function">moment</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span><span class="token property-access">lastVsitedAt</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// > '2019-02-08T16:01:45+01:00'</span></code></pre>
<p>Nếu bạn lỡ gõ nhầm tên property như vậy đi <code class="language-text">lastVsitedAt</code>, thì <code class="language-text">moment(undefined)</code> cũng không <code class="language-text">throw error</code> luôn.</p>
<p>Giờ thử đưa mấy giá trị lạ lạ như sau vào moment()</p>
<pre class="language-js"><code class="language-js"><span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token comment">// > 2019-02-08T17:07:22+01:00</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// > 2019-02-08T17:07:22+01:00</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment">// > Invalid date</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// > 2019-02-08T17:07:22+01:00</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// > Invalid date</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// > 2019-02-08T17:07:22+01:00</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment">// > Invalid date</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment">// > 1970-01-01T01:00:00+01:00</span></code></pre>
<p>Moment.js ko throw error mà chỉ trả về <code class="language-text">Invalid Date object</code></p>
<p>Khi gọi <code class="language-text">toISOString()</code> nó lại lạ kỳ trả về <code class="language-text">null</code> chứ ko phải chuỗi <code class="language-text">Invalid Date</code></p>
<pre class="language-js"><code class="language-js"><span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token comment">// >  2019-02-08T16:14:10.835Z</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// >  2019-02-08T16:14:10.835Z</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token comment">// >  null</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// >  2019-02-08T16:14:10.836Z</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// >  null</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">// >  2019-02-08T16:14:10.836Z</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment">// >  null</span>
<span class="token function">moment</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token comment">// >  1970-01-01T00:00:00.000Z</span></code></pre>
<p>Nói cách ngắn gọn, <code class="language-text">undefined</code> không hợp lệ trong moment(), nhưng <code class="language-text">null</code> thì ok. Bị lỗi ư, nó trả về một <code class="language-text">Invalid Date object</code>, <code class="language-text">null</code> hoặc custom object tuỳ vào nó vui hay buồn.</p>
<p>Nếu kết quả này chưa làm bạn thuyết phục, hay tự kiểm chứng nhé.
<a href="https://repl.it/@piotrekfracek/DateTime" target="_blank" rel="nofollow noopener noreferrer">https://repl.it/@piotrekfracek/DateTime</a></p>
<p><a target="_blank" rel="noopener noreferrer" href="https://overreacted.io/how-are-function-components-different-from-classes/">Why you shouldn't use Moment.js...</a></p>
</div></div><div class="post__footer"><div class="post-tags"><a href="/tag/javascript/" class="post-tags__link"><span>#</span> javascript
		</a></div></div><div class="single-post__share"><a class="share-network-email" style="background-color:#333333;"><i class="mst-icon icon-mail"></i><span>Email</span></a><a class="share-network-facebook" style="background-color:#1877f2;"><i class="mst-icon icon-facebook"></i><span>Facebook</span></a><a class="share-network-linkedin" style="background-color:#007bb5;"><i class="mst-icon icon-linkedin"></i><span>LinkedIn</span></a><a class="share-network-pocket" style="background-color:#ef4056;"><i class="mst-icon icon-get-pocket"></i><span>Pocket</span></a><a class="share-network-skype" style="background-color:#00aff0;"><i class="mst-icon icon-skype"></i><span>Skype</span></a><a class="share-network-twitter" style="background-color:#1da1f2;"><i class="mst-icon icon-twitter"></i><span>Twitter</span></a></div></div><div class="post-comments"><div data-href="https://vuilaptrinh.com/vi-sao-quan-hung-keo-nhau-khong-xai-moment-js-nua/" data-numposts="10" data-width="100%" class="fb-comments"></div><div id="disqus_thread" style="min-height:200px;"></div></div><div class="related-posts"><h4>Bài liên quan</h4><ul class="related-posts__container"><li class="related-posts__media"><div class="related-posts__index">1.</div><div class="related-posts__content"><h4 class="related-posts__title"><a href="/gioi-thieu-vuex-cho-nguoi-moi-bat-dau/">Giới thiệu Vuex cho người mới bắt đầu</a></h4><p>Mình không giới thiệu cụ thể từng phần trong Vuex, các bạn cần nắm redux store của React để hiểu được bài này, các khái niệm và nguyên tắc gần như là giống nhau, khác cách đặt tên thôi.</p></div></li><li class="related-posts__media"><div class="related-posts__index">2.</div><div class="related-posts__content"><h4 class="related-posts__title"><a href="/hiem-nguy-rinh-rap-khi-dung-toan-tu-trong-javascript/">Hiểm nguy rình rập khi dùng toán tử + trong javascript</a></h4><p>Một toán tử phình phường có thể làm chúng ta điêu đứng</p></div></li><li class="related-posts__media"><div class="related-posts__index">3.</div><div class="related-posts__content"><h4 class="related-posts__title"><a href="/7-thu-thuat-trong-gatsby/">7 thủ thuật trong gatsby</a></h4><p>Tập hợp những thủ thuật khi làm việc với gatsby</p></div></li></ul></div><div class="author post-author"><a href="https://luubinhan.github.io/" target="_blank"><img alt="Author image" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 180 180' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-52311ff214b737f722259e901102d6b3'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='5'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-52311ff214b737f722259e901102d6b3)' width='180' height='180' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCABAAEADASIAAhEBAxEB/8QAHAAAAQUBAQEAAAAAAAAAAAAABwEDBAUGCAAC/8QAMxAAAQMCAwcBBgYDAAAAAAAAAQIDEQAEBRIhBhMxQVFhcQciIzJCgbEIFDORodEWgsH/xAAZAQEBAQEBAQAAAAAAAAAAAAAEAwUGAAH/xAAhEQABBAMAAgMBAAAAAAAAAAABAAIDEQQSISJBBRNRMf/aAAwDAQACEQMRAD8A6Pr1fOalmvLyUAk6AnxS5VROUx4oR%2bvmPXNjZYbhti48DcKUt9LRIJAHsgkaxMmO1ByzxnG8PeQ/a3d5bOIIUVJdUOHMifvWjB8c6aMP2q0CfPbC/TW119SVz9YetmOMLYRfWWH3TaSA4pKVNrWOuhgH6UYtkNrsK2stFvYU65nbjesOpyrbnhPIjuKhPhSwDZw4qw5kU5ph6r%2blpCYFNOLKflV5o1JSXMkDlS5xy1qtDo4mfrWe2/xhWEbJ3t400%2b6oZWyGpkBRiTGoSNJj/tVbEXEN/VMyAC1iPUTaS2xjG3bO3IS3ay2HNJc1lR6xPDx3oa4g0RvVlQcSfhFRLrEF3V0LpSAh10layOMzw7eKl3jqLhxsxLaRw4610MUYiAa1ZMxMosrPugpJJ0nlwiiJ%2bH69eZ28NulfuX7R0LTOhygKB8yKxWLaWoC0BJKpgfL2rdfh8sV3G1F9iBTLNnalGbkFuEADzAVVMpwOO6/xCx4izJaAuiSsT8UV8KKyBznmKih1J714OqIiCa5jVdJsqk4ggL9oRPSqDbty4/w/GnLVzKPyypBkaEif4p5N2RwA/anlPtvsrafAW0tJStChKVA8QR0p4ZqQQil1ilz5Y5nGloXKkcNev908G8iUoSCUiiHtVhFhhdou6wu2O6JyuNg/pzwUCdY5a8JrAXtwErWi3RmIEZwZE9utaccm/QEVzKVZjVrltN4JyJMqFdGemuz7OzmyFjbBGS5eQLm6PMuLAMf6iE/SgBavuMPNOON75wKC0tr4GDPtdqO%2bxm0i8ew0O3O7RfJnett6J4mCnXhH81DNDzGK/i%2b4/wBbZSb7S1xQ2IIVBHWvb2BAIioBcVxMCml3KgYFZQZadtSzAK460hCpkk%2bBTzahmmnXnRA0APmadsj0ol1uE2T6r5SEWgbO9K%2bARGs0H7stto3luczSyS3mEKUJIBI66VrvUnGWlJZwlKsuaHnjmgafCk/f9qwD6y%2b2pbjhKU%2bylWaJ8dabjxmtne0HInolrVcYThj18w5clKzl1KOZ/sVLRtJ%2bQbQ7akpum/01oEA9c3bvULB8WtGbRYuW1vvBOVtTivm48eVUt9Z3dwpKlIbaZIhJQZEdJq7fJxDxxHcdWgxnvtFbZz1ItsQCWMWyWb8hJcn3ZV3Pyz14eK2e9WpUBJoGYHhVpmCQyCtTZBMaHz1oq7DYxvmBh11IeZT7pR%2bZA5eR9vFCyoGs8owm4sz38kK//9k=' /%3e%3c/svg%3e" width="180" data-src="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg" data-srcset="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg 180w" data-sizes="(max-width: 180px) 100vw, 180px" class="author__image g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/author.e6b6009.95c26cbf81b488daf3af4259c9393a66.jpg" class="author__image g-image g-image--loaded" width="180" alt="Author image"></noscript></a><!----><p class="author__intro">Frontend Developer live in Ho Chi Minh City, a photography geek, and a music lover</p></div></article></div></div></main></div><div class="aside"></div></div> <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Vì sao quần hùng kéo nhau không xài moment.js nữa","path":"\u002Fvi-sao-quan-hung-keo-nhau-khong-xai-moment-js-nua\u002F","date":"2019-03-17","timeToRead":5,"tags":[{"id":"javascript","title":"javascript","path":"\u002Ftag\u002Fjavascript\u002F"}],"desc":"Tất cả chúng ta đã từng và đang sử dụng moment.js mà ko hề dành chút thời gian để xem nó ảnh hưởng như thế nào đến performance","content":"\u003C!-- TOC --\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cp\u003E\u003Ca href=\"#n%C3%B3-qu%C3%A1-ch%E1%BA%ADm\"\u003ENó quá chậm\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"#parsing-gi%C3%A1-tr%E1%BB%8B-iso-8601\"\u003EParsing giá trị ISO 8601\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#parsing-gi%C3%A1-tr%E1%BB%8B-epoch\"\u003EParsing giá trị EPOCH\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#format\"\u003EFormat\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#t%C3%ADnh-to%C3%A1n\"\u003ETính toán\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#so-s%C3%A1nh\"\u003ESo sánh\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#n%C3%B3-qu%C3%A1-n%E1%BA%B7ng\"\u003ENó quá nặng\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#n%C3%B3-mutable\"\u003ENó Mutable\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca href=\"#qu%C3%A1-kh%C3%B3-%C4%91%E1%BB%83-debug\"\u003EQuá khó để debug\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003C!-- \u002FTOC --\u003E\n\u003Cp\u003ETrước đây khi nhắc đến thư viện xử lý ngày tháng, là trong đầu mọi developer frontend sẽ nghĩ ngay tới \u003Ca href=\"https:\u002F\u002Fmomentjs.com\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EMoment.js\u003C\u002Fa\u003E, tuy nhiên dạo gần đây, đâu đâu cũng nghe cũng thấy đến các bài viết khuyên chúng ta bỏ ngay moment.js hoặc ít nhất là xài một cách cẩn trọng hơn.\u003C\u002Fp\u003E\n\u003Cp\u003EThằng Date object build sẵn của javascript thì ko đủ xài. Sớm hay muộn chúng ta cùng cần đến một thư viện thứ 3 để làm việc với ngày tháng, và lựa chọn hiển nhiên trước đây là moment.js. Một thư viện tất cả trong một, giải quyết tuốt tuồn tật các vấn đề liên quan đến ngày tháng.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cstrong\u003EVậy tại sao bây giờ người ta chê nó?\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"nó-quá-chậm\"\u003E\u003Ca href=\"#n%C3%B3-qu%C3%A1-ch%E1%BA%ADm\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ENó quá chậm\u003C\u002Fh2\u003E\n\u003Cp\u003ETrong quá trình thực hiện optimize cho dự án, tác giả bài này (ko phải mình nhé) đã phát hiện ra rằng, phần lớn những chổ \u003Cstrong\u003Etắt nghẽn\u003C\u002Fstrong\u003E là ở chỗ  parsing ngày chuẩn ISO8601 từ database, cụ thể là hàm \u003Ccode class=\"language-text\"\u003Emoment(ISO8601_DATE_HERE)\u003C\u002Fcode\u003E, khá là sốc với kết quả này, vì ko dùng bất cứ một định dạng đặc biệt nào, một input chuẩn ISO bình thường, nếu mà dùng \u003Ccode class=\"language-text\"\u003Emoment(new Date(ISO8601_DATE_HERE))\u003C\u002Fcode\u003E thì nhanh hơn gấp 7 lần.\u003C\u002Fp\u003E\n\u003Cp\u003EThực hiện test và so sánh với một số thư viện khác\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.imgur.com\u002FQjK9gvY.png\" alt=\"Nó quá nặng\"\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"parsing-giá-trị-iso-8601\"\u003E\u003Ca href=\"#parsing-gi%C3%A1-tr%E1%BB%8B-iso-8601\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EParsing giá trị ISO 8601\u003C\u002Fh3\u003E\n\u003Cp\u003EMoment.js tốn khoảng 9 giây để parse 100.000 giá trị ngày ISO8601, trong khi đó \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fiamkun\u002Fdayjs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EDay.js\u003C\u002Fa\u003E chỉ mất .5 giây, các API cung cấp khá giống nhau, tuy nhiên thằng Day.js \u003Cstrong\u003Ekhôn hơn\u003C\u002Fstrong\u003E, nó xác định giá trị \u003Ccode class=\"language-text\"\u003Ez\u003C\u002Fcode\u003E ở cuối string, nếu có nó sẽ gọi \u003Ccode class=\"language-text\"\u003Enew Date(string)\u003C\u002Fcode\u003E. Trong khi Moment.js, \u003Ca href=\"https:\u002F\u002Fmoment.github.io\u002Fluxon\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003ELuxon\u003C\u002Fa\u003E và \u003Ca href=\"https:\u002F\u002Fjs-joda.github.io\u002Fjs-joda\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EJS-Joda\u003C\u002Fa\u003E sử dụng một regex của từng thằng để làm.\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003ELưu ý không dùng Day.js hay Date-Fns nếu bạn cần hỗ trợ IE9, \u003Cem\u003Ehy vọng là bạn không xui tới vậy\u003C\u002Fem\u003E, từ ES5 thì \u003Ccode class=\"language-text\"\u003EDate.parse\u003C\u002Fcode\u003E mới làm việc tốt với ISO 8601\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch3 id=\"parsing-giá-trị-epoch\"\u003E\u003Ca href=\"#parsing-gi%C3%A1-tr%E1%BB%8B-epoch\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EParsing giá trị EPOCH\u003C\u002Fh3\u003E\n\u003Cp\u003EKết quả parse EPOCH Time thì các thư viện cho kết quả tương đương, tuy nhiên nếu bạn là đứa nghiện tốc độ, khuyến nghị sử dụng Date-Fns\u003C\u002Fp\u003E\n\u003Ch3 id=\"format\"\u003E\u003Ca href=\"#format\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EFormat\u003C\u002Fh3\u003E\n\u003Cp\u003EVề vấn đề format, các thư viện lại gần như ko cung cấp hàm nào cả, đa phần tụi nó sẽ dùng regex để thực hiện. Riêng thằng JS-Joda sử dụng một hàm trong đó nó ì các kiểu để kiểm tra, rồi \u003Ccode class=\"language-text\"\u003EcharAt\u003C\u002Fcode\u003E nên nhanh hơn một chút so với những thằng dùng regex\u003C\u002Fp\u003E\n\u003Ch3 id=\"tính-toán\"\u003E\u003Ca href=\"#t%C3%ADnh-to%C3%A1n\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ETính toán\u003C\u002Fh3\u003E\n\u003Cp\u003ECác phép toán trên ngày tháng đúng là lằn xà ngoằn, moment.js làm khá tốt hơn hẳn Day.js và Luxon, tuy nhiên vô đối vấn là JS-Joda trên vụ này.\u003C\u002Fp\u003E\n\u003Ch3 id=\"so-sánh\"\u003E\u003Ca href=\"#so-s%C3%A1nh\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESo sánh\u003C\u002Fh3\u003E\n\u003Cp\u003EKiểm tra 2 giá trị ngày có là bằng nhau tương đối phức tạp hơn so sánh 2 ngày có lớn hơn nhau, bởi vì chúng ta không thực hiện so sánh giá trị khoảng thời gian (timestamps)\nMấy thư viện khác ngoài Luxon có vẻ ok, không rõ vì sao Luxon lại lấp vấp vụ này.\u003C\u002Fp\u003E\n\u003Ch2 id=\"nó-quá-nặng\"\u003E\u003Ca href=\"#n%C3%B3-qu%C3%A1-n%E1%BA%B7ng\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ENó quá nặng\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Cimg src=\"https:\u002F\u002Fi.imgur.com\u002FX7EsHHT.png\" alt=\"Nó quá nặng\"\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EMoment.js dung lượng khoảng 232kB (zip lại thì cỡ 66 kB), mà theo Yoshihide Jimbo thì có thể cắt bớt chỉ còn 68 kB ( 23 kB zip) bằng cách loại bỏ locale.\u003C\u002Fp\u003E\n\u003Cp\u003EJS-Joda chỉ nhẹ hơn Moment.js chút xíu, tuy nhiên do nó cũng là thư viện nặng vì phải chứa period và time zone, 2 thằng này dùng Moment.js bạn phải cài thêm dạng plugin\u003C\u002Fp\u003E\n\u003Cp\u003EMấy thằng còn lại như Luxon, Day.js, Date-Fns thì nhẹ khỏi nói, ít nhất cũng phải nhẹ hơn 22 lần so với moment.js\u003C\u002Fp\u003E\n\u003Cp\u003ENếu bạn đang dùng moment.js ở Backend thì ko sợ nhiều, chứ còn ở Frontend thì 1kb cũng có giá của nó.\u003C\u002Fp\u003E\n\u003Ch2 id=\"nó-mutable\"\u003E\u003Ca href=\"#n%C3%B3-mutable\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ENó Mutable\u003C\u002Fh2\u003E\n\u003Cp\u003EVí dụ bạn đang làm một cái app lịch hiển thị những sự kiện sắp diễn ra.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-js\"\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E startedAt \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E endedAt   \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E startedAt\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'year'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token console class-name\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EstartedAt\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E 2020-02-09T13:39:07+01:00\u003C\u002Fspan\u003E\n\u003Cspan class=\"token console class-name\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EendedAt\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E   \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E 2020-02-09T13:39:07+01:00\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Ccode class=\"language-text\"\u003EstartedAt\u003C\u002Fcode\u003E, \u003Ccode class=\"language-text\"\u003EendedAt\u003C\u002Fcode\u003E đều là mutable (có thể thay đổi), rõ ràng chúng ta không muốn giá trị của \u003Ccode class=\"language-text\"\u003EstartedAt\u003C\u002Fcode\u003E bị thay đổi sau khi gọi hàm \u003Ccode class=\"language-text\"\u003Eadd\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-js\"\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E init   \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E add    \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E init\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'year'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E sub    \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E init\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Esubtract\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E10\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'months'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E start  \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E init\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EstartOf\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'year'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E end    \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E init\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EendOf\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'year'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E utc    \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E init\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eutc\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E local  \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E init\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Elocal\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E offset \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E init\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EutcOffset\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E480\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ETất cả đống biến này đều trỏ tới cùng 1 object.  Giải quyết cũng đơn giản\u003C\u002Fp\u003E\n\u003Cpre class=\"language-js\"\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E startedAt \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E endedAt   \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EstartedAt\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'year'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EKhi dùng Moment.js luôn nhớ dùng cách này để tạo một instance mới\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Ch2 id=\"quá-khó-để-debug\"\u003E\u003Ca href=\"#qu%C3%A1-kh%C3%B3-%C4%91%E1%BB%83-debug\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EQuá khó để debug\u003C\u002Fh2\u003E\n\u003Cp\u003ENếu giá trị input đẹp đẽ, sạch sẽ, mọi việc đều sẽ trót lọt (ko tính đến vụ mutation nhé). Tuy nhiên đời mà ai lại ko có lỗi lầm\u003C\u002Fp\u003E\n\u003Cp\u003EGiờ chúng ta thử ví dụ, có object là. \u003Ccode class=\"language-text\"\u003Eperson { lastVisitedAt }\u003C\u002Fcode\u003E \u003C\u002Fp\u003E\n\u003Cpre class=\"language-js\"\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E person \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E lastVisitedAt\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'2017-11-11T00:00:00.000Z'\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eperson\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token property-access\"\u003ElastVsitedAt\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E '2019-02-08T16:01:45+01:00'\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENếu bạn lỡ gõ nhầm tên property như vậy đi \u003Ccode class=\"language-text\"\u003ElastVsitedAt\u003C\u002Fcode\u003E, thì \u003Ccode class=\"language-text\"\u003Emoment(undefined)\u003C\u002Fcode\u003E cũng không \u003Ccode class=\"language-text\"\u003Ethrow error\u003C\u002Fcode\u003E luôn.\u003C\u002Fp\u003E\n\u003Cp\u003EGiờ thử đưa mấy giá trị lạ lạ như sau vào moment()\u003C\u002Fp\u003E\n\u003Cpre class=\"language-js\"\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E          \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E 2019-02-08T17:07:22+01:00\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword nil\"\u003Eundefined\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E 2019-02-08T17:07:22+01:00\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword null nil\"\u003Enull\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E      \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E Invalid date\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E        \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E 2019-02-08T17:07:22+01:00\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E        \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E Invalid date\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E        \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E 2019-02-08T17:07:22+01:00\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003ENaN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E       \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E Invalid date\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E         \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E 1970-01-01T01:00:00+01:00\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EMoment.js ko throw error mà chỉ trả về \u003Ccode class=\"language-text\"\u003EInvalid Date object\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EKhi gọi \u003Ccode class=\"language-text\"\u003EtoISOString()\u003C\u002Fcode\u003E nó lại lạ kỳ trả về \u003Ccode class=\"language-text\"\u003Enull\u003C\u002Fcode\u003E chứ ko phải chuỗi \u003Ccode class=\"language-text\"\u003EInvalid Date\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-js\"\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EtoISOString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E          \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E  2019-02-08T16:14:10.835Z\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword nil\"\u003Eundefined\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EtoISOString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E  2019-02-08T16:14:10.835Z\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword null nil\"\u003Enull\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EtoISOString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E      \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E  null\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EtoISOString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E        \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E  2019-02-08T16:14:10.836Z\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EtoISOString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E        \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E  null\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EtoISOString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E        \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E  2019-02-08T16:14:10.836Z\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003ENaN\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EtoISOString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E       \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E  null\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Emoment\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token method function property-access\"\u003EtoISOString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E         \u003Cspan class=\"token comment\"\u003E\u002F\u002F \u003E  1970-01-01T00:00:00.000Z\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ENói cách ngắn gọn, \u003Ccode class=\"language-text\"\u003Eundefined\u003C\u002Fcode\u003E không hợp lệ trong moment(), nhưng \u003Ccode class=\"language-text\"\u003Enull\u003C\u002Fcode\u003E thì ok. Bị lỗi ư, nó trả về một \u003Ccode class=\"language-text\"\u003EInvalid Date object\u003C\u002Fcode\u003E, \u003Ccode class=\"language-text\"\u003Enull\u003C\u002Fcode\u003E hoặc custom object tuỳ vào nó vui hay buồn.\u003C\u002Fp\u003E\n\u003Cp\u003ENếu kết quả này chưa làm bạn thuyết phục, hay tự kiểm chứng nhé.\n\u003Ca href=\"https:\u002F\u002Frepl.it\u002F@piotrekfracek\u002FDateTime\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Frepl.it\u002F@piotrekfracek\u002FDateTime\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"https:\u002F\u002Foverreacted.io\u002Fhow-are-function-components-different-from-classes\u002F\"\u003EWhy you shouldn't use Moment.js...\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n","cover_image":"","related":[{"id":"0b0388dbdd5fb8e368d89c778ff54334","path":"\u002Fgioi-thieu-vuex-cho-nguoi-moi-bat-dau\u002F","title":"Giới thiệu Vuex cho người mới bắt đầu","desc":"Mình không giới thiệu cụ thể từng phần trong Vuex, các bạn cần nắm redux store của React để hiểu được bài này, các khái niệm và nguyên tắc gần như là giống nhau, khác cách đặt tên thôi."},{"id":"d18d52ab708e1b700e4bcc10ebd3d7cc","path":"\u002Fhiem-nguy-rinh-rap-khi-dung-toan-tu-trong-javascript\u002F","title":"Hiểm nguy rình rập khi dùng toán tử + trong javascript","desc":"Một toán tử phình phường có thể làm chúng ta điêu đứng"},{"id":"3c61ae3af0a208aaced877dc81a02150","path":"\u002F7-thu-thuat-trong-gatsby\u002F","title":"7 thủ thuật trong gatsby","desc":"Tập hợp những thủ thuật khi làm việc với gatsby"}]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.46edf9ee.js" defer></script><script src="/assets/js/page--src-templates-post-vue.d170cb20.js" defer></script>
  </body>
</html>
